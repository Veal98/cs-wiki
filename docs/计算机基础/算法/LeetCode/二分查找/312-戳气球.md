# 312. æˆ³æ°”çƒ

---

ğŸ‘‰ [312. Burst Balloons â€” Hard](https://leetcode-cn.com/problems/burst-balloons/)

## ğŸ“œ é¢˜ç›®æè¿°

Given n balloons, indexed from 0 to n-1. Each balloon is painted with a number on it represented by array nums. You are asked to burst all the balloons. If the you burst balloon i you will get `nums[left] * nums[i] * nums[right]` coins. Here left and right are adjacent indices of i. After the burst, the left and right then becomes adjacent.

Find the maximum coins you can collect by bursting the balloons wisely.

**Note**:

You may imagine nums[-1] = nums[n] = 1. They are not real therefore you can not burst them.
0 â‰¤ n â‰¤ 500, 0 â‰¤ nums[i] â‰¤ 100

**Example**:

```
Input: [3,1,5,8]
Output: 167 
Explanation: nums = [3,1,5,8] --> [3,5,8] -->   [3,8]   -->  [8]  --> []
             coins =  3*1*5      +  3*5*8    +  1*3*8      + 1*8*1   = 167
```

## ğŸ’¡ è§£é¢˜æ€è·¯ 

> ğŸ”ˆ è¯¥é¢˜ç”¨åŠ¨æ€è§„åˆ’æ¯”åˆ†æ²»æ³•æ›´å¥½ï¼Œè¯¦ç»†è¯·è§åŠ¨æ€è§„åˆ’æ¨¡å—

**åˆ†æ²»æ³•**ï¼šä»¥ [3, 1, 5, 8] ä¸ºä¾‹

é¦–å…ˆæ€è€ƒèƒ½ä¸èƒ½ç›´æ¥å°† [3, 1, 5, 8] ç›´æ¥åˆ†ä¸ºç±»ä¼¼äº [3]ã€[1, 5, 8] è¿™æ ·ä¸¤ä¸ªå­é—®é¢˜ã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å¼ºè¡Œè®¤ä¸ºå¿…é¡»æˆ³å®Œ [3] æ‰èƒ½æˆ³ [1, 5, 8]ï¼Œæˆ–è€…æˆ³å®Œ [1, 5, 8] æ‰èƒ½æˆ³ [3]ï¼Œæ˜¾ç„¶è¿™ä¸ç§‘å­¦ã€‚å³è¿™**ä¸¤ä¸ªå­é—®é¢˜ä¹‹é—´äº§ç”Ÿäº†ä¾èµ–**ã€‚

å¦‚ä½•æ¶ˆé™¤ä¾èµ–å‘¢ï¼Ÿå…ˆå‡è®¾ç¬¬ä¸€ä¸ªè¢«æˆ³çˆ†çš„æ°”çƒä¸º xï¼Œåˆ™ x ä¸¤è¾¹çš„æ°”çƒåˆ™äº§ç”Ÿäº†ä¾èµ–ï¼›â­ é‚£æˆ‘ä»¬**å‡è®¾ä¸æˆ³çˆ† xï¼Œåˆ™ x ä¸¤è¾¹çš„æ°”çƒå°±æ²¡æœ‰äº†ä¾èµ–å…³ç³»ã€‚è¿™ä¸ªæ°”çƒ xï¼Œæˆ‘ä»¬æœ€åå†æˆ³çˆ†å®ƒã€‚**

è¿™æ ·ï¼Œå¯¹äº [3, 1, 5, 8]ï¼Œå‡è®¾æœ€åæˆ³çˆ† 5ï¼Œåˆ™é—®é¢˜å°±è¢«åˆ’åˆ†ä¸ºå¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¸¤ä¸ªå­é—®é¢˜å’Œä¸€ä¸ªO(1)çš„é—®é¢˜ã€‚

![](https://gitee.com/veal98/images/raw/master/img/20200929212135.png)

å…¶ä¸­ï¼Œç°è‰²å…ƒç´ è¡¨ç¤ºä¸å¯æˆ³ï¼Œä»…ä¾›è®¡åˆ†çš„â€œè™šæ‹Ÿæ°”çƒâ€ã€‚è€Œä¸”è™šæ‹Ÿæ°”çƒçš„å€¼ä»…ä¸ä½ç½®æœ‰å…³ã€‚å‡è®¾ `f(start, end)` è¡¨ç¤ºä»ç¬¬ `start` åˆ° `end` ä¸ªæ°”çƒçš„æœ€å¤§å¾—åˆ†ï¼Œ`nums[i]` è¡¨ç¤ºæ°”çƒä¸Šçš„å€¼ï¼Œ`nums[start-1]` å’Œ `nums[end+1]` æ˜¯â€œè™šæ‹Ÿæ°”çƒâ€åˆ™æœ‰ï¼š

```java
// ç¬¬ i ä¸ªæ°”çƒæ˜¯æœ€åä¸€ä¸ªæˆ³ç ´çš„æ°”çƒï¼Œi å–å€¼ä¸º [start,end]
f(start, end) = max{ f(start,i-1) + f(i+1,end) + nums[start-1] * nums[i] * nums[end+1] +  }
```

é€’å½’ç»“æŸæ¡ä»¶æ˜¯ `start>end`ã€‚

é€’å½’æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°† `f[start,end]` çš„å€¼é€šè¿‡äºŒç»´æ•°ç»„ç¼“å­˜èµ·æ¥ã€‚

## âœ…  å…·ä½“ä»£ç  


```java
class Solution{ 

    private int[][] cache; // ç¼“å­˜æ•°ç»„

    public int maxCoins(int[] nums){
        cache = new int[nums.length][nums.length];
        for(int i = 0;i<nums.length;i++){
            for(int j = 0;j<nums.length;j++){
                cache[i][j] = -1;
            }
        }
        return getMaxCoins(nums,0,nums.length-1);
    }
    
    private int getMaxCoins(int[] nums, int start,int end){
        // ä»ç¼“å­˜æ•°ç»„ä¸­æŸ¥æ‰¾ï¼Œé¿å…é‡å¤è®¡ç®—
        if(start <= end && cache[start][end] != -1){
                return cache[start][end];
        }
        
        //  åˆ†æ²»é€’å½’
        int maxCoins = 0;
        for(int i = start; i <= end; i ++){
            int temp = (start - 1 < 0 ? 1 : nums[start - 1])
                    * nums [i]
                    * (end + 1 > nums.length - 1 ? 1 : nums[end + 1]) 
                    + getMaxCoins(nums, start, i - 1) 
                    + getMaxCoins(nums, i + 1, end);

            if(temp > maxCoins)
                maxCoins = temp;
        }

        if(end >= start){
            cache[start][end] = maxCoins; // å­˜å…¥ç¼“å­˜æ•°ç»„
        }

        return maxCoins;
    }
}

```

## ğŸ†š å¤æ‚åº¦åˆ†æ

æ—¶é—´å¤æ‚åº¦ï¼š$O(n^3)$ï¼Œå…¶ä¸­ n æ˜¯æ°”çƒæ•°é‡ã€‚åŒºé—´æ•°ä¸º $n^2$ï¼ŒåŒºé—´è¿­ä»£å¤æ‚åº¦ä¸º $O(n)$ï¼Œæœ€ç»ˆå¤æ‚åº¦ä¸º $O(n^2 \times n) = O(n^3)$

ç©ºé—´å¤æ‚åº¦ï¼š$O(n^2)$ å…¶ä¸­ n æ˜¯æ°”çƒæ•°é‡ã€‚ç¼“å­˜å¤§å°ä¸ºåŒºé—´çš„ä¸ªæ•°ã€‚

