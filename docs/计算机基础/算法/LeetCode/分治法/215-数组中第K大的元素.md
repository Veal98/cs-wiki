# 215. æ•°ç»„ä¸­ç¬¬ K å¤§çš„å…ƒç´ 

---

ğŸ‘‰ [215. Kth Largest Element in an Array â€” Medium](https://leetcode-cn.com/problems/kth-largest-element-in-an-array/)

## ğŸ“œé¢˜ç›®æè¿°

Find **the kth largest element** in an unsorted array. Note that it is the kth largest element in the sorted order, not the kth distinct element.

**Example 1**:

```
Input: [3,2,1,5,6,4] and k = 2
Output: 5
```

 **Example 2**:

```
  Input: [3,2,3,1,2,4,5,5,6] and k = 4
  Output: 4
```

**Note**:

  You may assume k is always valid, 1 â‰¤ k â‰¤ array's length.



## ğŸ’¡ è§£é¢˜æ€è·¯

<u>åŸºäºå¿«é€Ÿæ’åºçš„åˆ†æ²»ç®—æ³•</u>ï¼š

å¿«é€Ÿæ’åºæ˜¯ä¸€ä¸ªå…¸å‹çš„åˆ†æ²»ç®—æ³•ï¼Œå¿«æ’çš„æ ¸å¿ƒåœ¨äº `partition`ï¼ˆåˆ‡åˆ†ï¼‰æ“ä½œï¼Œå³æ¯ä¸€æ¬¡æ’åºåéƒ½ä¼šç¡®å®šä¸€ä¸ªå…ƒç´ çš„æœ€ç»ˆä½ç½®ï¼Œå³ x çš„æœ€ç»ˆä½ç½®ä¸º jï¼Œå¹¶ä¸”ä¿è¯ $a[l \cdots j - 1]$ ä¸­çš„æ¯ä¸ªå…ƒç´ å°äºç­‰äº a[j]ï¼Œä¸” a[j] å°äºç­‰äº $a[j + 1 \cdots r]$ ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚

æ‰€ä»¥**åªè¦æŸæ¬¡åˆ’åˆ†çš„ j ä¸ºå€’æ•°ç¬¬ kä¸ªä¸‹æ ‡çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å·²ç»æ‰¾åˆ°äº†ç­”æ¡ˆ**ã€‚ æˆ‘ä»¬åªå…³å¿ƒè¿™ä¸€ç‚¹ï¼Œè‡³äº $a[l \cdots j - 1]$ å’Œ $a[j+1 \cdots r]$ æ˜¯å¦æ˜¯æœ‰åºçš„ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒã€‚

**å¦‚æœ j æ¯”ç›®æ ‡ä¸‹æ ‡å°ï¼Œå°±é€’å½’å³å­åŒºé—´ï¼Œå¦åˆ™é€’å½’å·¦å­åŒºé—´**ã€‚

è¿™æ ·å°±å¯ä»¥æŠŠåŸæ¥é€’å½’ä¸¤ä¸ªåŒºé—´å˜æˆåªé€’å½’ä¸€ä¸ªåŒºé—´ï¼Œæé«˜äº†æ—¶é—´æ•ˆç‡ã€‚è¿™å°±æ˜¯ã€Œå¿«é€Ÿé€‰æ‹©ã€ç®—æ³•ã€‚

<img src="https://gitee.com/veal98/images/raw/master/img/20200921103938.png" style="zoom: 45%;" />



## âœ… å…·ä½“ä»£ç 

### â‘  åˆ†æ²»æ³•

```java
class Solution {
    public int findKthLargest(int[] nums, int k) {
        int len = nums.length;
        int left = 0;
        int right = len - 1;

        int target = len - k; // ç¬¬ K å¤§å…ƒç´ ç»è¿‡æ’åºåçš„ä¸‹æ ‡

        while(true){
            int pivot = partition(nums, left, right);
            if(pivot == target)
                return nums[pivot];
            else if(pivot < target){
                left = pivot + 1;
            }
            else
                right = pivot - 1;
        }
    }

    // åœ¨æ•°ç»„ nums çš„å­åŒºé—´ [left, right] æ‰§è¡Œ partition æ“ä½œï¼Œè¿”å› pivot æ’åºä»¥ååº”è¯¥åœ¨çš„ä½ç½®
    private int partition(int[] nums, int left, int right){
        int pivot = nums[left]; // é€‰æ‹© pivot ä¸ºæœ€å·¦è¾¹çš„æ•°
        int j = left;
        for(int i = left + 1; i <= right; i ++){
            if(nums[i] < pivot){
                // å°äº pivot çš„å…ƒç´ éƒ½è¢«äº¤æ¢åˆ°å‰é¢
                j ++;
                swap(nums, j, i);
            }
        }
        // éå†ä¸€éåå°† pivot ç½®äºæœ€ç»ˆä½ç½® j
        swap(nums, j, left);
        return j;
    }

    private void swap(int[] nums, int a, int b){
        int temp = nums[a];
        nums[a] = nums[b];
        nums[b] = temp;
    }
}
```

### â‘¡ éšæœºåŒ–æ”¹è¿›ç®—æ³•

ä¸è¿‡ä¸Šé¢çš„ä»£ç æ˜¯æœ‰ç¼ºé™·çš„ï¼šæˆ‘ä»¬çŸ¥é“å¿«é€Ÿæ’åºçš„æ€§èƒ½å’Œã€Œåˆ’åˆ†ã€å‡ºçš„å­æ•°ç»„çš„é•¿åº¦å¯†åˆ‡ç›¸å…³ã€‚ç›´è§‚åœ°ç†è§£å¦‚æœæ¯æ¬¡è§„æ¨¡ä¸º n çš„é—®é¢˜æˆ‘ä»¬éƒ½åˆ’åˆ†æˆ 1 å’Œ n - 1ï¼Œæ¯æ¬¡é€’å½’çš„æ—¶å€™åˆå‘ n - 1 çš„é›†åˆä¸­é€’å½’ï¼Œè¿™ç§æƒ…å†µæ˜¯æœ€åçš„ï¼ˆ**é¡ºåºæ•°ç»„æˆ–è€…é€†åºæ•°ç»„**ï¼‰ï¼Œæ—¶é—´ä»£ä»·æ˜¯ $O(n ^ 2)$ï¼Œæ ¹æœ¬è¾¾ä¸åˆ°å‡æ²»çš„æ•ˆæœã€‚

<img src="https://gitee.com/veal98/images/raw/master/img/20200921110958.png" style="zoom: 80%;" />

æˆ‘ä»¬å¯ä»¥å¼•å…¥**éšæœºåŒ–**æ¥åŠ é€Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œå®ƒçš„æ—¶é—´ä»£ä»·çš„æœŸæœ›æ˜¯ $O(n)$ã€‚

æ‰€è°“éšæœºåŒ–å°±æ˜¯éšæœº pivot çš„å–å€¼ï¼ˆå¹¶éå›ºå®šçš„æœ€å·¦è¾¹çš„æ•°ï¼‰ï¼Œå¯ä»¥åœ¨å¾ªç¯ä¸€å¼€å§‹çš„æ—¶å€™ï¼Œéšæœºäº¤æ¢ç¬¬ 1 ä¸ªå…ƒç´ ï¼ˆæœ€å·¦è¾¹çš„å…ƒç´ ï¼‰ä¸å®ƒåé¢çš„ä»»æ„ 1 ä¸ªå…ƒç´ çš„ä½ç½®ï¼š

```java
import java.util.Random;

class Solution {

    private static Random random = new Random(System.currentTimeMillis());

    public int findKthLargest(int[] nums, int k) {
        int len = nums.length;
        int left = 0;
        int right = len - 1;

        int target = len - k; // ç¬¬ K å¤§å…ƒç´ ç»è¿‡æ’åºåçš„ä¸‹æ ‡

        while(true){
            int pivot = partition(nums, left, right);
            if(pivot == target)
                return nums[pivot];
            else if(pivot < target){
                left = pivot + 1;
            }
            else
                right = pivot - 1;
        }
    }

    // åœ¨æ•°ç»„ nums çš„å­åŒºé—´ [left, right] æ‰§è¡Œ partition æ“ä½œï¼Œè¿”å› pivot æ’åºä»¥ååº”è¯¥åœ¨çš„ä½ç½®
    private int partition(int[] nums, int left, int right){
        // åœ¨åŒºé—´éšæœºé€‰æ‹©ä¸€ä¸ªå…ƒç´ ä½œä¸ºæ ‡å®šç‚¹
        if(right > left){
            int randomIndex = left + 1 + random.nextInt(right - left);
            swap(nums, left, randomIndex);
        }

        int pivot = nums[left]; // é€‰æ‹© pivot ä¸ºæœ€å·¦è¾¹çš„æ•°
        int j = left;
        for(int i = left + 1; i <= right; i ++){
            if(nums[i] < pivot){
                // å°äº pivot çš„å…ƒç´ éƒ½è¢«äº¤æ¢åˆ°å‰é¢
                j ++;
                swap(nums, j, i);
            }
        }
        // éå†ä¸€éåå°† pivot ç½®äºæœ€ç»ˆä½ç½® j
        swap(nums, j, left);
        return j;
    }

    private void swap(int[] nums, int a, int b){
        int temp = nums[a];
        nums[a] = nums[b];
        nums[b] = temp;
    }
}
```

OKï¼Œæ—¶é—´å¤æ‚åº¦å¤§å¤§é™ä½äº†ï¼š

<img src="https://gitee.com/veal98/images/raw/master/img/20200921111033.png" style="zoom:80%;" />