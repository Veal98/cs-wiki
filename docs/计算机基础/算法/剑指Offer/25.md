# ğŸ”— 25 - å¤æ‚é“¾è¡¨çš„å¤åˆ¶

---

### é¢˜ç›®æè¿°

è¾“å…¥ä¸€ä¸ªå¤æ‚é“¾è¡¨ï¼ˆæ¯ä¸ªèŠ‚ç‚¹ä¸­æœ‰èŠ‚ç‚¹å€¼ï¼Œä»¥åŠä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªç‰¹æ®ŠæŒ‡é’ˆæŒ‡å‘ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼‰ï¼Œ**å¤åˆ¶è¯¥é“¾è¡¨**å¹¶è¿”å›ç»“æœä¸ºå¤åˆ¶åå¤æ‚é“¾è¡¨çš„headã€‚ï¼ˆæ³¨æ„ï¼Œè¾“å‡ºç»“æœä¸­è¯·ä¸è¦è¿”å›å‚æ•°ä¸­çš„èŠ‚ç‚¹å¼•ç”¨ï¼Œå¦åˆ™åˆ¤é¢˜ç¨‹åºä¼šç›´æ¥è¿”å›ç©ºï¼‰<br />


### è§£é¢˜æ€è·¯
ä¸€å…±åˆ†ä¸‰æ­¥

- 1. ç›´æ¥åœ¨æ—§é“¾è¡¨ä¸Šåˆ›å»ºæ–°é“¾è¡¨ã€‚éå†é“¾è¡¨ï¼Œå¤åˆ¶ç»“ç‚¹å¹¶é“¾æ¥åœ¨åŸç»“ç‚¹çš„åé¢
- 2. é‡æ–°éå†é“¾è¡¨ï¼Œæ ¹æ®åŸç»“ç‚¹çš„randomå…³ç³»ä¸ºå¤åˆ¶ç»“ç‚¹ä¹ŸåŒæ ·èµ‹äºˆç›¸åŒçš„randomå…³ç³»
- 3.Â å†æ¬¡éå†éå†å¹¶æ‹†åˆ†ï¼Œå¥‡æ•°ç»“ç‚¹ä¸ºåŸç»“ç‚¹ï¼Œå¶æ•°ç»“ç‚¹ä¸ºå¤åˆ¶ç»“ç‚¹ã€‚æˆ‘ä»¬åªéœ€è¦å°†å¤åˆ¶ç»“ç‚¹æŠ½å–å‡ºæ¥å¹¶ç»„æˆæ–°é“¾è¡¨å³å¯

<img src="https://cdn.nlark.com/yuque/0/2020/png/1237282/1586501117805-e673c539-c3d0-4488-83fe-1ef5234e4418.png" alt="image.png" style="zoom:80%;" />

### å…·ä½“ä»£ç 

- C++

```cpp
/*
struct RandomListNode {
    int label;
    struct RandomListNode *next, *random;
    RandomListNode(int x) :
            label(x), next(NULL), random(NULL) {
    }
};
*/
class Solution {
public:
    RandomListNode* Clone(RandomListNode* pHead){
        if(pHead == NULL)
            return NULL;
        RandomListNode *currentNode = pHead;
        // 1. éå†é“¾è¡¨ï¼Œå¤åˆ¶ç»“ç‚¹å¹¶é“¾æ¥åœ¨åŸç»“ç‚¹çš„åé¢
        while(currentNode != NULL){
            //å¤åˆ¶æ¯ä¸ªç»“ç‚¹
            RandomListNode *cloneNode = new RandomListNode(currentNode->label);
            //å°†å¤åˆ¶ç»“ç‚¹é“¾æ¥åœ¨åŸç»“ç‚¹çš„åé¢
            RandomListNode *nextNode = currentNode->next;
            currentNode->next = cloneNode;
            cloneNode->next = nextNode;
            currentNode = nextNode;
        }
        // 2. é‡æ–°éå†é“¾è¡¨ï¼Œæ ¹æ®åŸç»“ç‚¹çš„randomå…³ç³»ä¸ºå¤åˆ¶ç»“ç‚¹ä¹ŸåŒæ ·èµ‹äºˆç›¸åŒçš„randomå…³ç³»
        currentNode = pHead;
        while(currentNode != NULL){
            //å¦‚æœåŸç»“ç‚¹ä¸å­˜åœ¨randomæŒ‡é’ˆ
            if(currentNode->random==NULL)
                //åˆ™å¤åˆ¶ç»“ç‚¹ä¹Ÿä¸å­˜åœ¨
                currentNode->next->random = NULL;
            else
                // A-A1-B-B1-C-C1
                // æ¯”å¦‚Aæœ‰éšæœºæŒ‡é’ˆæŒ‡å‘C
                // åˆ™A1éšæœºæŒ‡é’ˆæŒ‡å‘C1
                // A1->random = A->random->next
                currentNode->next->random = currentNode->random->next;
            
            currentNode = currentNode->next->next;
        }
        //3. å†æ¬¡éå†éå†å¹¶æ‹†åˆ†ï¼Œå¥‡æ•°ç»“ç‚¹ä¸ºåŸç»“ç‚¹ï¼Œå¶æ•°ç»“ç‚¹ä¸ºå¤åˆ¶ç»“ç‚¹
        // æˆ‘ä»¬åªéœ€è¦å°†å¤åˆ¶ç»“ç‚¹æŠ½å–å‡ºæ¥å¹¶ç»„æˆæ–°é“¾è¡¨å³å¯
        currentNode = pHead;
        RandomListNode *pCloneHead = pHead->next;
        while(currentNode != NULL){
            RandomListNode *cloneNode = currentNode->next;
            currentNode->next = cloneNode->next;
            if(cloneNode->next == NULL)
                cloneNode->next = NULL;
            else 
                cloneNode->next = cloneNode->next->next;
            
            currentNode = currentNode->next;
        }
        
        return pCloneHead;
    }
};
```


- Java

```java
/*
public class RandomListNode {
    int label;
    RandomListNode next = null;
    RandomListNode random = null;

    RandomListNode(int label) {
        this.label = label;
    }
}
*/
public class Solution {
    public RandomListNode Clone(RandomListNode pHead)
    {
        if(pHead == null)
            return null;
        RandomListNode currentNode = pHead;
        // 1. éå†é“¾è¡¨ï¼Œå¤åˆ¶ç»“ç‚¹å¹¶é“¾æ¥åœ¨åŸç»“ç‚¹çš„åé¢
        while(currentNode != null){
            //å¤åˆ¶æ¯ä¸ªç»“ç‚¹
            RandomListNode cloneNode = new RandomListNode(currentNode.label);
            //å°†å¤åˆ¶ç»“ç‚¹é“¾æ¥åœ¨åŸç»“ç‚¹çš„åé¢
            RandomListNode nextNode = currentNode.next;
            currentNode.next = cloneNode;
            cloneNode.next = nextNode;
            currentNode = nextNode;
        }
        // 2. é‡æ–°éå†é“¾è¡¨ï¼Œæ ¹æ®åŸç»“ç‚¹çš„randomå…³ç³»ä¸ºå¤åˆ¶ç»“ç‚¹ä¹Ÿèµ‹äºˆç›¸åŒçš„randomå…³ç³»
        currentNode = pHead;
        while(currentNode != null){
            //å¦‚æœåŸç»“ç‚¹ä¸å­˜åœ¨randomæŒ‡é’ˆ
            if(currentNode.random==null)
                //åˆ™å¤åˆ¶ç»“ç‚¹ä¹Ÿä¸å­˜åœ¨
                currentNode.next.random = null;
            else
                currentNode.next.random = currentNode.random.next;
            
            currentNode = currentNode.next.next;
        }
        //3. å†æ¬¡éå†éå†å¹¶æ‹†åˆ†ï¼Œå¥‡æ•°ç»“ç‚¹ä¸ºåŸç»“ç‚¹ï¼Œå¶æ•°ç»“ç‚¹ä¸ºå¤åˆ¶ç»“ç‚¹
        // æˆ‘ä»¬åªéœ€è¦å°†å¤åˆ¶ç»“ç‚¹æŠ½å–å‡ºæ¥å¹¶ç»„æˆæ–°é“¾è¡¨å³å¯
        currentNode = pHead;
        RandomListNode pCloneHead = pHead.next;
        while(currentNode != null){
            RandomListNode cloneNode = currentNode.next;
            currentNode.next = cloneNode.next;
            if(cloneNode.next == null)
                cloneNode.next = null;
            else 
                cloneNode.next = cloneNode.next.next;
            
            currentNode = currentNode.next;
        }
        
        return pCloneHead;
    }
}
```


