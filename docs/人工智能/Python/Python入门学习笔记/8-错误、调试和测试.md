# ğŸ’¯ é”™è¯¯ã€è°ƒè¯•å’Œæµ‹è¯•

---

Pythonå†…ç½®äº†ä¸€å¥—å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œé”™è¯¯å¤„ç†ã€‚

æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦è·Ÿè¸ªç¨‹åºçš„æ‰§è¡Œï¼ŒæŸ¥çœ‹å˜é‡çš„å€¼æ˜¯å¦æ­£ç¡®ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºè°ƒè¯•ã€‚Pythonçš„pdbå¯ä»¥è®©æˆ‘ä»¬ä»¥å•æ­¥æ–¹å¼æ‰§è¡Œä»£ç ã€‚

æœ€åï¼Œç¼–å†™æµ‹è¯•ä¹Ÿå¾ˆé‡è¦ã€‚æœ‰äº†è‰¯å¥½çš„æµ‹è¯•ï¼Œå°±å¯ä»¥åœ¨ç¨‹åºä¿®æ”¹ååå¤è¿è¡Œï¼Œç¡®ä¿ç¨‹åºè¾“å‡ºç¬¦åˆæˆ‘ä»¬ç¼–å†™çš„æµ‹è¯•ã€‚

## 1. é”™è¯¯å¤„ç†

### â‘  try

è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥çœ‹çœ‹`try`çš„æœºåˆ¶ï¼š

```python
try:
    print('try...')
    r = 10 / 0
    print('result:', r)
except ZeroDivisionError as e:
    print('except:', e)
finally:
    print('finally...')
print('END')
```

å½“æˆ‘ä»¬è®¤ä¸ºæŸäº›ä»£ç å¯èƒ½ä¼šå‡ºé”™æ—¶ï¼Œå°±å¯ä»¥ç”¨`try`æ¥è¿è¡Œè¿™æ®µä»£ç ï¼Œå¦‚æœæ‰§è¡Œå‡ºé”™ï¼Œåˆ™åç»­ä»£ç ä¸ä¼šç»§ç»­æ‰§è¡Œï¼Œè€Œæ˜¯ç›´æ¥è·³è½¬è‡³é”™è¯¯å¤„ç†ä»£ç ï¼Œå³`except`è¯­å¥å—ï¼Œæ‰§è¡Œå®Œ`except`åï¼Œå¦‚æœæœ‰`finally`è¯­å¥å—ï¼Œåˆ™æ‰§è¡Œ`finally`è¯­å¥å—ï¼Œè‡³æ­¤ï¼Œæ‰§è¡Œå®Œæ¯•ã€‚

ä¸Šé¢çš„ä»£ç åœ¨è®¡ç®—`10 / 0`æ—¶ä¼šäº§ç”Ÿä¸€ä¸ªé™¤æ³•è¿ç®—é”™è¯¯ï¼š

```powershell
try...
except: division by zero
finally...
END
```

ä»è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼Œå½“é”™è¯¯å‘ç”Ÿæ—¶ï¼Œåç»­è¯­å¥`print('result:', r)`ä¸ä¼šè¢«æ‰§è¡Œï¼Œ`except`ç”±äºæ•è·åˆ°`ZeroDivisionError`ï¼Œå› æ­¤è¢«æ‰§è¡Œã€‚æœ€åï¼Œ`finally`è¯­å¥è¢«æ‰§è¡Œã€‚ç„¶åï¼Œç¨‹åºç»§ç»­æŒ‰ç…§æµç¨‹å¾€ä¸‹èµ°ã€‚

å¦‚æœæŠŠé™¤æ•°`0`æ”¹æˆ`2`ï¼Œåˆ™æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š

```powershell
try...
result: 5
finally...
END
```

ç”±äºæ²¡æœ‰é”™è¯¯å‘ç”Ÿï¼Œæ‰€ä»¥`except`è¯­å¥å—ä¸ä¼šè¢«æ‰§è¡Œï¼Œä½†æ˜¯`finally`å¦‚æœæœ‰ï¼Œåˆ™ä¸€å®šä¼šè¢«æ‰§è¡Œï¼ˆå¯ä»¥æ²¡æœ‰`finally`è¯­å¥ï¼‰ã€‚

ä½ è¿˜å¯ä»¥çŒœæµ‹ï¼Œé”™è¯¯åº”è¯¥æœ‰å¾ˆå¤šç§ç±»ï¼Œå¦‚æœå‘ç”Ÿäº†ä¸åŒç±»å‹çš„é”™è¯¯ï¼Œåº”è¯¥ç”±ä¸åŒçš„`except`è¯­å¥å—å¤„ç†ã€‚æ²¡é”™ï¼Œå¯ä»¥æœ‰å¤šä¸ª`except`æ¥æ•è·ä¸åŒç±»å‹çš„é”™è¯¯ï¼š

```python
try:
    print('try...')
    r = 10 / int('a')
    print('result:', r)
except ValueError as e:
    print('ValueError:', e)
except ZeroDivisionError as e:
    print('ZeroDivisionError:', e)
finally:
    print('finally...')
print('END')
```

`int()`å‡½æ•°å¯èƒ½ä¼šæŠ›å‡º`ValueError`ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€ä¸ª`except`æ•è·`ValueError`ï¼Œç”¨å¦ä¸€ä¸ª`except`æ•è·`ZeroDivisionError`ã€‚

æ­¤å¤–ï¼Œå¦‚æœæ²¡æœ‰é”™è¯¯å‘ç”Ÿï¼Œå¯ä»¥åœ¨`except`è¯­å¥å—åé¢åŠ ä¸€ä¸ª`else`ï¼Œå½“æ²¡æœ‰é”™è¯¯å‘ç”Ÿæ—¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œ`else`è¯­å¥ï¼š

```python
try:
    print('try...')
    r = 10 / int('2')
    print('result:', r)
except ValueError as e:
    print('ValueError:', e)
except ZeroDivisionError as e:
    print('ZeroDivisionError:', e)
else:
    print('no error!')
finally:
    print('finally...')
print('END')
```

Pythonçš„é”™è¯¯å…¶å®ä¹Ÿæ˜¯classï¼Œæ‰€æœ‰çš„é”™è¯¯ç±»å‹éƒ½ç»§æ‰¿è‡ª`BaseException`ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨`except`æ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒä¸ä½†æ•è·è¯¥ç±»å‹çš„é”™è¯¯ï¼Œè¿˜æŠŠå…¶å­ç±»ä¹Ÿâ€œä¸€ç½‘æ‰“å°½â€ã€‚æ¯”å¦‚ï¼š

```python
try:
    foo()
except ValueError as e:
    print('ValueError')
except UnicodeError as e:
    print('UnicodeError')
```

ç¬¬äºŒä¸ª`except`æ°¸è¿œä¹Ÿæ•è·ä¸åˆ°`UnicodeError`ï¼Œå› ä¸º`UnicodeError`æ˜¯`ValueError`çš„å­ç±»ï¼Œå¦‚æœæœ‰ï¼Œä¹Ÿè¢«ç¬¬ä¸€ä¸ª`except`ç»™æ•è·äº†ã€‚

Pythonæ‰€æœ‰çš„é”™è¯¯éƒ½æ˜¯ä»`BaseException`ç±»æ´¾ç”Ÿçš„ï¼Œå¸¸è§çš„é”™è¯¯ç±»å‹å’Œç»§æ‰¿å…³ç³»çœ‹è¿™é‡Œï¼š

https://docs.python.org/3/library/exceptions.html#exception-hierarchy

ä½¿ç”¨`try...except`æ•è·é”™è¯¯è¿˜æœ‰ä¸€ä¸ªå·¨å¤§çš„å¥½å¤„ï¼Œå°±æ˜¯å¯ä»¥è·¨è¶Šå¤šå±‚è°ƒç”¨ï¼Œæ¯”å¦‚å‡½æ•°`main()`è°ƒç”¨`bar()`ï¼Œ`bar()`è°ƒç”¨`foo()`ï¼Œç»“æœ`foo()`å‡ºé”™äº†ï¼Œè¿™æ—¶ï¼Œåªè¦`main()`æ•è·åˆ°äº†ï¼Œå°±å¯ä»¥å¤„ç†ï¼š

```python
def foo(s):
    return 10 / int(s)

def bar(s):
    return foo(s) * 2

def main():
    try:
        bar('0')
    except Exception as e:
        print('Error:', e)
    finally:
        print('finally...')
```

ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸éœ€è¦åœ¨æ¯ä¸ªå¯èƒ½å‡ºé”™çš„åœ°æ–¹å»æ•è·é”™è¯¯ï¼Œåªè¦åœ¨åˆé€‚çš„å±‚æ¬¡å»æ•è·é”™è¯¯å°±å¯ä»¥äº†ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±å¤§å¤§å‡å°‘äº†å†™`try...except...finally`çš„éº»çƒ¦ã€‚

### â‘¡ è°ƒç”¨æ ˆ

å¦‚æœé”™è¯¯æ²¡æœ‰è¢«æ•è·ï¼Œå®ƒå°±ä¼šä¸€ç›´å¾€ä¸ŠæŠ›ï¼Œæœ€åè¢«Pythonè§£é‡Šå™¨æ•è·ï¼Œæ‰“å°ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œç„¶åç¨‹åºé€€å‡ºã€‚æ¥çœ‹çœ‹`err.py`ï¼š

```python
# err.py:
def foo(s):
    return 10 / int(s)

def bar(s):
    return foo(s) * 2

def main():
    bar('0')

main()
```

æ‰§è¡Œï¼Œç»“æœå¦‚ä¸‹ï¼š

```powershell
$ python3 err.py
Traceback (most recent call last):
  File "err.py", line 11, in <module>
    main()
  File "err.py", line 9, in main
    bar('0')
  File "err.py", line 6, in bar
    return foo(s) * 2
  File "err.py", line 3, in foo
    return 10 / int(s)
ZeroDivisionError: division by zero
```

å‡ºé”™å¹¶ä¸å¯æ€•ï¼Œå¯æ€•çš„æ˜¯ä¸çŸ¥é“å“ªé‡Œå‡ºé”™äº†ã€‚è§£è¯»é”™è¯¯ä¿¡æ¯æ˜¯å®šä½é”™è¯¯çš„å…³é”®ã€‚æˆ‘ä»¬ä»ä¸Šå¾€ä¸‹å¯ä»¥çœ‹åˆ°æ•´ä¸ªé”™è¯¯çš„è°ƒç”¨å‡½æ•°é“¾ï¼š

é”™è¯¯ä¿¡æ¯ç¬¬1è¡Œï¼š

```powershell
Traceback (most recent call last):
```

å‘Šè¯‰æˆ‘ä»¬è¿™æ˜¯é”™è¯¯çš„è·Ÿè¸ªä¿¡æ¯ã€‚

ç¬¬2~3è¡Œï¼š

```powershell
  File "err.py", line 11, in <module>
    main()
```

è°ƒç”¨`main()`å‡ºé”™äº†ï¼Œåœ¨ä»£ç æ–‡ä»¶`err.py`çš„ç¬¬11è¡Œä»£ç ï¼Œä½†åŸå› æ˜¯ç¬¬9è¡Œï¼š

```powershell
  File "err.py", line 9, in main
    bar('0')
```

è°ƒç”¨`bar('0')`å‡ºé”™äº†ï¼Œåœ¨ä»£ç æ–‡ä»¶`err.py`çš„ç¬¬9è¡Œä»£ç ï¼Œä½†åŸå› æ˜¯ç¬¬6è¡Œï¼š

```powershell
  File "err.py", line 6, in bar
    return foo(s) * 2
```

åŸå› æ˜¯`return foo(s) * 2`è¿™ä¸ªè¯­å¥å‡ºé”™äº†ï¼Œä½†è¿™è¿˜ä¸æ˜¯æœ€ç»ˆåŸå› ï¼Œç»§ç»­å¾€ä¸‹çœ‹ï¼š

```powershell
  File "err.py", line 3, in foo
    return 10 / int(s)
```

åŸå› æ˜¯`return 10 / int(s)`è¿™ä¸ªè¯­å¥å‡ºé”™äº†ï¼Œè¿™æ˜¯é”™è¯¯äº§ç”Ÿçš„æºå¤´ï¼Œå› ä¸ºä¸‹é¢æ‰“å°äº†ï¼š

```powershell
ZeroDivisionError: integer division or modulo by zero
```

æ ¹æ®é”™è¯¯ç±»å‹`ZeroDivisionError`ï¼Œæˆ‘ä»¬åˆ¤æ–­ï¼Œ`int(s)`æœ¬èº«å¹¶æ²¡æœ‰å‡ºé”™ï¼Œä½†æ˜¯`int(s)`è¿”å›`0`ï¼Œåœ¨è®¡ç®—`10 / 0`æ—¶å‡ºé”™ï¼Œè‡³æ­¤ï¼Œæ‰¾åˆ°é”™è¯¯æºå¤´ã€‚

 å‡ºé”™çš„æ—¶å€™ï¼Œä¸€å®šè¦åˆ†æé”™è¯¯çš„è°ƒç”¨æ ˆä¿¡æ¯ï¼Œæ‰èƒ½å®šä½é”™è¯¯çš„ä½ç½®ã€‚

### â‘¢ è®°å½•é”™è¯¯ logging

å¦‚æœä¸æ•è·é”™è¯¯ï¼Œè‡ªç„¶å¯ä»¥è®©Pythonè§£é‡Šå™¨æ¥æ‰“å°å‡ºé”™è¯¯å †æ ˆï¼Œä½†ç¨‹åºä¹Ÿè¢«ç»“æŸäº†ã€‚æ—¢ç„¶æˆ‘ä»¬èƒ½æ•è·é”™è¯¯ï¼Œå°±å¯ä»¥æŠŠé”™è¯¯å †æ ˆæ‰“å°å‡ºæ¥ï¼Œç„¶ååˆ†æé”™è¯¯åŸå› ï¼ŒåŒæ—¶ï¼Œè®©ç¨‹åºç»§ç»­æ‰§è¡Œä¸‹å»ã€‚

Pythonå†…ç½®çš„`logging`æ¨¡å—å¯ä»¥éå¸¸å®¹æ˜“åœ°è®°å½•é”™è¯¯ä¿¡æ¯ï¼š

```python
# err_logging.py

import logging

def foo(s):
    return 10 / int(s)

def bar(s):
    return foo(s) * 2

def main():
    try:
        bar('0')
    except Exception as e:
        logging.exception(e)

main()
print('END')
```

åŒæ ·æ˜¯å‡ºé”™ï¼Œä½†ç¨‹åºæ‰“å°å®Œé”™è¯¯ä¿¡æ¯åä¼šç»§ç»­æ‰§è¡Œï¼Œå¹¶æ­£å¸¸é€€å‡ºï¼š

```powershell
$ python3 err_logging.py
ERROR:root:division by zero
Traceback (most recent call last):
  File "err_logging.py", line 13, in main
    bar('0')
  File "err_logging.py", line 9, in bar
    return foo(s) * 2
  File "err_logging.py", line 6, in foo
    return 10 / int(s)
ZeroDivisionError: division by zero
END
```

é€šè¿‡é…ç½®ï¼Œ`logging`è¿˜å¯ä»¥æŠŠé”™è¯¯è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶é‡Œï¼Œæ–¹ä¾¿äº‹åæ’æŸ¥ã€‚

### â‘£ æŠ›å‡ºé”™è¯¯ raise

å› ä¸º**é”™è¯¯æ˜¯classï¼Œæ•è·ä¸€ä¸ªé”™è¯¯å°±æ˜¯æ•è·åˆ°è¯¥classçš„ä¸€ä¸ªå®ä¾‹**ã€‚å› æ­¤ï¼Œé”™è¯¯å¹¶ä¸æ˜¯å‡­ç©ºäº§ç”Ÿçš„ï¼Œè€Œæ˜¯æœ‰æ„åˆ›å»ºå¹¶æŠ›å‡ºçš„ã€‚Pythonçš„å†…ç½®å‡½æ•°ä¼šæŠ›å‡ºå¾ˆå¤šç±»å‹çš„é”™è¯¯ï¼Œæˆ‘ä»¬è‡ªå·±ç¼–å†™çš„å‡½æ•°ä¹Ÿå¯ä»¥æŠ›å‡ºé”™è¯¯ã€‚

ğŸš© å¦‚æœè¦æŠ›å‡ºé”™è¯¯ï¼Œé¦–å…ˆæ ¹æ®éœ€è¦ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªé”™è¯¯çš„classï¼Œé€‰æ‹©å¥½ç»§æ‰¿å…³ç³»ï¼Œç„¶åï¼Œç”¨`raise`è¯­å¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯çš„å®ä¾‹ï¼š

```python
# err_raise.py
class FooError(ValueError):
    pass

def foo(s):
    n = int(s)
    if n==0:
        raise FooError('invalid value: %s' % s)
    return 10 / n

foo('0')
```

æ‰§è¡Œï¼Œå¯ä»¥æœ€åè·Ÿè¸ªåˆ°æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„é”™è¯¯ï¼š

```powershell
$ python3 err_raise.py 
Traceback (most recent call last):
  File "err_throw.py", line 11, in <module>
    foo('0')
  File "err_throw.py", line 8, in foo
    raise FooError('invalid value: %s' % s)
__main__.FooError: invalid value: 0
```

åªæœ‰åœ¨å¿…è¦çš„æ—¶å€™æ‰å®šä¹‰æˆ‘ä»¬è‡ªå·±çš„é”™è¯¯ç±»å‹ã€‚å¦‚æœå¯ä»¥é€‰æ‹©Pythonå·²æœ‰çš„å†…ç½®çš„é”™è¯¯ç±»å‹ï¼ˆæ¯”å¦‚`ValueError`ï¼Œ`TypeError`ï¼‰ï¼Œå°½é‡ä½¿ç”¨Pythonå†…ç½®çš„é”™è¯¯ç±»å‹ã€‚

æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹å¦ä¸€ç§é”™è¯¯å¤„ç†çš„æ–¹å¼ï¼š

```python
# err_reraise.py

def foo(s):
    n = int(s)
    if n==0:
        raise ValueError('invalid value: %s' % s)
    return 10 / n

def bar():
    try:
        foo('0')
    except ValueError as e:
        print('ValueError!')
        raise

bar()
```

åœ¨`bar()`å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ˜æ˜å·²ç»æ•è·äº†é”™è¯¯ï¼Œä½†æ˜¯ï¼Œæ‰“å°ä¸€ä¸ª`ValueError!`åï¼ŒåˆæŠŠé”™è¯¯é€šè¿‡`raise`è¯­å¥æŠ›å‡ºå»äº†ï¼Œè¿™ä¸æœ‰ç—…ä¹ˆï¼Ÿ

å…¶å®è¿™ç§é”™è¯¯å¤„ç†æ–¹å¼ä¸ä½†æ²¡ç—…ï¼Œè€Œä¸”ç›¸å½“å¸¸è§ã€‚æ•è·é”™è¯¯ç›®çš„åªæ˜¯è®°å½•ä¸€ä¸‹ï¼Œä¾¿äºåç»­è¿½è¸ªã€‚ä½†æ˜¯ï¼Œç”±äºå½“å‰å‡½æ•°ä¸çŸ¥é“åº”è¯¥æ€ä¹ˆå¤„ç†è¯¥é”™è¯¯ï¼Œæ‰€ä»¥ï¼Œæœ€æ°å½“çš„æ–¹å¼æ˜¯ç»§ç»­å¾€ä¸ŠæŠ›ï¼Œè®©é¡¶å±‚è°ƒç”¨è€…å»å¤„ç†ã€‚å¥½æ¯”ä¸€ä¸ªå‘˜å·¥å¤„ç†ä¸äº†ä¸€ä¸ªé—®é¢˜æ—¶ï¼Œå°±æŠŠé—®é¢˜æŠ›ç»™ä»–çš„è€æ¿ï¼Œå¦‚æœä»–çš„è€æ¿ä¹Ÿå¤„ç†ä¸äº†ï¼Œå°±ä¸€ç›´å¾€ä¸ŠæŠ›ï¼Œæœ€ç»ˆä¼šæŠ›ç»™CEOå»å¤„ç†ã€‚

`raise`è¯­å¥å¦‚æœä¸å¸¦å‚æ•°ï¼Œå°±ä¼šæŠŠå½“å‰é”™è¯¯åŸæ ·æŠ›å‡ºã€‚æ­¤å¤–ï¼Œåœ¨`except`ä¸­`raise`ä¸€ä¸ªErrorï¼Œè¿˜å¯ä»¥æŠŠä¸€ç§ç±»å‹çš„é”™è¯¯è½¬åŒ–æˆå¦ä¸€ç§ç±»å‹ï¼š

```python
try:
    10 / 0
except ZeroDivisionError:
    raise ValueError('input error!')
```

åªè¦æ˜¯åˆç†çš„è½¬æ¢é€»è¾‘å°±å¯ä»¥ï¼Œä½†æ˜¯ï¼Œå†³ä¸åº”è¯¥æŠŠä¸€ä¸ª`IOError`è½¬æ¢æˆæ¯«ä¸ç›¸å¹²çš„`ValueError`ã€‚

## 2. è°ƒè¯•

### â‘  print()

ç¬¬ä¸€ç§æ–¹æ³•ç®€å•ç›´æ¥ç²—æš´æœ‰æ•ˆï¼Œå°±æ˜¯ç”¨`print()`æŠŠå¯èƒ½æœ‰é—®é¢˜çš„å˜é‡æ‰“å°å‡ºæ¥çœ‹çœ‹ï¼š

```python
def foo(s):
    n = int(s)
    print('>>> n = %d' % n)
    return 10 / n

def main():
    foo('0')

main()
```

æ‰§è¡Œååœ¨è¾“å‡ºä¸­æŸ¥æ‰¾æ‰“å°çš„å˜é‡å€¼ï¼š

```powershell
$ python err.py
>>> n = 0
Traceback (most recent call last):
  ...
ZeroDivisionError: integer division or modulo by zero
```

ç”¨`print()`æœ€å¤§çš„åå¤„æ˜¯å°†æ¥è¿˜å¾—åˆ æ‰å®ƒï¼Œæƒ³æƒ³ç¨‹åºé‡Œåˆ°å¤„éƒ½æ˜¯`print()`ï¼Œè¿è¡Œç»“æœä¹Ÿä¼šåŒ…å«å¾ˆå¤šåƒåœ¾ä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åˆæœ‰ç¬¬äºŒç§æ–¹æ³•ã€‚

### â‘¡ æ–­è¨€

å‡¡æ˜¯ç”¨`print()`æ¥è¾…åŠ©æŸ¥çœ‹çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥ç”¨æ–­è¨€ï¼ˆassertï¼‰æ¥æ›¿ä»£ï¼š

```python
def foo(s):
    n = int(s)
    assert n != 0, 'n is zero!'
    return 10 / n

def main():
    foo('0')
```

`assert`çš„æ„æ€æ˜¯ï¼Œè¡¨è¾¾å¼`n != 0`åº”è¯¥æ˜¯`True`ï¼Œå¦åˆ™ï¼Œæ ¹æ®ç¨‹åºè¿è¡Œçš„é€»è¾‘ï¼Œåé¢çš„ä»£ç è‚¯å®šä¼šå‡ºé”™ã€‚

å¦‚æœæ–­è¨€å¤±è´¥ï¼Œ`assert`è¯­å¥æœ¬èº«å°±ä¼šæŠ›å‡º`AssertionError`ï¼š

```powershell
$ python err.py
Traceback (most recent call last):
  ...
AssertionError: n is zero!
```

ç¨‹åºä¸­å¦‚æœåˆ°å¤„å……æ–¥ç€`assert`ï¼Œå’Œ`print()`ç›¸æ¯”ä¹Ÿå¥½ä¸åˆ°å“ªå»ã€‚<u>ä¸è¿‡ï¼Œå¯åŠ¨Pythonè§£é‡Šå™¨æ—¶å¯ä»¥ç”¨`-O`å‚æ•°æ¥å…³é—­`assert`ï¼š</u>

```powershell
$ python -O err.py
Traceback (most recent call last):
  ...
ZeroDivisionError: division by zero
```

 æ³¨æ„ï¼šæ–­è¨€çš„å¼€å…³â€œ-Oâ€æ˜¯è‹±æ–‡å¤§å†™å­—æ¯Oï¼Œä¸æ˜¯æ•°å­—0ã€‚

å…³é—­åï¼Œä½ å¯ä»¥æŠŠæ‰€æœ‰çš„`assert`è¯­å¥å½“æˆ`pass`æ¥çœ‹ã€‚

### â‘¢ logging

æŠŠ`print()`æ›¿æ¢ä¸º`logging`æ˜¯ç¬¬3ç§æ–¹å¼ï¼Œå’Œ`assert`æ¯”ï¼Œ`logging`ä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè€Œä¸”å¯ä»¥è¾“å‡ºåˆ°æ–‡ä»¶ï¼š

```python
import logging

s = '0'
n = int(s)
logging.info('n = %d' % n)
print(10 / n)
```

`logging.info()`å°±å¯ä»¥è¾“å‡ºä¸€æ®µæ–‡æœ¬ã€‚è¿è¡Œï¼Œå‘ç°é™¤äº†`ZeroDivisionError`ï¼Œæ²¡æœ‰ä»»ä½•ä¿¡æ¯ã€‚æ€ä¹ˆå›äº‹ï¼Ÿ

åˆ«æ€¥ï¼Œåœ¨`import logging`ä¹‹åæ·»åŠ ä¸€è¡Œé…ç½®å†è¯•è¯•ï¼š

```python
import logging
logging.basicConfig(level=logging.INFO)
```

çœ‹åˆ°è¾“å‡ºäº†ï¼š

```powershell
$ python err.py
INFO:root:n = 0
Traceback (most recent call last):
  File "err.py", line 8, in <module>
    print(10 / n)
ZeroDivisionError: division by zero
```

è¿™å°±æ˜¯`logging`çš„å¥½å¤„ï¼Œå®ƒå…è®¸ä½ æŒ‡å®šè®°å½•ä¿¡æ¯çš„çº§åˆ«ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªçº§åˆ«ï¼Œçº§åˆ«ç”±ä½åˆ°é«˜ï¼š

- `debug`ï¼Œ
- `info`ï¼Œ
- `warning`ï¼Œ
- `error`

å½“æˆ‘ä»¬æŒ‡å®š`level=INFO`æ—¶ï¼Œä½ç­‰çº§çš„`logging.debug`å°±ä¸èµ·ä½œç”¨äº†ã€‚åŒç†ï¼ŒæŒ‡å®š`level=WARNING`åï¼Œä½ç­‰çº§`debug`å’Œ`info`å°±ä¸èµ·ä½œç”¨äº†ã€‚è¿™æ ·ä¸€æ¥ï¼Œä½ å¯ä»¥æ”¾å¿ƒåœ°è¾“å‡ºä¸åŒçº§åˆ«çš„ä¿¡æ¯ï¼Œä¹Ÿä¸ç”¨åˆ é™¤ï¼Œæœ€åç»Ÿä¸€æ§åˆ¶è¾“å‡ºå“ªä¸ªçº§åˆ«çš„ä¿¡æ¯ã€‚

`logging`çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯é€šè¿‡ç®€å•çš„é…ç½®ï¼Œä¸€æ¡è¯­å¥å¯ä»¥åŒæ—¶è¾“å‡ºåˆ°ä¸åŒçš„åœ°æ–¹ï¼Œæ¯”å¦‚consoleå’Œæ–‡ä»¶ã€‚

### â‘£ pdb

ç¬¬4ç§æ–¹å¼æ˜¯å¯åŠ¨Pythonçš„è°ƒè¯•å™¨pdbï¼Œè®©ç¨‹åºä»¥å•æ­¥æ–¹å¼è¿è¡Œï¼Œå¯ä»¥éšæ—¶æŸ¥çœ‹è¿è¡ŒçŠ¶æ€ã€‚æˆ‘ä»¬å…ˆå‡†å¤‡å¥½ç¨‹åºï¼š

```python
# err.py
s = '0'
n = int(s)
print(10 / n)
```

ç„¶åå¯åŠ¨ï¼š

```powershell
$ python -m pdb err.py
> /Users/michael/Github/learn-python3/samples/debug/err.py(2)<module>()
-> s = '0'
```

ä»¥å‚æ•°`-m pdb`å¯åŠ¨åï¼Œpdbå®šä½åˆ°ä¸‹ä¸€æ­¥è¦æ‰§è¡Œçš„ä»£ç `-> s = '0'`ã€‚è¾“å…¥å‘½ä»¤`l`æ¥æŸ¥çœ‹ä»£ç ï¼š

```powershell
(Pdb) l
  1     # err.py
  2  -> s = '0'
  3     n = int(s)
  4     print(10 / n)
```

è¾“å…¥å‘½ä»¤`n`å¯ä»¥å•æ­¥æ‰§è¡Œä»£ç ï¼š

```powershell
(Pdb) n
> /Users/michael/Github/learn-python3/samples/debug/err.py(3)<module>()
-> n = int(s)
(Pdb) n
> /Users/michael/Github/learn-python3/samples/debug/err.py(4)<module>()
-> print(10 / n)
```

ä»»ä½•æ—¶å€™éƒ½å¯ä»¥è¾“å…¥å‘½ä»¤`p å˜é‡å`æ¥æŸ¥çœ‹å˜é‡ï¼š

```powershell
(Pdb) p s
'0'
(Pdb) p n
0
```

è¾“å…¥å‘½ä»¤`q`ç»“æŸè°ƒè¯•ï¼Œé€€å‡ºç¨‹åºï¼š

```powershell
(Pdb) q
```

è¿™ç§é€šè¿‡pdbåœ¨å‘½ä»¤è¡Œè°ƒè¯•çš„æ–¹æ³•ç†è®ºä¸Šæ˜¯ä¸‡èƒ½çš„ï¼Œä½†å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ï¼Œå¦‚æœæœ‰ä¸€åƒè¡Œä»£ç ï¼Œè¦è¿è¡Œåˆ°ç¬¬999è¡Œå¾—æ•²å¤šå°‘å‘½ä»¤å•Šã€‚è¿˜å¥½ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦ä¸€ç§è°ƒè¯•æ–¹æ³•ã€‚

### â‘¤ pdb.set_trace()

è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯ç”¨pdbï¼Œä½†æ˜¯ä¸éœ€è¦å•æ­¥æ‰§è¡Œï¼Œæˆ‘ä»¬åªéœ€è¦`import pdb`ï¼Œç„¶åï¼Œåœ¨å¯èƒ½å‡ºé”™çš„åœ°æ–¹æ”¾ä¸€ä¸ª`pdb.set_trace()`ï¼Œå°±å¯ä»¥è®¾ç½®ä¸€ä¸ªæ–­ç‚¹ï¼š

```python
# err.py
import pdb

s = '0'
n = int(s)
pdb.set_trace() # è¿è¡Œåˆ°è¿™é‡Œä¼šè‡ªåŠ¨æš‚åœ
print(10 / n)
```

è¿è¡Œä»£ç ï¼Œç¨‹åºä¼šè‡ªåŠ¨åœ¨`pdb.set_trace()`æš‚åœå¹¶è¿›å…¥pdbè°ƒè¯•ç¯å¢ƒï¼Œå¯ä»¥ç”¨å‘½ä»¤`p`æŸ¥çœ‹å˜é‡ï¼Œæˆ–è€…ç”¨å‘½ä»¤`c`ç»§ç»­è¿è¡Œï¼š

```powershell
$ python err.py 
> /Users/michael/Github/learn-python3/samples/debug/err.py(7)<module>()
-> print(10 / n)
(Pdb) p n
0
(Pdb) c
Traceback (most recent call last):
  File "err.py", line 7, in <module>
    print(10 / n)
ZeroDivisionError: division by zero
```

è¿™ä¸ªæ–¹å¼æ¯”ç›´æ¥å¯åŠ¨pdbå•æ­¥è°ƒè¯•æ•ˆç‡è¦é«˜å¾ˆå¤šï¼Œä½†ä¹Ÿé«˜ä¸åˆ°å“ªå»ã€‚



> å¦‚æœè¦æ¯”è¾ƒçˆ½åœ°è®¾ç½®æ–­ç‚¹ã€å•æ­¥æ‰§è¡Œï¼Œå°±éœ€è¦ä¸€ä¸ªæ”¯æŒè°ƒè¯•åŠŸèƒ½çš„IDEã€‚ç›®å‰æ¯”è¾ƒå¥½çš„Python IDEæœ‰ï¼š
>
> Visual Studio Codeï¼šhttps://code.visualstudio.com/ï¼Œéœ€è¦å®‰è£…Pythonæ’ä»¶ã€‚
>
> PyCharmï¼šhttp://www.jetbrains.com/pycharm/

## 3. å•å…ƒæµ‹è¯•

### â‘  æ¦‚å¿µ

å•å…ƒæµ‹è¯•æ˜¯ç”¨æ¥å¯¹ä¸€ä¸ªæ¨¡å—ã€ä¸€ä¸ªå‡½æ•°æˆ–è€…ä¸€ä¸ªç±»æ¥è¿›è¡Œæ­£ç¡®æ€§æ£€éªŒçš„æµ‹è¯•å·¥ä½œã€‚

æ¯”å¦‚å¯¹å‡½æ•°`abs()`ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™å‡ºä»¥ä¸‹å‡ ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š

- è¾“å…¥æ­£æ•°ï¼Œæ¯”å¦‚`1`ã€`1.2`ã€`0.99`ï¼ŒæœŸå¾…è¿”å›å€¼ä¸è¾“å…¥ç›¸åŒï¼›

- è¾“å…¥è´Ÿæ•°ï¼Œæ¯”å¦‚`-1`ã€`-1.2`ã€`-0.99`ï¼ŒæœŸå¾…è¿”å›å€¼ä¸è¾“å…¥ç›¸åï¼›

- è¾“å…¥`0`ï¼ŒæœŸå¾…è¿”å›`0`ï¼›

- è¾“å…¥éæ•°å€¼ç±»å‹ï¼Œæ¯”å¦‚`None`ã€`[]`ã€`{}`ï¼ŒæœŸå¾…æŠ›å‡º`TypeError`ã€‚

æŠŠä¸Šé¢çš„æµ‹è¯•ç”¨ä¾‹æ”¾åˆ°ä¸€ä¸ªæµ‹è¯•æ¨¡å—é‡Œï¼Œå°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„å•å…ƒæµ‹è¯•ã€‚

å¦‚æœå•å…ƒæµ‹è¯•é€šè¿‡ï¼Œè¯´æ˜æˆ‘ä»¬æµ‹è¯•çš„è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚å¦‚æœå•å…ƒæµ‹è¯•ä¸é€šè¿‡ï¼Œè¦ä¹ˆå‡½æ•°æœ‰bugï¼Œè¦ä¹ˆæµ‹è¯•æ¡ä»¶è¾“å…¥ä¸æ­£ç¡®ï¼Œæ€»ä¹‹ï¼Œéœ€è¦ä¿®å¤ä½¿å•å…ƒæµ‹è¯•èƒ½å¤Ÿé€šè¿‡ã€‚

å•å…ƒæµ‹è¯•é€šè¿‡åæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬å¯¹`abs()`å‡½æ•°ä»£ç åšäº†ä¿®æ”¹ï¼Œåªéœ€è¦å†è·‘ä¸€éå•å…ƒæµ‹è¯•ï¼Œå¦‚æœé€šè¿‡ï¼Œè¯´æ˜æˆ‘ä»¬çš„ä¿®æ”¹ä¸ä¼šå¯¹`abs()`å‡½æ•°åŸæœ‰çš„è¡Œä¸ºé€ æˆå½±å“ï¼Œå¦‚æœæµ‹è¯•ä¸é€šè¿‡ï¼Œè¯´æ˜æˆ‘ä»¬çš„ä¿®æ”¹ä¸åŸæœ‰è¡Œä¸ºä¸ä¸€è‡´ï¼Œè¦ä¹ˆä¿®æ”¹ä»£ç ï¼Œè¦ä¹ˆä¿®æ”¹æµ‹è¯•ã€‚

è¿™ç§ä»¥æµ‹è¯•ä¸ºé©±åŠ¨çš„å¼€å‘æ¨¡å¼æœ€å¤§çš„å¥½å¤„å°±æ˜¯ç¡®ä¿ä¸€ä¸ªç¨‹åºæ¨¡å—çš„è¡Œä¸ºç¬¦åˆæˆ‘ä»¬è®¾è®¡çš„æµ‹è¯•ç”¨ä¾‹ã€‚åœ¨å°†æ¥ä¿®æ”¹çš„æ—¶å€™ï¼Œå¯ä»¥æå¤§ç¨‹åº¦åœ°ä¿è¯è¯¥æ¨¡å—è¡Œä¸ºä»ç„¶æ˜¯æ­£ç¡®çš„ã€‚

### â‘¡ ç¼–å†™å•å…ƒæµ‹è¯•

æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ª`Dict`ç±»ï¼Œè¿™ä¸ªç±»çš„è¡Œä¸ºå’Œ`dict`ä¸€è‡´ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å±æ€§æ¥è®¿é—®ï¼Œç”¨èµ·æ¥å°±åƒä¸‹é¢è¿™æ ·ï¼š

```python
>>> d = Dict(a=1, b=2)
>>> d['a']
1
>>> d.a
1
```

`mydict.py`ä»£ç å¦‚ä¸‹ï¼š

```python
class Dict(dict):

    def __init__(self, **kw):
        super().__init__(**kw)

    def __getattr__(self, key):
        try:
            return self[key]
        except KeyError:
            raise AttributeError(r"'Dict' object has no attribute '%s'" % key)

    def __setattr__(self, key, value):
        self[key] = value
```

ä¸ºäº†ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥Pythonè‡ªå¸¦çš„`unittest`æ¨¡å—ï¼Œç¼–å†™`mydict_test.py`å¦‚ä¸‹ï¼š

```python
import unittest

from mydict import Dict

class TestDict(unittest.TestCase):

    def test_init(self):
        d = Dict(a=1, b='test')
        self.assertEqual(d.a, 1)
        self.assertEqual(d.b, 'test')
        self.assertTrue(isinstance(d, dict))

    def test_key(self):
        d = Dict()
        d['key'] = 'value'
        self.assertEqual(d.key, 'value')

    def test_attr(self):
        d = Dict()
        d.key = 'value'
        self.assertTrue('key' in d)
        self.assertEqual(d['key'], 'value')

    def test_keyerror(self):
        d = Dict()
        with self.assertRaises(KeyError):
            value = d['empty']

    def test_attrerror(self):
        d = Dict()
        with self.assertRaises(AttributeError):
            value = d.empty
```

ğŸš© **ç¼–å†™å•å…ƒæµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªæµ‹è¯•ç±»ï¼Œä»`unittest.TestCase`ç»§æ‰¿ã€‚**

**ä»¥`test`å¼€å¤´çš„æ–¹æ³•å°±æ˜¯æµ‹è¯•æ–¹æ³•**ï¼Œä¸ä»¥`test`å¼€å¤´çš„æ–¹æ³•ä¸è¢«è®¤ä¸ºæ˜¯æµ‹è¯•æ–¹æ³•ï¼Œæµ‹è¯•çš„æ—¶å€™ä¸ä¼šè¢«æ‰§è¡Œã€‚

å¯¹æ¯ä¸€ç±»æµ‹è¯•éƒ½éœ€è¦ç¼–å†™ä¸€ä¸ª`test_xxx()`æ–¹æ³•ã€‚ç”±äº`unittest.TestCase`æä¾›äº†å¾ˆå¤šå†…ç½®çš„æ¡ä»¶åˆ¤æ–­ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨è¿™äº›æ–¹æ³•å°±å¯ä»¥æ–­è¨€è¾“å‡ºæ˜¯å¦æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ã€‚æœ€å¸¸ç”¨çš„æ–­è¨€å°±æ˜¯`assertEqual()`ï¼š

```python
self.assertEqual(abs(-1), 1) # æ–­è¨€å‡½æ•°è¿”å›çš„ç»“æœä¸1ç›¸ç­‰
```

å¦ä¸€ç§é‡è¦çš„æ–­è¨€å°±æ˜¯æœŸå¾…æŠ›å‡ºæŒ‡å®šç±»å‹çš„Errorï¼Œæ¯”å¦‚é€šè¿‡`d['empty']`è®¿é—®ä¸å­˜åœ¨çš„keyæ—¶ï¼Œæ–­è¨€ä¼šæŠ›å‡º`KeyError`ï¼š

```python
with self.assertRaises(KeyError):
    value = d['empty']
```

è€Œé€šè¿‡`d.empty`è®¿é—®ä¸å­˜åœ¨çš„keyæ—¶ï¼Œæˆ‘ä»¬æœŸå¾…æŠ›å‡º`AttributeError`ï¼š

```python
with self.assertRaises(AttributeError):
    value = d.empty
```

### â‘¢ è¿è¡Œå•å…ƒæµ‹è¯•

ä¸€æ—¦ç¼–å†™å¥½å•å…ƒæµ‹è¯•ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿è¡Œå•å…ƒæµ‹è¯•ã€‚æœ€ç®€å•çš„è¿è¡Œæ–¹å¼æ˜¯åœ¨`mydict_test.py`çš„æœ€ååŠ ä¸Šä¸¤è¡Œä»£ç ï¼š

```python
if __name__ == '__main__':
    unittest.main()
```

è¿™æ ·å°±å¯ä»¥æŠŠ`mydict_test.py`å½“åšæ­£å¸¸çš„pythonè„šæœ¬è¿è¡Œï¼š

```powershell
$ python mydict_test.py
```

å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨å‘½ä»¤è¡Œé€šè¿‡å‚æ•°`-m unittest`ç›´æ¥è¿è¡Œå•å…ƒæµ‹è¯•ï¼š

```powershell
$ python -m unittest mydict_test
.....
----------------------------------------------------------------------
Ran 5 tests in 0.000s

OK
```

è¿™æ˜¯æ¨èçš„åšæ³•ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥ä¸€æ¬¡æ‰¹é‡è¿è¡Œå¾ˆå¤šå•å…ƒæµ‹è¯•ï¼Œå¹¶ä¸”ï¼Œæœ‰å¾ˆå¤šå·¥å…·å¯ä»¥è‡ªåŠ¨æ¥è¿è¡Œè¿™äº›å•å…ƒæµ‹è¯•ã€‚

### â‘£ setUp ä¸ tearDown

å¯ä»¥åœ¨å•å…ƒæµ‹è¯•ä¸­ç¼–å†™ä¸¤ä¸ªç‰¹æ®Šçš„`setUp()`å’Œ`tearDown()`æ–¹æ³•ã€‚**è¿™ä¸¤ä¸ªæ–¹æ³•ä¼šåˆ†åˆ«åœ¨æ¯è°ƒç”¨ä¸€ä¸ªæµ‹è¯•æ–¹æ³•çš„å‰ååˆ†åˆ«è¢«æ‰§è¡Œã€‚**

`setUp()`å’Œ`tearDown()`æ–¹æ³•æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿè®¾æƒ³ä½ çš„æµ‹è¯•éœ€è¦å¯åŠ¨ä¸€ä¸ªæ•°æ®åº“ï¼Œè¿™æ—¶ï¼Œå°±å¯ä»¥åœ¨`setUp()`æ–¹æ³•ä¸­è¿æ¥æ•°æ®åº“ï¼Œåœ¨`tearDown()`æ–¹æ³•ä¸­å…³é—­æ•°æ®åº“ï¼Œ**è¿™æ ·ï¼Œä¸å¿…åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•ä¸­é‡å¤ç›¸åŒçš„ä»£ç **ï¼š

```python
class TestDict(unittest.TestCase):

    def setUp(self):
        print('setUp...')

    def tearDown(self):
        print('tearDown...')
```

å¯ä»¥å†æ¬¡è¿è¡Œæµ‹è¯•çœ‹çœ‹æ¯ä¸ªæµ‹è¯•æ–¹æ³•è°ƒç”¨å‰åæ˜¯å¦ä¼šæ‰“å°å‡º`setUp...`å’Œ`tearDown...`ã€‚

## 4. æ–‡æ¡£æµ‹è¯• doctest

å¦‚æœä½ ç»å¸¸é˜…è¯»Pythonçš„å®˜æ–¹æ–‡æ¡£ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤šæ–‡æ¡£éƒ½æœ‰ç¤ºä¾‹ä»£ç ã€‚æ¯”å¦‚[reæ¨¡å—](https://docs.python.org/3/library/re.html)å°±å¸¦äº†å¾ˆå¤šç¤ºä¾‹ä»£ç ï¼š

```python
>>> import re
>>> m = re.search('(?<=abc)def', 'abcdef')
>>> m.group(0)
'def'
```

å¯ä»¥æŠŠè¿™äº›ç¤ºä¾‹ä»£ç åœ¨Pythonçš„äº¤äº’å¼ç¯å¢ƒä¸‹è¾“å…¥å¹¶æ‰§è¡Œï¼Œç»“æœä¸æ–‡æ¡£ä¸­çš„ç¤ºä¾‹ä»£ç æ˜¾ç¤ºçš„ä¸€è‡´ã€‚

è¿™äº›ä»£ç ä¸å…¶ä»–è¯´æ˜å¯ä»¥å†™åœ¨æ³¨é‡Šä¸­ï¼Œç„¶åï¼Œç”±ä¸€äº›å·¥å…·æ¥è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ã€‚æ—¢ç„¶è¿™äº›ä»£ç æœ¬èº«å°±å¯ä»¥ç²˜è´´å‡ºæ¥ç›´æ¥è¿è¡Œï¼Œé‚£ä¹ˆï¼Œå¯ä¸å¯ä»¥è‡ªåŠ¨æ‰§è¡Œå†™åœ¨æ³¨é‡Šä¸­çš„è¿™äº›ä»£ç å‘¢ï¼Ÿ

ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚

å½“æˆ‘ä»¬ç¼–å†™æ³¨é‡Šæ—¶ï¼Œå¦‚æœå†™ä¸Šè¿™æ ·çš„æ³¨é‡Šï¼š

```python
def abs(n):
    '''
    Function to get absolute value of number.
    
    Example:
    
    >>> abs(1)
    1
    >>> abs(-1)
    1
    >>> abs(0)
    0
    '''
    return n if n >= 0 else (-n)
```

æ— ç–‘æ›´æ˜ç¡®åœ°å‘Šè¯‰å‡½æ•°çš„è°ƒç”¨è€…è¯¥å‡½æ•°çš„æœŸæœ›è¾“å…¥å’Œè¾“å‡ºã€‚

å¹¶ä¸”ï¼ŒPythonå†…ç½®çš„â€œæ–‡æ¡£æµ‹è¯•â€ï¼ˆdoctestï¼‰æ¨¡å—å¯ä»¥ç›´æ¥æå–æ³¨é‡Šä¸­çš„ä»£ç å¹¶æ‰§è¡Œæµ‹è¯•ã€‚

doctest ä¸¥æ ¼æŒ‰ç…§Pythonäº¤äº’å¼å‘½ä»¤è¡Œçš„è¾“å…¥å’Œè¾“å‡ºæ¥åˆ¤æ–­æµ‹è¯•ç»“æœæ˜¯å¦æ­£ç¡®ã€‚åªæœ‰æµ‹è¯•å¼‚å¸¸çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨`...`è¡¨ç¤ºä¸­é—´ä¸€å¤§æ®µçƒ¦äººçš„è¾“å‡ºã€‚

è®©æˆ‘ä»¬ç”¨ doctest æ¥æµ‹è¯•ä¸Šæ¬¡ç¼–å†™çš„`Dict`ç±»ï¼š

```python
# mydict2.py
class Dict(dict):
    '''
    Simple dict but also support access as x.y style.

    >>> d1 = Dict()
    >>> d1['x'] = 100
    >>> d1.x
    100
    >>> d1.y = 200
    >>> d1['y']
    200
    >>> d2 = Dict(a=1, b=2, c='3')
    >>> d2.c
    '3'
    >>> d2['empty']
    Traceback (most recent call last):
        ...
    KeyError: 'empty'
    >>> d2.empty
    Traceback (most recent call last):
        ...
    AttributeError: 'Dict' object has no attribute 'empty'
    '''
    def __init__(self, **kw):
        super(Dict, self).__init__(**kw)

    def __getattr__(self, key):
        try:
            return self[key]
        except KeyError:
            raise AttributeError(r"'Dict' object has no attribute '%s'" % key)

    def __setattr__(self, key, value):
        self[key] = value

if __name__=='__main__':
    import doctest
    doctest.testmod()
```

è¿è¡Œ`python mydict2.py`ï¼š

```powershell
$ python mydict2.py
```

ä»€ä¹ˆè¾“å‡ºä¹Ÿæ²¡æœ‰ã€‚è¿™è¯´æ˜æˆ‘ä»¬ç¼–å†™çš„doctestè¿è¡Œéƒ½æ˜¯æ­£ç¡®çš„ã€‚å¦‚æœç¨‹åºæœ‰é—®é¢˜ï¼Œæ¯”å¦‚æŠŠ`__getattr__()`æ–¹æ³•æ³¨é‡Šæ‰ï¼Œå†è¿è¡Œå°±ä¼šæŠ¥é”™ï¼š

```powershell
$ python mydict2.py
**********************************************************************
File "/Users/michael/Github/learn-python3/samples/debug/mydict2.py", line 10, in __main__.Dict
Failed example:
    d1.x
Exception raised:
    Traceback (most recent call last):
      ...
    AttributeError: 'Dict' object has no attribute 'x'
**********************************************************************
File "/Users/michael/Github/learn-python3/samples/debug/mydict2.py", line 16, in __main__.Dict
Failed example:
    d2.c
Exception raised:
    Traceback (most recent call last):
      ...
    AttributeError: 'Dict' object has no attribute 'c'
**********************************************************************
1 items had failures:
   2 of   9 in __main__.Dict
***Test Failed*** 2 failures.
```

æ³¨æ„åˆ°æœ€å3è¡Œä»£ç ã€‚å½“æ¨¡å—æ­£å¸¸å¯¼å…¥æ—¶ï¼Œdoctestä¸ä¼šè¢«æ‰§è¡Œã€‚åªæœ‰åœ¨å‘½ä»¤è¡Œç›´æ¥è¿è¡Œæ—¶ï¼Œæ‰æ‰§è¡Œdoctestã€‚æ‰€ä»¥ï¼Œä¸å¿…æ‹…å¿ƒdoctestä¼šåœ¨éæµ‹è¯•ç¯å¢ƒä¸‹æ‰§è¡Œã€‚



---



# ğŸ“š References

<br>

- [å»–é›ªå³° - Python3.x æ•™ç¨‹](https://www.liaoxuefeng.com/wiki/1016959663602400/1016966022717728)