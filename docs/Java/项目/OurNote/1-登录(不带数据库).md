# ğŸ›’ ç™»å½•åŠŸèƒ½å¼€å‘ â€” ä¸å¸¦æ•°æ®åº“



---

## 1. å‰åç«¯é¡¹ç›®åˆå§‹åŒ–

> è™½ç„¶ Vue 3 åˆšå‡ºæ¥äº†ï¼Œæˆ‘è¿˜æ˜¯é€‰æ‹©ä½¿ç”¨ Vue2 ğŸ¶

ä½¿ç”¨ Vue-cli æ­å»º Vue.js å‰ç«¯é¡¹ç›® `cswiki_vue`ï¼Œå‚è€ƒ Vue æ¨¡å—çš„ä¸¤ç¯‡ç¬”è®°ï¼š

- [Vue / 2-å®‰è£…](https://veal98.gitee.io/cs-wiki/#/å‰ç«¯/Vue/2-å®‰è£…)

- [Vue / 3-ç›®å½•ç»“æ„](https://veal98.gitee.io/cs-wiki/#/å‰ç«¯/Vue/3-ç›®å½•ç»“æ„)

ä½¿ç”¨ Vs-Code æ‰“å¼€ï¼Œå¹¶åœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼š`npm run serve` å¯åŠ¨ Vue æœåŠ¡ï¼ˆå¯é€šè¿‡ **Ctrl + C** åœæ­¢ï¼‰

<img src="https://gitee.com/veal98/images/raw/master/img/20200725210057.png" style="zoom:80%;" />

åç«¯ SpringBoot é¡¹ç›® `cswiki_springboot`ï¼Œå…ˆåªå¼•å…¥ web æ¨¡å—å°±å¥½

## 2. ç»Ÿä¸€åç«¯æ¥å£çš„è¿”å›æ ¼å¼

**å‰åç«¯åˆ†ç¦»çš„æ„æ€æ˜¯å‰åç«¯ä¹‹é—´é€šè¿‡ RESTful API ä¼ é€’ JSON æ•°æ®è¿›è¡Œäº¤æµã€‚ä¸åŒäº JSP ä¹‹ç±»ï¼Œåç«¯æ˜¯ä¸æ¶‰åŠé¡µé¢æœ¬èº«çš„å†…å®¹çš„ã€‚**

æ­¤å¤„æˆ‘ä»¬å…ˆå®šä¹‰å¥½å‰åç«¯äº¤äº’çš„ JSON æ•°æ®æ ¼å¼ï¼Œå³ç»Ÿä¸€åç«¯æ¥å£æ–¹æ³•çš„è¿”å›æ ¼å¼ï¼š

<img src="https://gitee.com/veal98/images/raw/master/img/20200923211348.png" style="zoom:67%;" />

- `Result`ï¼š

  ```java
  package com.smallbeef.cswiki.Json;
  
  /**
   * ç»Ÿä¸€åç«¯æ¥å£æ–¹æ³•çš„è¿”å›æ ¼å¼
   */
  public class Result {
  
      private int code; // çŠ¶æ€ç 
      private String message; // å¯¹äºè¯¥çŠ¶æ€ç çš„è§£é‡Šä¿¡æ¯
      private Object data; // åç«¯ä¼ é€’ç»™å‰ç«¯çš„æ•°æ®å¯¹è±¡
  
      // (æ— å‚)æ„é€ å‡½æ•° + Getter and Setter
  }
  
  ```

- `ResultCode`ï¼š

  ```java
  /**
   * çŠ¶æ€ç ï¼Œå¯¹åº” Result.code
   */
  public enum ResultCode {
  
      SUCCESS(200),
      FAIL(400);
  
      public int code;
  
      ResultCode(int code) {
          this.code = code;
      }
  }
  ```

- `ResultFactory`ï¼š

  ```java
  /**
   * ç»Ÿä¸€æ„å»ºè¿”å›å€¼ Result
   */
  public class ResultFactory {
  
      public static Result buildResult(int resultCode, String message, Object data){
          return new Result(resultCode, message, data);
      }
  
      public static Result buildResult(ResultCode resultCode, String message, Object data) {
          return buildResult(resultCode.code, message, data);
      }
  
      public static Result buildSuccessResult(Object data) {
          return buildResult(ResultCode.SUCCESS, "Success!", data);
      }
  
      public static Result buildFailResult(String message) {
          return buildResult(ResultCode.FAIL, message, null);
      }
  
  }
  ```


## 3. ç™»å½•åŠŸèƒ½å¼€å‘ï¼ˆä¸å¸¦æ•°æ®åº“ï¼‰

ğŸ”ˆ **æˆ‘ä»¬ä»¥ç™»å½•åŠŸèƒ½ä¸ºä¾‹ï¼Œå…ˆè·‘é€šå‰åç«¯çš„æ•°æ®äº¤äº’ï¼Œä¹‹åå†å¼•å…¥æ•°æ®åº“å’Œç”¨æˆ·æ³¨å†ŒåŠŸèƒ½çš„å¼€å‘ã€‚**

### â‘   åç«¯

#### å®ä½“ç±» UserInfo

```java
/**
 * ç”¨æˆ·ç±»
 */
public class UserInfo {

    // æ³¨æ„å‰ç«¯ä¼ å€¼çš„å­—æ®µè¦å’Œæ­¤å¤„ä¸€è‡´
    private int id;
    private String username;
    private String password;
    private String email;
	
    // (æ— å‚)æ„é€ å‡½æ•° + Getter And Setter
    
}

```



#### LoginController

æˆ‘ä»¬**æš‚æ—¶ä¸å¼•å…¥æ•°æ®åº“ï¼Œå…ˆæŠŠå‰åç«¯äº¤äº’è·‘é€š**å†è¯´ï¼Œæ­¤å¤„å°±åœ¨ `Controller `éšä¾¿å†™ä¸€ä¸ªç”¨æˆ·åå’Œå¯†ç ç”¨æ¥æµ‹è¯•ï¼Œåˆ†åˆ«ä¸æ¥æ”¶åˆ°çš„ `UserInfo ` ç±»çš„ `username ` å’Œ  `password ` è¿›è¡Œæ¯”è¾ƒï¼Œæ ¹æ®ç»“æœè¿”å›ä¸åŒçš„ `Result`ã€‚

```java
@RestController
public class LoginController {

    @CrossOrigin
    @PostMapping(value = "api/login")
    public Result login(@RequestBody UserInfo requestUser) {
        String username = requestUser.getUsername();
        String password = requestUser.getPassword();
        System.out.println("username: " + username);
        System.out.println("password: " + password);

        if (!Objects.equals("admin", username) || !Objects.equals("123456", password)) {
            String message = "è´¦å·å¯†ç é”™è¯¯";
            System.out.println(message);
            return ResultFactory.buildFailResult(message);
        } else {
            System.out.println("Successful");
            return ResultFactory.buildSuccessResult(requestUser); // ä¼ å›è¯¥ç”¨æˆ·å¯¹è±¡ç»™å‰ç«¯
        }
    }
}
```

å‰ç«¯ Vue é€šè¿‡ axios å‘é€è¿‡æ¥çš„æ•°æ®é‡‡ç”¨çš„æ˜¯ JSON æ ¼å¼ï¼Œåç«¯å¯ä»¥ä½¿ç”¨ `@RequestBody ` è¿›è¡Œæ¥æ”¶ã€‚

å…³äºå‰åç«¯æ•°æ®äº¤äº’çš„æ³¨è§£å…„å¼Ÿä»¬å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç«  ğŸ‘‰ [CS-Wiki â€” Spring Boot å‰åç«¯æ•°æ®äº¤äº’çš„å‡ ç§æ–¹å¼](https://veal98.gitee.io/cs-wiki/#/Java/SpringBoot/6-SpringBootå‰åç«¯æ•°æ®äº¤äº’?id=â‘¡-body-å‚æ•°)

#### ç«¯å£å·é…ç½®

äººå°½çš†çŸ¥ Vue å’Œ SpringBoot éƒ½æ˜¯ç”¨ 8080ç«¯å£ç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œé¿å…ä¸¤ä¸ªé¡¹ç›®ç›¸äº’å¹²æ‰°ï¼Œæˆ‘ä»¬ä¿®æ”¹ SpringBoot é¡¹ç›®çš„ç«¯å£å·ä¸º 8081ï¼š

<img src="https://gitee.com/veal98/images/raw/master/img/20200924214439.png" style="zoom:80%;" />

### â‘¡ å‰ç«¯

#### å®‰è£… axios

Vue æ¨è é‡‡ç”¨ axios å®Œæˆ AJAX è¯·æ±‚ï¼Œæ­¤å¤„æˆ‘ä»¬å…ˆå®‰è£… axiosï¼š

![](https://gitee.com/veal98/images/raw/master/img/20200923212147.png)

#### è®¾ç½®åå‘ä»£ç†

åœ¨å¼€å‘çš„æ—¶å€™ï¼Œå‰ç«¯ç”¨å‰ç«¯çš„æœåŠ¡å™¨ï¼ˆNginxï¼‰ï¼Œåç«¯ç”¨åç«¯çš„æœåŠ¡å™¨ï¼ˆTomcatï¼‰ï¼Œå½“å¼€å‘å‰ç«¯å†…å®¹çš„æ—¶å€™ï¼Œå¯ä»¥<u>æŠŠå‰ç«¯çš„è¯·æ±‚é€šè¿‡å‰ç«¯æœåŠ¡å™¨è½¬å‘ç»™åç«¯ï¼ˆç§°ä¸º**åå‘ä»£ç†**ï¼‰</u>ï¼Œè¿™æ ·å°±èƒ½å®æ—¶è§‚å¯Ÿç»“æœï¼Œå¹¶ä¸”ä¸éœ€è¦çŸ¥é“åç«¯æ€ä¹ˆå®ç°ï¼Œè€Œåªéœ€è¦çŸ¥é“æ¥å£æä¾›çš„åŠŸèƒ½ï¼Œä¸¤è¾¹çš„å¼€å‘äººå‘˜å°±å¯ä»¥å„å¸å…¶èŒã€‚

ä¿®æ”¹ `src\main.js` ä»£ç å¦‚ä¸‹ï¼š

```js
import Vue from 'vue'
import App from './App.vue'
import router from './router'
import store from './store'

Vue.config.productionTip = false

// è®¾ç½®åå‘ä»£ç†ï¼Œå‰ç«¯è¯·æ±‚é»˜è®¤å‘é€åˆ° http://localhost:8081/api (åç«¯)
var axios = require('axios')
axios.defaults.baseURL = 'http://localhost:8081/api'

// å…¨å±€æ³¨å†Œï¼Œä¹‹åå¯åœ¨å…¶ä»–ç»„ä»¶ä¸­é€šè¿‡ this.$axios å‘é€æ•°æ®
Vue.prototype.$axios = axios

new Vue({
  router,
  store,
  render: h => h(App)
}).$mount('#app')

```

#### è·¨åŸŸæ”¯æŒ

å‰åç«¯åˆ†ç¦»å¼€å‘æ—¶ï¼Œä¸å¾—ä¸é¢å¯¹è·¨åŸŸé—®é¢˜ã€‚å¯¹äºè·¨åŸŸï¼Œå¯ä»¥ç”¨ä¸¤ç§åŠæ³•è¿›è¡Œå¤„ç†ã€‚

- å®‰è£… nginxï¼Œå°†åç«¯å’Œå‰ç«¯éƒ½ä»£ç†å¸¦ nginx ä¸Šã€‚

- åœ¨ vue-cli ä¸­é…ç½® proxyï¼Œå°† API è¯·æ±‚ä»£ç†åˆ° API æœåŠ¡å™¨ä¸Šï¼ˆç›®å‰å…ˆé‡‡ç”¨è¿™ç§æ–¹å¼ï¼‰ã€‚

ä½¿ç”¨ Vue-CLI 3+ åˆ›å»ºçš„é¡¹ç›®ä¸­æ²¡æœ‰ `config `æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `package.json` æ–‡ä»¶çš„åŒçº§ç›®å½•ä¸‹åˆ›å»º `vue.config.js` æ–‡ä»¶ã€‚

```js
// é…ç½®è·¨åŸŸæ”¯æŒ
module.exports = {
    outputDir: "dist", //buildè¾“å‡ºç›®å½•
    assetsDir: "assets", //é™æ€èµ„æºç›®å½•ï¼ˆjs, css, imgï¼‰
    lintOnSave: true, //æ˜¯å¦å¼€å¯eslint
    devServer: {
      open: true, //æ˜¯å¦è‡ªåŠ¨å¼¹å‡ºæµè§ˆå™¨é¡µé¢
      host: "localhost",
      port: "8080", // Vue è¿è¡Œç«¯å£
      https: false, //æ˜¯å¦ä½¿ç”¨httpsåè®®
      hotOnly: true, //æ˜¯å¦å¼€å¯çƒ­æ›´æ–°
      proxy: { // è·¨åŸŸæ”¯æŒ
        "/api": {
          target: "http://localhost:8081", //APIæœåŠ¡å™¨çš„åœ°å€(åç«¯ï¼‰
          changeOrigin: true, // è™šæ‹Ÿçš„ç«™ç‚¹éœ€è¦æ›´ç®¡ origin
          pathRewrite: {
            //é‡å†™è·¯å¾„ æ¯”å¦‚ '/api/aaa/ccc'å¯¹åº”åç«¯æ¥å£ '/aaa/ccc'
            "^/api": "",
          },
        },
      },
    },
  };
```

æ‰€ä»¥è‹¥æ˜¯åç«¯çš„APIä¸º `'/aaa/ccc'`ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å‰ç«¯å‘è¯·æ±‚æ—¶å°†è·¯å¾„è®¾ç½®ä¸º `'/api/aaa/ccc'`, è¿™æ ·æˆ‘ä»¬çš„è¯·æ±‚æ‰ä¼šè¢« proxy ä»£ç†åˆ°ã€‚

#### å®‰è£… Element 

Element æ˜¯ä¸€å¥—åŸºäº Vue 2.0 çš„æ¡Œé¢ç«¯ç»„ä»¶åº“ï¼Œç”¨äºå¿«é€Ÿå¼€å‘ã€‚

åœ¨ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤å®‰è£… Elementï¼š

```powershell
npm i element-ui -S
```

![](https://gitee.com/veal98/images/raw/master/img/20200727120827.png)

æ¥ä¸‹æ¥åœ¨é¡¹ç›®ä¸­å¼•å…¥ Element

åœ¨ main.js ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š

```js
import ElementUI from 'element-ui';
import 'element-ui/lib/theme-chalk/index.css';

Vue.use(ElementUI);
```

<img src="https://gitee.com/veal98/images/raw/master/img/20200727121110.png" style="zoom:67%;" />

OKï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å¯¹ç…§ Element å®˜æ–¹æ–‡æ¡£å¿«é€Ÿå¼€å‘ Vue ç•Œé¢äº†

#### Login.vue

å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š[ElementUI â€” Form è¡¨å•](https://element.eleme.cn/#/zh-CN/component/form)

<img src="https://gitee.com/veal98/images/raw/master/img/20200924215156.png" style="zoom: 60%;" />

ç›´æ¥æ ¹æ®å®˜ç½‘çš„ä¾‹å­æ¥æ”¹å°±è¡Œäº†ï¼Œä¸‹é¢ç»™å‡ºæˆ‘çš„ä»£ç  ğŸ‘‡ 

```vue
<template>
    <body class = "login_bg">
        <div class = "login_container">
            <el-form ref="LoginForm" :model="LoginForm" label-width="80px">
                 <h2 class = "login_title">ç™»å½•</h2>
                 <el-form-item label="ç”¨æˆ·å">
                    <el-input v-model="LoginForm.username"></el-input>
                 </el-form-item>
                 <el-form-item label="å¯†ç ">
                    <el-input v-model="LoginForm.password"></el-input>
                 </el-form-item>
                 <el-form-item>
                    <el-button type="primary" @click = "login">ç™»å½•</el-button>
                    <el-button @click = "goToRegist">æ³¨å†Œ</el-button>
                 </el-form-item>
            </el-form>
        </div>
    </body>    
</template>

<script>
export default {
    name: 'Login',
    data() { 
        return {
            LoginForm: {
                username: '',
                password: ''
            }
        }
    },
    methods: {
        // ç™»å½•
        login(){
            this.$axios.post('/login', {
                username: this.LoginForm.username,
                password: this.LoginForm.password
            }).then(successResponse => {
                // åç«¯å‘é€è¿‡æ¥çš„æ˜¯ Result ç±»å‹æ•°æ®ï¼Œåˆ¤æ–­ Result.code å³å¯
                if(successResponse.data.code === 200){
                    // è®°ä½è¿›å…¥ç™»å½•ç•Œé¢ä¹‹å‰çš„é¡µé¢è·¯å¾„
                    var path = this.$route.query.redirect
                    // è¿”å›ä¹‹å‰çš„é¡µé¢ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è·³è½¬è‡³ /index
                    this.$router.replace({path: path === '/' || path == undefined ? '/index' : path})
                } else {
                    this.$alert('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯', 'æç¤º', {
                        confirmButtonText: 'ç¡®å®š'
                    })

                }
            }).catch(failResponse => {

            })
        },
        // è¿›å…¥ regist ç•Œé¢
        goToRegist(){

        }
    }
}
</script>

<style scoped>
    .login_container {
        border-radius: 20px;
        background-clip: padding-box;
        margin: 150px auto;
        width: 400px;
        padding: 35px 65px 15px 0px;
        background: #fff;
        border: 1px solid #cfc9c9;
    }
    .login_title {
        margin: 0px 0px 40px 75px;
        text-align: center;
        color: #505458;
        font-size: 32px;
    }
</style>
```

#### è·¯ç”±é…ç½®

ä¿®æ”¹ `src\router\index.js` , é…ç½®é¡µé¢è·¯ç”±ï¼š

```js
import Login from '../components/Login'
import Index from '../components/Index'


const routes = [
  {
    path: '/login',
    name: 'Login',
    component: Login
  },
  {
    path: '/index',
    name: 'Index',
    component: Index
  },
  
]
```

Index ç»„ä»¶æš‚æ—¶å°±éšä¾¿å†™å†™ï¼Œä¹‹åå†è¯¦ç»†å¼€å‘

#### è¿è¡Œæµ‹è¯•

OKï¼Œå‰åç«¯åŸºæœ¬è·‘é€šäº†ï¼Œå¯ä»¥è¿è¡Œæµ‹è¯•ä¸‹ç‚¹å‡»ç™»å½•èƒ½å¦è·³è½¬åˆ° index ç•Œé¢

