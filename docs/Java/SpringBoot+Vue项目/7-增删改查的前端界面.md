# å¢åˆ æ”¹æŸ¥çš„å‰ç«¯ç•Œé¢

---

> ğŸ”Š æœ¬ç¯‡ä¸»è¦å®ç°å›¾ä¹¦çš„å¢åˆ æ”¹æŸ¥åœ¨å‰ç«¯å¦‚ä½•å®ç°ã€‚åŸºæœ¬çš„é€»è¾‘å°±æ˜¯å‘é€è¯·æ±‚è°ƒç”¨åç«¯ç¼–å†™å¥½çš„æ¥å£ï¼Œå†æ ¹æ®è¿”å›çš„ç»“æœåŠ¨æ€æ¸²æŸ“é¡µé¢ã€‚

## 1. æŸ¥è¯¢

é¡¹ç›®ä¸­éœ€è¦åº”ç”¨æŸ¥è¯¢çš„åœ°æ–¹æœ‰ä»¥ä¸‹ä¸‰å¤„ï¼š

- æ‰“å¼€é¡µé¢ï¼Œé»˜è®¤æŸ¥è¯¢å‡ºæ‰€æœ‰å›¾ä¹¦å¹¶æ˜¾ç¤ºï¼ˆå³é¡µé¢çš„åˆå§‹åŒ–ï¼‰
- ç‚¹å‡»å·¦ä¾§åˆ†ç±»æ ï¼ŒæŒ‰ç…§åˆ†ç±»æ˜¾ç¤ºå›¾ä¹¦
- åœ¨æœç´¢æ ä¸­è¾“å…¥ä½œè€…æˆ–ä¹¦åï¼Œå¯ä»¥æ¨¡ç³ŠæŸ¥è¯¢å‡ºç›¸å…³ä¹¦ç±

### â‘  é¡µé¢åˆå§‹åŒ–

ğŸ¨ å®ç°æ•ˆæœå¦‚ä¸‹ï¼š

![](https://gitee.com/veal98/images/raw/master/img/20200731210601.png)

æ‰“å¼€é¡µé¢æ˜¾ç¤ºæ‰€æœ‰å›¾ä¹¦ï¼Œå³åœ¨æ‰“å¼€é¡µé¢æ—¶å°±è‡ªåŠ¨è§¦å‘ç›¸åº”ä»£ç å‘é€è¯·æ±‚å¹¶æ¸²æŸ“é¡µé¢ã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬ç”¨åˆ°äº† Vue çš„ **é’©å­å‡½æ•°** â€” `mounted`ã€‚

é’©å­å‡½æ•°ï¼Œå°±æ˜¯åœ¨æŸä¸ªç‰¹å®šæ¡ä»¶ä¸‹è¢«è§¦å‘çš„å‡½æ•°ã€‚é’©å­å‡½æ•°ç”±äºä¸€èˆ¬ä¸ç”Ÿå‘½å‘¨æœŸå¯¹åº”ï¼Œæ‰€ä»¥ä¹Ÿæœ‰ **â€œç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°â€** è¿™ç§å«æ³•ï¼Œæœ‰çš„åœ°æ–¹ç®€ç§° **â€œç”Ÿå‘½å‘¨æœŸå‡½æ•°â€**

`mounted `å³ **â€œå·²æŒ‚è½½â€** ï¼Œæ‰€è°“æŒ‚è½½ï¼Œå°±æ˜¯æˆ‘ä»¬å†™çš„ Vue ä»£ç è¢«è½¬æ¢ä¸º HTML å¹¶æ›¿æ¢ç›¸åº”çš„ DOM è¿™ä¸ªè¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ç»“æŸåå°±ä¼šæ‰§è¡Œ `mounted `é‡Œé¢çš„ä»£ç ã€‚

![](https://gitee.com/veal98/images/raw/master/img/20200731150115.png)

åœ¨ `library `æ–‡ä»¶å¤¹ä¸‹æ–°å»º `Books.vue`ï¼Œå³å›¾ä¹¦æ˜¾ç¤ºç•Œé¢ï¼š

```vue
<template>
  <div>
    <!-- å›¾ä¹¦å±•ç¤ºé¡µ -->
    <el-row style="height: 850px;">

      <!-- el-tooltip é¼ æ ‡æ‚¬åœæ—¶çš„å±•ç¤ºçš„ä¿¡æ¯ -->
      <el-tooltip effect="dark" placement="right"
                  v-for="item in books"
                  :key="item.id">
        <!-- el-tooltip æœ‰ä¸€ä¸ª content å±æ€§ï¼Œç”¨æ¥æ˜¾ç¤ºé¼ æ ‡æ‚¬åœæ—¶å±•ç¤ºçš„ä¿¡æ¯ -->
        <!-- slot ç”¨äºæŠŠæ ‡ç­¾ä¸­çš„å†…å®¹æ’å…¥åˆ°çˆ¶ç»„ä»¶æŒ‡å®šçš„åœ°æ–¹-->
        <p slot="content" style="font-size: 14px;margin-bottom: 6px;">{{item.title}}</p>
        <p slot="content" style="font-size: 13px;margin-bottom: 6px">
          <span>{{item.author}}</span> /
          <span>{{item.date}}</span> /
          <span>{{item.press}}</span>
        </p>
        <p slot="content" style="width: 300px" class="abstract">{{item.abs}}</p>

        <el-card style="width: 135px;margin-bottom: 20px;height: 260px;float: left;margin-right: 15px" class="book"
                 bodyStyle="padding:10px" shadow="hover">
          
          <div class="cover">
            <img :src="item.cover" alt="å°é¢">
          </div>
          <div class="info">
            <div class="title">
              <a href="">{{item.title}}</a>
            </div>
          </div>

          <div class="author">{{item.author}}</div>
          
        </el-card>
        
      </el-tooltip>

    </el-row>

  </div>
</template>

<script>

  export default {
    name: 'Books',
    data () {
      return {
        books: [],
      }
    },
    mounted: function () {
      this.loadBooks()
    },
    methods: {
      loadBooks () {
        var _this = this
        this.$axios.get('/books').then(resp => {
          if (resp && resp.status === 200) {
            _this.books = resp.data
          }
        })
      },
    
    }
  }
</script>

<style scoped>
	......
</style>
```

åˆ©ç”¨ axios å‘é€äº†ä¸€ä¸ª get è¯·æ±‚ï¼Œåœ¨æ¥å—åˆ°åç«¯è¿”å›çš„æˆåŠŸä»£ç åæŠŠ `data` é‡Œçš„æ•°æ®æ›¿æ¢ä¸ºåç«¯è¿”å›çš„æ•°æ®ã€‚åˆ©ç”¨ `data` å’Œ `template` é‡Œç›¸åº”å…ƒç´ çš„åŒå‘ç»‘å®šï¼Œå®ç°é¡µé¢çš„åŠ¨æ€æ¸²æŸ“ã€‚

### â‘¡ åˆ†ç±»æ˜¾ç¤º

ğŸ¨ å®ç°æ•ˆæœå¦‚ä¸‹ï¼š

![](https://gitee.com/veal98/images/raw/master/img/20200731210637.png)

åˆ†ç±»è¿™ä¸ªåŠŸèƒ½çš„å‰ç«¯å®ç°é€»è¾‘æ˜¯ï¼Œç‚¹å‡»å·¦ä¾§å¯¼èˆªæ ï¼Œå‘åç«¯å‘é€ä¸€ä¸ªå¸¦æœ‰å‚æ•°çš„ get è¯·æ±‚ï¼Œç„¶ååŒæ ·æ˜¯ä¿®æ”¹ `data` é‡Œçš„æ•°æ®ä»¥å®ç°åŠ¨æ€æ¸²æŸ“ã€‚

åœ¨ `LibraryIndex.vue` ä¸­æˆ‘ä»¬å·²ç»æ·»åŠ äº† `SideBar `ç»„ä»¶ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬ä¸º `SideBar `å­ç»„ä»¶æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼š

```vue
<template>
    <el-row class="tac">
        <el-col :span="12">
            <el-menu
            default-active="0"
            class="categories"
            @select="handleSelect">
            <el-menu-item index="0">
                <i class="el-icon-menu"></i>
                <span slot="title">å…¨éƒ¨</span>
            </el-menu-item>
                
            ......
                
            </el-menu>
        </el-col>
    </el-row>
</template>

<script>
  export default {
    name: 'SideBar',
    data () {
      return {
        cid: ''
      }
    },
    methods: {
      handleSelect (key) {
        // æŠŠ keyï¼Œå³ <el-menu-item> æ ‡ç­¾çš„ index å±æ€§çš„å€¼èµ‹ç»™ data ä¸­å®šä¹‰çš„å±æ€§ cid
        this.cid = key 
        this.$emit('indexSelect')
      }
    }
  }
</script>
```

`emit`ï¼Œå³è§¦å‘ï¼Œåœ¨å­ç»„ä»¶ä¸­ä½¿ç”¨ `$emit` æ–¹æ³•ï¼Œå³å¯è§¦å‘åœ¨çˆ¶ç»„ä»¶ä¸­å®šä¹‰çš„äº‹ä»¶ `indexSelect`ã€‚è€Œè¿™ä¸ª `handleSelect` æ–¹æ³•ï¼Œåˆ™ç”± `@select` äº‹ä»¶è§¦å‘ã€‚

åœ¨çˆ¶ç»„ä»¶ `LibraryIndex.vue` ä¸­ï¼Œæˆ‘ä»¬ä¸ºå…¶ç»‘å®š `indexSelect` äº‹ä»¶ï¼Œå®ç°çˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ï¼š

```vue
<template>
  <el-container>
    <!-- ä¾§è¾¹æ  -->
    <el-aside class = "side-bar">
      <!-- å®ç°æŒ‰åˆ†ç±»æŸ¥è¯¢ -->
      <SideBar @indexSelect="listByCategory" ref="sideBar"></SideBar>
    </el-aside>
      
	<!-- ä¸»åŒºåŸŸ -->
    <el-main class="books-area" >
        <Books ref="booksArea"></Books>
    </el-main>
      
  </el-container>
</template>

<script>
  import SideBar from  './SideBar'
  import Books from  './Books'
  export default {
    name: 'Library',
    components: {SideBar,Books},
    methods: {
      listByCategory () {
        var _this = this
        var cid = this.$refs.sideBar.cid
        var url = 'categories/' + cid + '/books'
        this.$axios.get(url).then(resp => {
          if (resp && resp.status === 200) {
            // æŸ¥è¯¢æˆåŠŸåèµ‹å€¼ç»™Books ç»„ä»¶ è¿›è¡Œæ˜¾ç¤º
            _this.$refs.booksArea.currentPage = 1 //è®¾ç½®å½“å‰é¡µä¸º 1
            _this.$refs.booksArea.books = resp.data
          }
        })
      }
    }
  }
</script>
```

ğŸš© æ³¨æ„ï¼Œåœ¨å­ç»„ä»¶ `SideBar `çš„æ ‡ç­¾ä¸­ï¼Œæˆ‘ä»¬ç”¨ `ref` å±æ€§ä¸ºå…¶è®¾ç½®äº†ä¸€ä¸ªå¼•ç”¨å `sideBar`ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ `_this.$refs.sideBar`  æ¥å¼•ç”¨å­ç»„ä»¶ `SideBar` çš„å®ä¾‹ï¼Œå¹¶è·å–å®ƒçš„ `data` ã€‚

â­ æ€»ç»“ä¸€ä¸‹ï¼Œå½“ä½ ç‚¹å‡»é€‰æ‹©ä¾§è¾¹å¯¼èˆªæ çš„ä¸€ä¸ªæ ‡ç­¾åï¼Œå‘ç”Ÿäº†å¦‚ä¸‹çš„æ“ä½œï¼š

- è§¦å‘ `SideBar` å­ç»„ä»¶çš„ `@select` äº‹ä»¶ï¼Œæ‰§è¡Œ `handleSelect` æ–¹æ³•
- `handleSelect` æ–¹æ³•è§¦å‘çˆ¶ç»„ä»¶çš„ `indexSelect` äº‹ä»¶ï¼Œå¹¶æŠŠ keyï¼Œå³ `<el-menu-item>` æ ‡ç­¾çš„ `index` å±æ€§çš„å€¼èµ‹ç»™ `data` ä¸­å®šä¹‰çš„å±æ€§ `cid`
- çˆ¶ç»„ä»¶æ”¶åˆ°æŒ‡ä»¤ï¼Œæ‰§è¡Œ `indexSelect`  äº‹ä»¶å¯¹åº”çš„æ–¹æ³• `listByCategory` 
- å‘é€è¯·æ±‚ï¼Œåç«¯æ‰§è¡ŒæŸ¥è¯¢ä»£ç ï¼Œè¿”å›æ•°æ®ï¼Œå†é€šè¿‡ `refs` ä¿®æ”¹ `Books`ç»„ä»¶çš„ `data` ä»¥åŠ¨æ€æ¸²æŸ“é¡µé¢ã€‚

### â‘¢ æœç´¢ 

ğŸ¨ å®ç°æ•ˆæœå¦‚ä¸‹ï¼š

![](https://gitee.com/veal98/images/raw/master/img/20200731210706.png)

ä¹‹å‰åç«¯æ²¡æœ‰å®ç°æŒ‰å…³é”®å­—æŸ¥è¯¢çš„æ¥å£ï¼Œç°åœ¨æˆ‘ä»¬è¡¥ä¸Šã€‚é¦–å…ˆåœ¨ `BookService.java` ä¸­æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼š

```java
public List<Book> Search(String keywords) {
	return bookDAO.findAllByTitleLikeOrAuthorLike('%' + keywords + '%', 
                                                  '%' + keywords + '%');
}
```

è¿™ä¸ª `findAllByTitleLikeOrAuthorLike`ï¼Œå°±æ˜¯â€œæ ¹æ®æ ‡é¢˜æˆ–ä½œè€…è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢â€ï¼ŒğŸš¨ **å‚æ•°æ˜¯ä¸¤ä¸ª `String`ï¼Œåˆ†åˆ«å¯¹åº”æ ‡é¢˜æˆ–ä½œè€…ã€‚**ç”¨æˆ·åœ¨æœç´¢æ—¶æ— è®ºè¾“å…¥çš„æ˜¯ä½œè€…è¿˜æ˜¯ä¹¦åï¼Œéƒ½ä¼šå¯¹ä¸¤ä¸ªå­—æ®µè¿›è¡ŒåŒ¹é…ã€‚

å†å‘ `libraryController` é‡Œé¢æ·»åŠ å¦‚ä¸‹æ–¹æ³•ï¼š

```java

@GetMapping("api/search")
public List<Book> searchResult(@RequestParam("keywords") String keywords) {
    // å…³é”®è¯ä¸ºç©ºæ—¶æŸ¥è¯¢å‡ºæ‰€æœ‰ä¹¦ç±
    if ("".equals(keywords)) {
        return bookService.list();
    } else {
        return bookService.Search(keywords);
    }
}
```

> ğŸ’¡ è¿™é‡Œå®ç°çš„åªæ˜¯åˆçº§çš„æ¨¡ç³ŠæŸ¥è¯¢ï¼Œåªèƒ½æœç´¢å‡ºå®Œå…¨åŒ…å«å…³é”®å­—çš„å†…å®¹ï¼Œè€Œä¸”é¡ºåºä¸èƒ½å˜

å›åˆ°å‰ç«¯éƒ¨åˆ†ï¼Œè¿˜æ˜¯çˆ¶å­ç»„ä»¶é€šä¿¡ã€axios è¯·æ±‚çš„é‚£ä¸€å¥—ã€‚

é¦–å…ˆç¼–å†™ä¸€ä¸ª  `SearchBar ` æœç´¢æ¡†ç»„ä»¶ï¼š

```vue
<template>
  <div style="margin-bottom: 30px;display: flex;justify-content: center;align-items: center">
    <el-input
      @keyup.enter.native="searchClick"
      placeholder="é€šè¿‡ä¹¦åæˆ–ä½œè€…æœç´¢..."
      prefix-icon="el-icon-search"
      size="small"
      style="width: 400px;margin-right: 10px"
      v-model="keywords">
    </el-input>
      // ç»‘å®šç›‘å¬äº‹ä»¶ click
    <el-button size="small" type="primary" icon="el-icon-search" @click="searchClick">æœç´¢</el-button>
  </div>
</template>

<script>
  export default {
    name: 'SearchBar',
    data () {
      return {
        keywords: '',
        books: [],
        cardLoading: []
      }
    },
    methods: {
      searchClick () {
        this.$emit('onSearch') // è§¦å‘çˆ¶ç»„ä»¶ Books ä¸­çš„ onSearch äº‹ä»¶
      }
    }
  }
</script>
```

åœ¨ `Books.vue` ä¸­æ·»åŠ è¯¥æœç´¢æ¡†ç»„ä»¶ï¼š

```vue
<!-- æœç´¢æ¡† -->
<SearchBar @onSearch = "searchResult" ref = "searchBar"></SearchBar>

......

<script>
  import SearchBar from './SearchBar'
  export default {
    ......
    components: {SearchBar},
    data () {
      return {
        books: [],
      }
    },
    methods: {
	 ......
      searchResult () {
        var _this = this
        this.$axios
          // this.$refs.searchBar.keywords è·å–å­ç»„ä»¶searchBar çš„ keywordsæ•°æ®
          .get('/search?keywords=' + this.$refs.searchBar.keywords, {
          }).then(resp => {
          if (resp && resp.status === 200) {
            _this.books = resp.data // èµ‹å€¼ç»™ books
          }
        })
      },
      
    }
  }
</script>
```

### â‘£ åˆ†é¡µ

ğŸ¨ å®ç°æ•ˆæœå¦‚ä¸‹ï¼š

![](https://gitee.com/veal98/images/raw/master/img/20200731210852.gif)

åœ¨ `Books.vue` ä¸­æ·»åŠ  åˆ†é¡µæ ï¼š

```vue
<template>
  <div>
    <!-- å›¾ä¹¦å±•ç¤ºé¡µ -->
    <el-row style="height: 850px;">
      <!-- æœç´¢æ¡† -->
      <SearchBar @onSearch = "searchResult" ref = "searchBar"></SearchBar>

      <!-- ç»“åˆåˆ†é¡µæŸ¥è¯¢å›¾ä¹¦ -->
      <el-tooltip effect="dark" placement="right"
                  v-for="item in books.slice((currentPage-1)*pagesize,currentPage*pagesize)"
                  :key="item.id">
        ......
        
      </el-tooltip>

    </el-row>
    
    <!-- ç”¨äºæ¢è¡Œ ğŸ˜Š -->
    <el-row></el-row>

    <!-- åˆ†é¡µæ  -->
    <el-row >
      <el-pagination
        @current-change="handleCurrentChange"
        :current-page="currentPage" // å½“å‰é¡µ
        :page-size="pagesize" // æ¯é¡µä¸ªæ•°
        :total="books.length"> // æ€»å…±å¤šå°‘æ¡ç›®
      </el-pagination>
    </el-row>

  </div>
</template>

<script>
  ......
  
  export default {
    name: 'Books',
    ...... 
    data () {
      return {
        books: [],
        currentPage: 1,
        pagesize: 16
      }
    },

    methods: {

      handleCurrentChange: function (currentPage) {
        this.currentPage = currentPage
        console.log(this.currentPage)
      },
        
	......
        
    }
  }
</script>
```

## 2. ä¿®æ”¹ / æ·»åŠ 

ğŸ¨ å®ç°æ•ˆæœå¦‚ä¸‹ï¼š

æ·»åŠ ï¼š

![](https://gitee.com/veal98/images/raw/master/img/20200731211230.gif)

ä¿®æ”¹ï¼š

![](https://gitee.com/veal98/images/raw/master/img/20200731211301.gif)

**å¢åŠ å’Œä¿®æ”¹å…¶å®ç”¨çš„æ˜¯åŒä¸€ä¸ªè¡¨å•**ï¼Œä¸åŒçš„æ˜¯ä¿®æ”¹éœ€è¦å…ˆæŸ¥è¯¢å‡ºåŸæ¥çš„ä¿¡æ¯ï¼Œç„¶åå¯¹æ•°æ®åº“æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œè€Œå¢åŠ åˆ™æ˜¯ç›´æ¥æ‰§è¡Œæ’å…¥æ“ä½œã€‚ä¸è¿‡ç”±äºæˆ‘ä»¬ä½¿ç”¨äº† JPAï¼Œä¸€ä¸ª `save()` æ–¹æ³•å°±æå®šäº†ã€‚

è¿™ä¸¤ä¸ªåŠŸèƒ½çš„æ ¸å¿ƒç»„ä»¶æ˜¯ `EditForm.vue`ï¼Œå®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€ä¸ªæ˜¯é‚£ä¸ªåŠ å·å›¾æ ‡ï¼Œå³

```vue
<!-- åŠ å·å›¾æ ‡ -->
<!-- ç‚¹å‡»è¯¥å›¾æ ‡ dialogFormVisible å±æ€§å˜æˆ true-->
<i class="el-icon-circle-plus-outline"  @click="dialogFormVisible = true"></i>
```

ä¸€ä¸ªæ˜¯ Element çš„ **dialog ç»„ä»¶** `<el-dialog>`ã€‚æˆ‘ä»¬é€šè¿‡è¯¥ç»„ä»¶çš„ `:visible.sync="dialogFormVisible"` å±æ€§æ§åˆ¶å®ƒçš„æ˜¾ç¤ºï¼Œé»˜è®¤æ˜¯éšè—çš„ï¼Œå½“ç‚¹å‡»åŠ å·æ—¶æ‰ä¼šæ˜¾ç¤ºã€‚

```js
data () {
  return {
     dialogFormVisible: false,
```

`EditForm.vue` çš„éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š

```vue
<template>
  <div>
    <!-- åŠ å·å›¾æ ‡ -->
    <!-- ç‚¹å‡»è¯¥å›¾æ ‡ dialogFormVisible å±æ€§å˜æˆ true-->
    <i class="el-icon-circle-plus-outline"  @click="dialogFormVisible = true"></i>
    <el-dialog
      title="æ·»åŠ /ä¿®æ”¹å›¾ä¹¦"
      :visible.sync="dialogFormVisible"
      @close="clear">
      <el-form v-model="form" style="text-align: left" ref="dataForm">
        <el-form-item label="ä¹¦å" :label-width="formLabelWidth" prop="title">
          <el-input v-model="form.title" autocomplete="off" ></el-input>
        </el-form-item>
          
      	......
          
        <el-form-item label="åˆ†ç±»" :label-width="formLabelWidth" prop="cid">
          <el-select v-model="form.category.id" placeholder="è¯·é€‰æ‹©åˆ†ç±»">
            <el-option label="æ–‡å­¦" value="1"></el-option>
            <el-option label="æµè¡Œ" value="2"></el-option>
            <el-option label="æ–‡åŒ–" value="3"></el-option>
            <el-option label="ç”Ÿæ´»" value="4"></el-option>
            <el-option label="ç»ç®¡" value="5"></el-option>
            <el-option label="ç§‘æŠ€" value="6"></el-option>
          </el-select>
        </el-form-item>
          
        
        <el-form-item prop="id" style="height: 0">
          <el-input type="hidden" v-model="form.id" autocomplete="off"></el-input>
        </el-form-item>
          
      </el-form>
      <div slot="footer" class="dialog-footer">
        <el-button @click="dialogFormVisible = false">å– æ¶ˆ</el-button>
        <el-button type="primary" @click="onSubmit">ç¡® å®š</el-button>
      </div>
    </el-dialog>
  </div>
</template>

<script>
  export default {
    name: 'EditForm',
    data () {
      return {
        dialogFormVisible: false,
        form: {
          id: '',
          title: '',
          author: '',
          date: '',
          press: '',
          cover: '',
          abs: '',
          category: {
            id: '',
            name: ''
          }
        },
        formLabelWidth: '120px'
      }
    },
    methods: {
      clear () {
        this.form = {
          id: '',
          title: '',
          author: '',
          date: '',
          press: '',
          cover: '',
          abs: '',
          category: ''
        }
      },
      onSubmit () {
        this.$axios.post('/books', {
            id: this.form.id,
            cover: this.form.cover,
            title: this.form.title,
            author: this.form.author,
            date: this.form.date,
            press: this.form.press,
            abs: this.form.abs,
            category: this.form.category
          }).then(resp => {
          if (resp && resp.status === 200) {
            this.dialogFormVisible = false
            this.$emit('onSubmit') // è§¦å‘çˆ¶ç»„ä»¶çš„ onSubmit äº‹ä»¶
          }
        })
      }
    }
  }
</script>
```

æˆ‘ä»¬å®ç°äº†ä¸€ä¸ª `clear()` æ–¹æ³•ï¼Œç›®çš„æ˜¯åœ¨å…³é—­è¾“å…¥æ¡†æ—¶æ¸…ç©ºåŸæ¥çš„å†…å®¹ã€‚ä¸ç„¶å¦‚æœå…ˆä¿®æ”¹ä¸€æœ¬ä¹¦ï¼Œåˆç‚¹å‡»æ·»åŠ ï¼Œè¡¨å•é‡Œçš„å†…å®¹ä¼šä»æ—§å­˜åœ¨ã€‚

æ ¸å¿ƒçš„æ–¹æ³•æ˜¯ `onSubmit`ï¼Œæäº¤æ•°æ®åï¼Œè§¦å‘çˆ¶ç»„ä»¶ä¸­ `Books.vue` å®šä¹‰çš„ `onSubmit` äº‹ä»¶ï¼Œè€Œè¿™ä¸ªäº‹ä»¶å¯¹åº”çš„æ–¹æ³•åˆ™æ˜¯ `loadBooks()`ï¼Œå³æŸ¥è¯¢å‡ºæ‰€æœ‰çš„ä¹¦ç±ã€‚

é€šè¿‡ `v-model="form.id"`ï¼Œå¯ä»¥è¾¨åˆ«æ˜¯å¢åŠ è¿˜æ˜¯ä¿®æ”¹ï¼Œå› ä¸ºç”±äºæ•°æ®åº“çš„ `book `çš„ `id `å­—æ®µè®¾ç½®äº†è‡ªå¢é•¿ï¼Œæ·»åŠ ä¹¦ç±çš„æ—¶å€™ `id `å­—æ®µä¸º `null`ï¼Œæ­¤æ—¶è¡¨å•å°±ä¸ä¼šå›æ˜¾æ•°æ®ã€‚è€Œå¦‚æœæ˜¯ä¿®æ”¹ä¹¦ç±ä¿¡æ¯ï¼Œè¡¨å•æ ¹æ® `form.id` è·å–ä¹¦ç±ä¿¡æ¯è¿›è¡Œå›æ˜¾ã€‚

åœ¨ `Books.vue` ä¸­æ·»åŠ å­ç»„ä»¶ `EditForm.vue`ï¼š

```vue
<template>
  <div>
    <!-- å›¾ä¹¦å±•ç¤ºé¡µ -->
    <el-row style="height: 850px;">
    
      <el-tooltip effect="dark" placement="right"
                  v-for="item in books.slice((currentPage-1)*pagesize,currentPage*pagesize)"
                  :key="item.id">
        <el-card>
          <!-- ç‚¹å‡»å°é¢è¿›å…¥ä¿®æ”¹ç•Œé¢ -->
          <div class="cover" @click="editBook(item)">
            <img :src="item.cover" alt="å°é¢">
          </div>
         
          ......
    
        </el-card>
        
      </el-tooltip>

      <!-- æ·»åŠ åŠŸèƒ½-->
      <edit-form @onSubmit="loadBooks()" ref="edit"></edit-form>

    </el-row>
    

  </div>
</template>

<script>
  import EditForm from './EditForm'
  import SearchBar from './SearchBar'
  export default {
    name: 'Books',
    components: {EditForm, SearchBar},
    data () {
      return {
        books: [],
        currentPage: 1,
        pagesize: 16
      }
    },

    methods: {
      loadBooks () {
        var _this = this
        this.$axios.get('/books').then(resp => {
          if (resp && resp.status === 200) {
            _this.books = resp.data
          }
        })
      },
   
      editBook (item) {
        
        this.$refs.edit.dialogFormVisible = true
        this.$refs.edit.form = {
          id: item.id,
          cover: item.cover,
          title: item.title,
          author: item.author,
          date: item.date,
          press: item.press,
          abs: item.abs,
          category: {
            id: item.category.id.toString(),
            name: item.category.name
          }
        }
      }
    }
  }
```

åœ¨ `<edit-form @onSubmit="loadBooks()" ref="edit"></edit-form>` ä¸­æˆ‘ä»¬è®¾ç½®äº†å­ç»„ä»¶ `EditForm` çš„å¼•ç”¨åï¼Œå½“ç„¶ï¼Œåœ¨æ·»åŠ çš„æ—¶å€™æˆ‘ä»¬æ˜¯ç”¨ä¸åˆ°çš„ã€‚åœ¨ä¿®æ”¹ä¹¦ç±çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è·å–å½“å‰å›¾ä¹¦ä¿¡æ¯è¿›è¡Œå›æ˜¾ï¼š

```vue
<!-- ç‚¹å‡»å°é¢è¿›å…¥ä¿®æ”¹ç•Œé¢ -->
<div class="cover" @click="editBook(item)">
	<img :src="item.cover" alt="å°é¢">
</div>

......

 // editBook è¿™ä¸ªæ–¹æ³•å³è´Ÿè´£å¼¹å‡ºä¿®æ”¹è¡¨å•å¹¶æ¸²æŸ“æ•°æ®ï¼š
 editBook (item) { 
   // é€šè¿‡å¼•ç”¨å edit ä¸ºå­ç»„ä»¶ EditForm ä¸­ data çš„å„ä¸ªå±æ€§è¿›è¡Œèµ‹å€¼
    this.$refs.edit.dialogFormVisible = true
    this.$refs.edit.form = {
      id: item.id,
      cover: item.cover,
      title: item.title,
      author: item.author,
      date: item.date,
      press: item.press,
      abs: item.abs,
      category: {
        id: item.category.id.toString(),
        name: item.category.name
      }
    }
 }
```

## 3. åˆ é™¤

![](https://gitee.com/veal98/images/raw/master/img/20200731211418.png)

åœ¨ `Book.vue` ä¸­å…ˆå®‰æ’ä¸€ä¸ªå›¾æ ‡å…ƒç´ çš„ç‚¹å‡»äº‹ä»¶ï¼š

```vue
<i class="el-icon-delete" @click="deleteBook(item.id)"></i>
```

ç„¶åç¼–å†™æ ¸å¿ƒæ–¹æ³•ï¼š

```js
  deleteBook (id) {
    this.$confirm('æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤è¯¥ä¹¦ç±, æ˜¯å¦ç»§ç»­?', 'æç¤º', {
      confirmButtonText: 'ç¡®å®š',
      cancelButtonText: 'å–æ¶ˆ',
      type: 'warning'
    }).then(() => {
        this.$axios
          .post('/delete', {id: this.id}).then(resp => {
          if (resp && resp.status === 200) {
            this.loadBooks()
          }
        })
      }
    ).catch(() => {
      this.$message({
        type: 'info',
        message: 'å·²å–æ¶ˆåˆ é™¤'
      })
    })
  }
```

ğŸš¨ è¿™é‡Œ éœ€è¦æ³¨æ„ `post `è¯·æ±‚çš„æ„é€ æ–¹å¼ï¼Œ`post `ä¸èƒ½åƒ `get `è¯·æ±‚é‚£æ ·ç›´æ¥æŠŠå‚æ•°å†™åœ¨ `url `é‡Œï¼Œè€Œéœ€è¦ä»¥é”®å€¼å¯¹ `{id: this.id}` çš„æ–¹å¼ä¼ é€’ã€‚

## â›µ Next

ä¸‹èŠ‚å°†è®²è§£å›¾ç‰‡çš„ä¸Šä¼ ï¼Œæ¯•ç«Ÿç°åœ¨åªèƒ½æäº¤å›¾ç‰‡çš„ `url`ã€‚

## ğŸ“š References

- [Vue + Spring Boot é¡¹ç›®å®æˆ˜ â€” ç™½å·](https://blog.csdn.net/Neuf_Soleil/article/details/88925013)