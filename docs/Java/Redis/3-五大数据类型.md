# ğŸ“Š äº”å¤§æ•°æ®ç±»å‹

---

Redis æ˜¯ä¸€ä¸ªå¼€æºï¼ˆBSDè®¸å¯ï¼‰çš„ï¼Œå†…å­˜ä¸­çš„æ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿï¼Œå®ƒå¯ä»¥ç”¨ä½œ**æ•°æ®åº“**ã€**ç¼“å­˜**å’Œ**æ¶ˆæ¯ä¸­é—´ä»¶MQ**ã€‚ å®ƒæ”¯æŒå¤šç§ç±»å‹çš„æ•°æ®ç»“æ„ï¼Œå¦‚ å­—ç¬¦ä¸²ï¼ˆstringsï¼‰ï¼Œ æ•£åˆ—ï¼ˆhashesï¼‰ï¼Œ åˆ—è¡¨ï¼ˆlistsï¼‰ï¼Œ é›†åˆï¼ˆsetsï¼‰ï¼Œ æœ‰åºé›†åˆï¼ˆsorted setsï¼‰ ä¸èŒƒå›´æŸ¥è¯¢ï¼Œ bitmapsï¼Œ hyperloglogs å’Œ åœ°ç†ç©ºé—´ï¼ˆgeospatialï¼‰ ç´¢å¼•åŠå¾„æŸ¥è¯¢ã€‚ Redis å†…ç½®äº† å¤åˆ¶ï¼ˆreplicationï¼‰ï¼ŒLUAè„šæœ¬ï¼ˆLua scriptingï¼‰ï¼Œ LRUé©±åŠ¨äº‹ä»¶ï¼ˆLRU evictionï¼‰ï¼Œäº‹åŠ¡ï¼ˆtransactionsï¼‰ å’Œä¸åŒçº§åˆ«çš„ ç£ç›˜æŒä¹…åŒ–ï¼ˆpersistenceï¼‰ï¼Œ å¹¶é€šè¿‡Rediså“¨å…µï¼ˆSentinelï¼‰å’Œè‡ªåŠ¨ åˆ†åŒºï¼ˆClusterï¼‰æä¾›é«˜å¯ç”¨æ€§ï¼ˆhigh availabilityï¼‰ã€‚

## 1. Redis-Key

```powershell
127.0.0.1:6379 > select 1 # é€‰æ‹© 1 å·æ•°æ®åº“

127.0.0.1:6379[1]> keys * # æŸ¥çœ‹æ‰€æœ‰çš„key
(empty list or set)
127.0.0.1:6379[1]> set name smallbeef # set key
OK
127.0.0.1:6379[1]> keys *
1) "name"
127.0.0.1:6379[1]> set age 1
OK
127.0.0.1:6379[1]> keys *
1) "age"
2) "name"

127.0.0.1:6379[1]> EXISTS name # åˆ¤æ–­å½“å‰çš„keyæ˜¯å¦å­˜åœ¨
(integer) 1
127.0.0.1:6379[1]> EXISTS name1
(integer) 0

127.0.0.1:6379[1]> move name 2 # ç§»é™¤å½“å‰çš„key
(integer) 1
127.0.0.1:6379[1]> keys *
1) "age"

127.0.0.1:6379[1]> set name yjc
OK
127.0.0.1:6379[1]> keys *
1) "age"
2) "name"
```

å¯ä»¥é€šè¿‡ clear æ¸…ç©ºå±å¹•ï¼š

```powershell
127.0.0.1:6379> clear
```



```powershell
127.0.0.1:6379> keys *
1) "age"
2) "name"
127.0.0.1:6379> get name
"yjc"
127.0.0.1:6379> EXPIRE name 10 # è®¾ç½®keyçš„è¿‡æœŸæ—¶é—´ï¼Œå•ä½æ˜¯ç§’
(integer) 1
127.0.0.1:6379> ttl name # æŸ¥çœ‹å½“å‰keyçš„å‰©ä½™æ—¶é—´
(integer) 4
127.0.0.1:6379> ttl name
(integer) -2
127.0.0.1:6379> get name
(nil)
127.0.0.1:6379> type name # æŸ¥çœ‹å½“å‰keyçš„ä¸€ä¸ªç±»å‹ï¼
none
127.0.0.1:6379> type age
string
```

##  2.  String å­—ç¬¦ä¸²

> ğŸ˜³ 90% çš„ Java ç¨‹åºå‘˜ä½¿ç”¨ Redis åªä¼šä½¿ç”¨ä¸€ä¸ª String ç±»å‹

âœ **å‘½ä»¤ `set`ã€`get`ã€`APPEND`ã€`STRLEN` ç¤ºä¾‹**ï¼š

```powershell
127.0.0.1:6379> set key1 v1 # è®¾ç½®å€¼
OK
127.0.0.1:6379> get key1 # è·å¾—å€¼
"v1"
127.0.0.1:6379> keys * # è·å¾—æ‰€æœ‰çš„key
1) "key1"
127.0.0.1:6379> EXISTS key1 # åˆ¤æ–­æŸä¸€ä¸ªkeyæ˜¯å¦å­˜åœ¨
(integer) 1
127.0.0.1:6379> APPEND key1 "hello" # è¿½åŠ å­—ç¬¦ä¸²ï¼Œå¦‚æœå½“å‰keyä¸å­˜åœ¨ï¼Œå°±ç›¸å½“äºset key
(integer) 7
127.0.0.1:6379> get key1
"v1hello"
127.0.0.1:6379> STRLEN key1 # è·å–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼
(integer) 7
127.0.0.1:6379> APPEND key1 ",smallbeef"
(integer) 17
127.0.0.1:6379> STRLEN key1
(integer) 17
127.0.0.1:6379> get key1
"v1hello,smallbeef"
```

âœ **å‘½ä»¤ `incr`ã€`decr` ã€`INCRBY`ï¼Œ`DECRBY`ç¤ºä¾‹**ï¼š

```powershell
127.0.0.1:6379> set views 0 # åˆå§‹æµè§ˆé‡ä¸º0
OK
127.0.0.1:6379> get views
"0"
127.0.0.1:6379> incr views # è‡ªå¢1 æµè§ˆé‡å˜ä¸º1
(integer) 1
127.0.0.1:6379> incr views
(integer) 2
127.0.0.1:6379> get views
"2"
127.0.0.1:6379> decr views # è‡ªå‡1 æµè§ˆé‡-1
(integer) 1
127.0.0.1:6379> decr views
(integer) 0
127.0.0.1:6379> decr views
(integer) -1
127.0.0.1:6379> get views
"-1"
127.0.0.1:6379> INCRBY views 10 # å¯ä»¥è®¾ç½®æ­¥é•¿ï¼ŒæŒ‡å®šå¢é‡ï¼
(integer) 9
127.0.0.1:6379> INCRBY views 10
(integer) 19
127.0.0.1:6379> DECRBY views 5
(integer) 14
```

âœ **å‘½ä»¤ `GETRANGE`ã€`SETRANGE`  ç¤ºä¾‹**ï¼š

```powershell
# å­—ç¬¦ä¸²èŒƒå›´ range
127.0.0.1:6379> set key1 "hello,smallbeef" # è®¾ç½® key1 çš„å€¼
OK
127.0.0.1:6379> get key1
"hello,smallbeef"
127.0.0.1:6379> GETRANGE key1 0 3 # æˆªå–å­—ç¬¦ä¸² [0,3]
"hell"
127.0.0.1:6379> GETRANGE key1 0 -1 # è·å–å…¨éƒ¨çš„å­—ç¬¦ä¸²(ä»0å¼€å§‹ï¼Œåˆ°å€’æ•°ç¬¬1ä¸ª) å’Œ get keyæ˜¯ä¸€æ ·çš„
"hello,kuangshen"

# æ›¿æ¢
127.0.0.1:6379> set key2 abcdefg
OK
127.0.0.1:6379> get key2
"abcdefg"
127.0.0.1:6379> SETRANGE key2 1 QR # æ›¿æ¢ä»æŒ‡å®šä½ç½® 1 å¼€å§‹çš„å­—ç¬¦ä¸²ï¼
(integer) 7
127.0.0.1:6379> get key2
"aQRdefg"
```

âœ **å‘½ä»¤ `setex`ã€`setnx`  ç¤ºä¾‹**ï¼š

```powershell
# setex (set with expire) # è®¾ç½®è¿‡æœŸæ—¶é—´
# setnx (set if not exist) # ä¸å­˜åœ¨åœ¨è®¾ç½® ï¼ˆåœ¨åˆ†å¸ƒå¼é”ä¸­ä¼šå¸¸å¸¸ä½¿ç”¨ï¼‰

127.0.0.1:6379> setex key3 30 "hello" # è®¾ç½®key3 çš„å€¼ä¸º hello,30ç§’åè¿‡æœŸ
OK
127.0.0.1:6379> ttl key3
(integer) 26

127.0.0.1:6379> setnx mykey "redis" # å¦‚æœmykey ä¸å­˜åœ¨ï¼Œåˆ›å»ºmykey
(integer) 1

127.0.0.1:6379> keys *
1) "key2"
2) "mykey"
3) "key1"

127.0.0.1:6379> setnx mykey "MongoDB" # å¦‚æœmykeyå­˜åœ¨ï¼Œåˆ›å»ºå¤±è´¥
(integer) 0
127.0.0.1:6379> get mykey
"redis"
```

âœ **å‘½ä»¤ `mset`ã€`mget`ï¼Œ`msetnx` ç¤ºä¾‹**ï¼š

```powershell
# mset
# mget

127.0.0.1:6379> mset k1 v1 k2 v2 k3 v3 # åŒæ—¶è®¾ç½®å¤šä¸ªå€¼
OK
127.0.0.1:6379> keys *
1) "k1"
2) "k2"
3) "k3"

127.0.0.1:6379> mget k1 k2 k3 # åŒæ—¶è·å–å¤šä¸ªå€¼
1) "v1"
2) "v2"
3) "v3"

127.0.0.1:6379> msetnx k1 v1 k4 v4 # msetnx æ˜¯ä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼Œè¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥
(integer) 0
127.0.0.1:6379> get k4
(nil)

# å¯¹è±¡
set user:1 {name:zhangsan,age:3} # è®¾ç½®ä¸€ä¸ªuser:1 å¯¹è±¡ å€¼ä¸º jsonå­—ç¬¦æ¥ä¿å­˜ä¸€ä¸ªå¯¹è±¡ï¼
# è¿™é‡Œçš„keyæ˜¯ä¸€ä¸ªå·§å¦™çš„è®¾è®¡ï¼š user:{id}:{filed} , å¦‚æ­¤è®¾è®¡åœ¨Redisä¸­æ˜¯å®Œå…¨OKäº†ï¼

127.0.0.1:6379> mset user:1:name zhangsan user:1:age 2
OK
127.0.0.1:6379> mget user:1:name user:1:age
1) "zhangsan"
2) "2"
```

âœ **å‘½ä»¤ `getset`  ç¤ºä¾‹**ï¼š

```powershell
# getset å…ˆgetç„¶ååœ¨set

127.0.0.1:6379> getset db redis # å¦‚æœä¸å­˜åœ¨å€¼ï¼Œåˆ™è¿”å› nil
(nil)
127.0.0.1:6379> get db
"redis"

127.0.0.1:6379> getset db mongodb # å¦‚æœå­˜åœ¨å€¼ï¼Œè·å–åŸæ¥çš„å€¼ï¼Œå¹¶è®¾ç½®æ–°çš„å€¼
"redis"
127.0.0.1:6379> get db
"mongodb"

```

## 3. List åˆ—è¡¨

## 4. Set é›†åˆ

## 5. Hash å“ˆå¸Œ

## 6. Zset æœ‰åºé›†åˆ

## ğŸ“š References

- [ã€ç‹‚ç¥è¯´Javaã€‘Redisæœ€æ–°è¶…è¯¦ç»†ç‰ˆæ•™ç¨‹é€šä¿—æ˜“æ‡‚](https://www.bilibili.com/video/BV1S54y1R7SB?from=search&seid=3325634079268895938)

