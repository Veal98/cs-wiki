# ğŸ“¶ Vue.js è·¯ç”±è¯¦è§£

---

Vue.js è·¯ç”±å…è®¸æˆ‘ä»¬é€šè¿‡ä¸åŒçš„ URL è®¿é—®ä¸åŒçš„å†…å®¹ã€‚

é€šè¿‡ Vue.js å¯ä»¥å®ç°å¤šè§†å›¾çš„**å•é¡µWebåº”ç”¨ï¼ˆsingle page web applicationï¼ŒSPAï¼‰**ã€‚

Vue.js è·¯ç”±éœ€è¦è½½å…¥ [vue-router åº“](https://github.com/vuejs/vue-router)

ä¸­æ–‡æ–‡æ¡£åœ°å€ï¼š[vue-routeræ–‡æ¡£](http://router.vuejs.org/zh-cn/)

## 1. Vue-Router å®‰è£…

### â‘  CDN / ä¸‹è½½

ä½¿ç”¨CDNå¼•å…¥

```js
//vue.js
<script src="https://unpkg.com/vue/dist/vue.js"></script>

// vue-router
<script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
```

### â‘¡ NPM

å¦‚æœä½¿ç”¨ vue-cli åˆ›å»ºäº†ä¸€ä¸ªvueå·¥ç¨‹ï¼Œé…ç½®è¿‡ç¨‹ä¼šé€‰æ‹©æ˜¯å¦ç”¨åˆ°è·¯ç”±ï¼Œå¦‚æœé€‰æ‹© yï¼Œåé¢ä¸‹è½½ä¾èµ–ä¼šè‡ªåŠ¨ä¸‹è½½ vue-routerã€‚

å½“ç„¶ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨ä½¿ç”¨npmå®‰è£…è·¯ç”±

`npm install vue-router -g`

å®‰è£…å®Œä¹‹åæˆ‘ä»¬å¯ä»¥æ‰“å¼€é¡¹ç›®ä¸­ `package.json` æ–‡ä»¶ï¼Œåœ¨package.jsonæ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ° vue-router çš„ç‰ˆæœ¬å·ï¼š

![](https://gitee.com/veal98/images/raw/master/img/20200415161625.png)

ğŸš¨ **å¦‚æœåœ¨ä¸€ä¸ªæ¨¡å—åŒ–å·¥ç¨‹ä¸­ä½¿ç”¨å®ƒï¼Œå¿…é¡»è¦é€šè¿‡ `Vue.use()` æ˜ç¡®åœ°å®‰è£…è·¯ç”±åŠŸèƒ½**ï¼Œç”¨vue-cliç”Ÿäº§äº†æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„ï¼Œ**srcæ–‡ä»¶ç›®å½•ä¸‹ä¼šæœ‰ä¸€ä¸ªrouteræ–‡ä»¶å¤¹**ï¼Œæ­¤å¤„å°±æ˜¯ç¼–å†™è·¯ç”±ç»„ä»¶çš„åœ°æ–¹ã€‚åœ¨ `src/router/index.js`ï¼Œè¿™ä¸ªæ–‡ä»¶å°±æ˜¯è·¯ç”±çš„æ ¸å¿ƒæ–‡ä»¶ï¼š

```js
 
import Vue from 'vue'   //å¼•å…¥Vue
import Router from 'vue-router'  //å¼•å…¥vue-router
import Hello from '@/components/Hello'  //å¼•å…¥æ ¹ç›®å½•ä¸‹çš„Hello.vueç»„ä»¶
 
Vue.use(Router)  //Vueå…¨å±€ä½¿ç”¨Router
 
export default new Router({
  routes: [              //é…ç½®è·¯ç”±ï¼Œè¿™é‡Œæ˜¯ä¸ªæ•°ç»„
    {                    //æ¯ä¸€ä¸ªé“¾æ¥éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡
      path: '/',         //é“¾æ¥è·¯å¾„
      name: 'Hello',     //è·¯ç”±åç§°ï¼Œ
      component: Hello   //å¯¹åº”çš„ç»„ä»¶æ¨¡æ¿
    }ï¼Œ
    {
      path:'/hi',
      component:Hi,
      children:[        //å­è·¯ç”±,åµŒå¥—è·¯ç”± 
        {
            path:'/',
            component:Hi
        },
        {
            path:'hi1',
            component:Hi1
        },
        {
            path:'hi2',
            component:Hi2
        },
     ]
  }
]
})
```

å…¶ä»–å®‰è£…æ–¹æ³•å‚è§ ğŸ‘‰ [å®˜æ–¹æ–‡æ¡£](https://router.vuejs.org/zh/installation.html)

## 2. ç®€å•ç¤ºä¾‹

Vue.js + vue-router å¯ä»¥å¾ˆç®€å•çš„å®ç°å•é¡µåº”ç”¨ã€‚

**`<rout-link>`æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œè¯¥ç»„ä»¶ç”¨äºè®¾ç½®ä¸€ä¸ªå¯¼èˆªé“¾æ¥ï¼Œåˆ‡æ¢ä¸åŒ HTML å†…å®¹ã€‚ to å±æ€§ä¸ºç›®æ ‡åœ°å€ï¼Œ å³è¦æ˜¾ç¤ºçš„å†…å®¹ã€‚**

ä»¥ä¸‹å®ä¾‹ä¸­æˆ‘ä»¬å°† vue-router åŠ è¿›æ¥ï¼Œç„¶åé…ç½®ç»„ä»¶å’Œè·¯ç”±æ˜ å°„ï¼Œå†å‘Šè¯‰ vue-router åœ¨å“ªé‡Œæ¸²æŸ“å®ƒä»¬ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š

```html
<body>
<div id="app">
  <h1>Hello App!</h1>
  <p>
    <!-- <router-link> é»˜è®¤ä¼šè¢«æ¸²æŸ“æˆä¸€ä¸ª `<a>` æ ‡ç­¾ -->
    <router-link to="/foo">Go to Foo</router-link>
    <router-link to="/bar">Go to Bar</router-link>
  </p>
  <!-- è·¯ç”±å‡ºå£ -->
  <!-- è·¯ç”±åŒ¹é…åˆ°çš„ç»„ä»¶å°†æ¸²æŸ“åœ¨è¿™é‡Œ -->
  <router-view></router-view>
</div>

<script>
// 1. å®šä¹‰ï¼ˆè·¯ç”±ï¼‰ç»„ä»¶ã€‚
// å¯ä»¥ä»å…¶ä»–æ–‡ä»¶ import è¿›æ¥
const Foo = { template: '<div>foo</div>' }
const Bar = { template: '<div>bar</div>' }

// 2. å®šä¹‰è·¯ç”±
// æ¯ä¸ªè·¯ç”±åº”è¯¥æ˜ å°„ä¸€ä¸ªç»„ä»¶ã€‚ å…¶ä¸­"component" å¯ä»¥æ˜¯
// é€šè¿‡ Vue.extend() åˆ›å»ºçš„ç»„ä»¶æ„é€ å™¨ï¼Œ
// æˆ–è€…ï¼Œåªæ˜¯ä¸€ä¸ªç»„ä»¶é…ç½®å¯¹è±¡ã€‚
// æˆ‘ä»¬æ™šç‚¹å†è®¨è®ºåµŒå¥—è·¯ç”±ã€‚
const myroutes = [
  { path: '/foo', component: Foo },
  { path: '/bar', component: Bar }
]

// 3. åˆ›å»º router å®ä¾‹ï¼Œç„¶åä¼ å·²ç»å®šä¹‰çš„è·¯ç”±é…ç½®
// ä½ è¿˜å¯ä»¥ä¼ åˆ«çš„é…ç½®å‚æ•°, ä¸è¿‡å…ˆè¿™ä¹ˆç®€å•ç€å§ã€‚
const router = new VueRouter({
  routes:myroutes
})

// 4. åˆ›å»ºå’ŒæŒ‚è½½æ ¹å®ä¾‹ã€‚
// è®°å¾—è¦é€šè¿‡ router é…ç½®å‚æ•°æ³¨å…¥è·¯ç”±ï¼Œ
// ä»è€Œè®©æ•´ä¸ªåº”ç”¨éƒ½æœ‰è·¯ç”±åŠŸèƒ½
const app = new Vue({
  router
}).$mount('#app')

// ç°åœ¨ï¼Œåº”ç”¨å·²ç»å¯åŠ¨äº†ï¼
</script>
</body>
```

è¿è¡Œç»“æœï¼š

<img src="https://gitee.com/veal98/images/raw/master/img/GIF 2020-4-13 11-48-02.gif" style="zoom:67%;" />

## 3. åŠ¨æ€è·¯ç”±åŒ¹é…

æˆ‘ä»¬ç»å¸¸éœ€è¦**æŠŠæŸç§æ¨¡å¼åŒ¹é…åˆ°çš„æ‰€æœ‰è·¯ç”±ï¼Œå…¨éƒ½æ˜ å°„åˆ°åŒä¸ªç»„ä»¶**ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª `User` ç»„ä»¶ï¼Œå¯¹äºæ‰€æœ‰ ID å„ä¸ç›¸åŒçš„ç”¨æˆ·ï¼Œéƒ½è¦ä½¿ç”¨è¿™ä¸ªç»„ä»¶æ¥æ¸²æŸ“ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `vue-router` çš„è·¯ç”±è·¯å¾„ä¸­ä½¿ç”¨â€œåŠ¨æ€è·¯å¾„å‚æ•°â€(dynamic segment) æ¥è¾¾åˆ°è¿™ä¸ªæ•ˆæœï¼š

```js
const User = {
  template: '<div>User</div>'
}

const router = new VueRouter({
  routes: [
    // åŠ¨æ€è·¯å¾„å‚æ•° ä»¥å†’å·å¼€å¤´
    { 
        path: '/user/:id', 
        component: User 
    }
  ]
})
```

ç°åœ¨å‘¢ï¼Œåƒ `/user/foo` å’Œ `/user/bar` éƒ½å°†æ˜ å°„åˆ°ç›¸åŒçš„è·¯ç”±ã€‚

ä¸€ä¸ªâ€œè·¯å¾„å‚æ•°â€ä½¿ç”¨å†’å· `:` æ ‡è®°ã€‚å½“åŒ¹é…åˆ°ä¸€ä¸ªè·¯ç”±æ—¶ï¼Œå‚æ•°å€¼ä¼šè¢«è®¾ç½®åˆ° `this.$route.params`ï¼Œå¯ä»¥åœ¨æ¯ä¸ªç»„ä»¶å†…ä½¿ç”¨ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–° `User` çš„æ¨¡æ¿ï¼Œè¾“å‡ºå½“å‰ç”¨æˆ·çš„ IDï¼š

```js
const User = {
  template: '<div>User {{ $route.params.id }}</div>'
}
```



ä½ å¯ä»¥åœ¨ä¸€ä¸ªè·¯ç”±ä¸­è®¾ç½®å¤šæ®µâ€œè·¯å¾„å‚æ•°â€ï¼Œå¯¹åº”çš„å€¼éƒ½ä¼šè®¾ç½®åˆ° `$route.params` ä¸­ã€‚ä¾‹å¦‚ï¼š

| æ¨¡å¼                          | åŒ¹é…è·¯å¾„            | $route.params                          |
| ----------------------------- | ------------------- | -------------------------------------- |
| /user/:username               | /user/evan          | `{ username: 'evan' }`                 |
| /user/:username/post/:post_id | /user/evan/post/123 | `{ username: 'evan', post_id: '123' }` |

é™¤äº† `$route.params` å¤–ï¼Œ`$route` å¯¹è±¡è¿˜æä¾›äº†å…¶å®ƒæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œ`$route.query` (å¦‚æœ URL ä¸­æœ‰æŸ¥è¯¢å‚æ•°)ã€`$route.hash` ç­‰ç­‰ã€‚ä½ å¯ä»¥æŸ¥çœ‹ [API æ–‡æ¡£](https://router.vuejs.org/zh/api/#è·¯ç”±å¯¹è±¡) çš„è¯¦ç»†è¯´æ˜ã€‚

### â‘  å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–

æé†’ä¸€ä¸‹ï¼Œå½“ä½¿ç”¨è·¯ç”±å‚æ•°æ—¶ï¼Œä¾‹å¦‚ä» `/user/foo` å¯¼èˆªåˆ° `/user/bar`ï¼Œ**åŸæ¥çš„ç»„ä»¶å®ä¾‹ä¼šè¢«å¤ç”¨**ã€‚å› ä¸ºä¸¤ä¸ªè·¯ç”±éƒ½æ¸²æŸ“åŒä¸ªç»„ä»¶ï¼Œæ¯”èµ·é”€æ¯å†åˆ›å»ºï¼Œå¤ç”¨åˆ™æ˜¾å¾—æ›´åŠ é«˜æ•ˆã€‚**ä¸è¿‡ï¼Œè¿™ä¹Ÿæ„å‘³ç€ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¸ä¼šå†è¢«è°ƒç”¨**ã€‚

å¤ç”¨ç»„ä»¶æ—¶ï¼Œæƒ³å¯¹è·¯ç”±å‚æ•°çš„å˜åŒ–ä½œå‡ºå“åº”çš„è¯ï¼Œä½ å¯ä»¥ç®€å•åœ° watch (ç›‘æµ‹å˜åŒ–) `$route` å¯¹è±¡ï¼š

```js
const User = {
  template: '...',
  watch: {
    '$route' (to, from) {
      // å¯¹è·¯ç”±å˜åŒ–ä½œå‡ºå“åº”...
    }
  }
}
```

æˆ–è€…ä½¿ç”¨ 2.2 ä¸­å¼•å…¥çš„ `beforeRouteUpdate` [å¯¼èˆªå®ˆå«](https://router.vuejs.org/zh/guide/advanced/navigation-guards.html)ï¼š

```js
const User = {
  template: '...',
  beforeRouteUpdate (to, from, next) {
    // react to route changes...
    // don't forget to call next()
  }
}
```

### â‘¡ æ•è·æ‰€æœ‰è·¯ç”±æˆ– 404 Not found è·¯ç”±

å¸¸è§„å‚æ•°åªä¼šåŒ¹é…è¢« `/` åˆ†éš”çš„ URL ç‰‡æ®µä¸­çš„å­—ç¬¦ã€‚å¦‚æœæƒ³åŒ¹é…**ä»»æ„è·¯å¾„**ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ (`*`)ï¼š

```js
{
  // ä¼šåŒ¹é…æ‰€æœ‰è·¯å¾„
  path: '*'
}
{
  // ä¼šåŒ¹é…ä»¥ `/user-` å¼€å¤´çš„ä»»æ„è·¯å¾„
  path: '/user-*'
}
```

å½“ä½¿ç”¨*é€šé…ç¬¦*è·¯ç”±æ—¶ï¼Œè¯·ç¡®ä¿è·¯ç”±çš„é¡ºåºæ˜¯æ­£ç¡®çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å«æœ‰*é€šé…ç¬¦*çš„è·¯ç”±åº”è¯¥æ”¾åœ¨æœ€åã€‚è·¯ç”± `{ path: '*' }` é€šå¸¸ç”¨äºå®¢æˆ·ç«¯ 404 é”™è¯¯ã€‚å¦‚æœä½ ä½¿ç”¨äº†*History æ¨¡å¼*ï¼Œè¯·ç¡®ä¿[æ­£ç¡®é…ç½®ä½ çš„æœåŠ¡å™¨](https://router.vuejs.org/zh/guide/essentials/history-mode.html)ã€‚

å½“ä½¿ç”¨ä¸€ä¸ª*é€šé…ç¬¦*æ—¶ï¼Œ`$route.params` å†…ä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªåä¸º `pathMatch` å‚æ•°ã€‚å®ƒåŒ…å«äº† URL é€šè¿‡*é€šé…ç¬¦*è¢«åŒ¹é…çš„éƒ¨åˆ†ï¼š

```js
// ç»™å‡ºä¸€ä¸ªè·¯ç”± { path: '/user-*' }
this.$router.push('/user-admin')
this.$route.params.pathMatch // 'admin'
// ç»™å‡ºä¸€ä¸ªè·¯ç”± { path: '*' }
this.$router.push('/non-existing')
this.$route.params.pathMatch // '/non-existing'
```

### â‘¢ é«˜çº§åŒ¹é…æ¨¡å¼

`vue-router` ä½¿ç”¨ [path-to-regexp](https://github.com/pillarjs/path-to-regexp/tree/v1.7.0) ä½œä¸ºè·¯å¾„åŒ¹é…å¼•æ“ï¼Œæ‰€ä»¥æ”¯æŒå¾ˆå¤šé«˜çº§çš„åŒ¹é…æ¨¡å¼ï¼Œä¾‹å¦‚ï¼šå¯é€‰çš„åŠ¨æ€è·¯å¾„å‚æ•°ã€åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªã€ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œç”šè‡³æ˜¯è‡ªå®šä¹‰æ­£åˆ™åŒ¹é…ã€‚

### â‘£ åŒ¹é…ä¼˜å…ˆçº§

æœ‰æ—¶å€™ï¼ŒåŒä¸€ä¸ªè·¯å¾„å¯ä»¥åŒ¹é…å¤šä¸ªè·¯ç”±ï¼Œæ­¤æ—¶ï¼ŒåŒ¹é…çš„ä¼˜å…ˆçº§å°±æŒ‰ç…§è·¯ç”±çš„å®šä¹‰é¡ºåºï¼š**è°å…ˆå®šä¹‰çš„ï¼Œè°çš„ä¼˜å…ˆçº§å°±æœ€é«˜ã€‚**

## 4. åµŒå¥—è·¯ç”±

å®é™…ç”Ÿæ´»ä¸­çš„åº”ç”¨ç•Œé¢ï¼Œé€šå¸¸ç”±å¤šå±‚åµŒå¥—çš„ç»„ä»¶ç»„åˆè€Œæˆã€‚åŒæ ·åœ°ï¼ŒURL ä¸­å„æ®µåŠ¨æ€è·¯å¾„ä¹ŸæŒ‰æŸç§ç»“æ„å¯¹åº”åµŒå¥—çš„å„å±‚ç»„ä»¶ï¼Œä¾‹å¦‚ï¼š

```text
/user/foo/profile                     /user/foo/posts
+------------------+                  +-----------------+
| User             |                  | User            |
| +--------------+ |                  | +-------------+ |
| | Profile      | |  +------------>  | | Posts       | |
| |              | |                  | |             | |
| +--------------+ |                  | +-------------+ |
+------------------+                  +-----------------+
```

å€ŸåŠ© `vue-router`ï¼Œä½¿ç”¨åµŒå¥—è·¯ç”±é…ç½®ï¼Œå°±å¯ä»¥å¾ˆç®€å•åœ°è¡¨è¾¾è¿™ç§å…³ç³»ã€‚

æ¥ç€ä¸ŠèŠ‚åˆ›å»ºçš„ appï¼š

```html
<div id="app">
  <router-view></router-view>
</div>
const User = {
  template: '<div>User {{ $route.params.id }}</div>'
}

const router = new VueRouter({
  routes: [
    { path: '/user/:id', component: User }
  ]
})
```

è¿™é‡Œçš„ `<router-view>` æ˜¯æœ€é¡¶å±‚çš„å‡ºå£ï¼Œæ¸²æŸ“æœ€é«˜çº§è·¯ç”±åŒ¹é…åˆ°çš„ç»„ä»¶ã€‚åŒæ ·åœ°ï¼Œä¸€ä¸ªè¢«æ¸²æŸ“ç»„ä»¶åŒæ ·å¯ä»¥åŒ…å«è‡ªå·±çš„åµŒå¥— `<router-view>`ã€‚ä¾‹å¦‚ï¼Œåœ¨ `User` ç»„ä»¶çš„æ¨¡æ¿æ·»åŠ ä¸€ä¸ª  `<router-view>`ï¼š

```js
const User = {
  template: `
    <div class="user">
      <h2>User {{ $route.params.id }}</h2>
      <router-view></router-view>
    </div>
  `
}
```

è¦åœ¨åµŒå¥—çš„å‡ºå£ä¸­æ¸²æŸ“ç»„ä»¶ï¼Œéœ€è¦åœ¨ `VueRouter` çš„å‚æ•°ä¸­ä½¿ç”¨ `children` é…ç½®ï¼š

```js
const router = new VueRouter({
  routes: [
    { 
        path: '/user/:id', 
     	component: User,
      	children: [
            {
              // å½“ /user/:id/profile åŒ¹é…æˆåŠŸï¼Œ
              // UserProfile ä¼šè¢«æ¸²æŸ“åœ¨ User çš„ <router-view> ä¸­
              path: 'profile',
              component: UserProfile
            },
            {
              // å½“ /user/:id/posts åŒ¹é…æˆåŠŸ
              // UserPosts ä¼šè¢«æ¸²æŸ“åœ¨ User çš„ <router-view> ä¸­
              path: 'posts',
              component: UserPosts
            }
      ]
    }
  ]
})
```

**è¦æ³¨æ„ï¼Œä»¥ `/` å¼€å¤´çš„åµŒå¥—è·¯å¾„ä¼šè¢«å½“ä½œæ ¹è·¯å¾„ã€‚ è¿™è®©ä½ å……åˆ†çš„ä½¿ç”¨åµŒå¥—ç»„ä»¶è€Œæ— é¡»è®¾ç½®åµŒå¥—çš„è·¯å¾„ã€‚**

ä½ ä¼šå‘ç°ï¼Œ`children` é…ç½®å°±æ˜¯åƒ `routes` é…ç½®ä¸€æ ·çš„è·¯ç”±é…ç½®æ•°ç»„ï¼Œæ‰€ä»¥å‘¢ï¼Œä½ å¯ä»¥åµŒå¥—å¤šå±‚è·¯ç”±ã€‚

æ­¤æ—¶ï¼ŒåŸºäºä¸Šé¢çš„é…ç½®ï¼Œå½“ä½ è®¿é—® `/user/foo` æ—¶ï¼Œ`User` çš„å‡ºå£æ˜¯ä¸ä¼šæ¸²æŸ“ä»»ä½•ä¸œè¥¿ï¼Œè¿™æ˜¯å› ä¸ºæ²¡æœ‰åŒ¹é…åˆ°åˆé€‚çš„å­è·¯ç”±ã€‚å¦‚æœä½ æƒ³è¦æ¸²æŸ“ç‚¹ä»€ä¹ˆï¼Œå¯ä»¥æä¾›ä¸€ä¸ª ç©ºçš„ å­è·¯ç”±ï¼š

```js
const router = new VueRouter({
  routes: [
    {
      path: '/user/:id', component: User,
      children: [
        // å½“ /user/:id åŒ¹é…æˆåŠŸï¼Œ
        // UserHome ä¼šè¢«æ¸²æŸ“åœ¨ User çš„ <router-view> ä¸­
        { path: '', component: UserHome },

        // ...å…¶ä»–å­è·¯ç”±
      ]
    }
  ]
})
```

## 5. ç¼–ç¨‹å¼çš„å¯¼èˆª

é™¤äº†ä½¿ç”¨ `router-link` åˆ›å»º a æ ‡ç­¾æ¥å®šä¹‰å¯¼èˆªé“¾æ¥ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å€ŸåŠ© router çš„å®ä¾‹æ–¹æ³•ï¼Œé€šè¿‡ç¼–å†™ä»£ç æ¥å®ç°ã€‚

### â‘  router.push

**æ³¨æ„ï¼šåœ¨ Vue å®ä¾‹å†…éƒ¨ï¼Œä½ å¯ä»¥é€šè¿‡ `$router` è®¿é—®è·¯ç”±å®ä¾‹ã€‚å› æ­¤ä½ å¯ä»¥è°ƒç”¨ `this.$router.push`ã€‚**

æƒ³è¦å¯¼èˆªåˆ°ä¸åŒçš„ URLï¼Œåˆ™ä½¿ç”¨ `router.push` æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šå‘ history æ ˆæ·»åŠ ä¸€ä¸ªæ–°çš„è®°å½•ï¼Œæ‰€ä»¥ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨åé€€æŒ‰é’®æ—¶ï¼Œåˆ™å›åˆ°ä¹‹å‰çš„ URLã€‚

å½“ä½ ç‚¹å‡» `router-link ` æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨å†…éƒ¨è°ƒç”¨ï¼Œæ‰€ä»¥è¯´ï¼Œç‚¹å‡»`router-link `ç­‰åŒäºè°ƒç”¨ `router.push(...)`ã€‚

| å£°æ˜å¼                      | ç¼–ç¨‹å¼             |
| --------------------------- | ------------------ |
| `< router-link :to="..." >` | `router.push(...)` |

è¯¥æ–¹æ³•çš„å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²è·¯å¾„ï¼Œæˆ–è€…ä¸€ä¸ªæè¿°åœ°å€çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š

```js
// å­—ç¬¦ä¸²
router.push('home')

// å¯¹è±¡
router.push({ path: 'home' })

// å‘½åçš„è·¯ç”± user/123
router.push({ name: 'user', params: { userId: '123' }})

// å¸¦æŸ¥è¯¢å‚æ•°ï¼Œå˜æˆ /register?plan=private
router.push({ path: 'register', query: { plan: 'private' }})
```

**æ³¨æ„ï¼šå¦‚æœæä¾›äº† `path`ï¼Œ`params` ä¼šè¢«å¿½ç•¥ï¼Œä¸Šè¿°ä¾‹å­ä¸­çš„ `query` å¹¶ä¸å±äºè¿™ç§æƒ…å†µã€‚å–è€Œä»£ä¹‹çš„æ˜¯ä¸‹é¢ä¾‹å­çš„åšæ³•ï¼Œä½ éœ€è¦æä¾›è·¯ç”±çš„ `name` æˆ–æ‰‹å†™å®Œæ•´çš„å¸¦æœ‰å‚æ•°çš„ `path`ï¼š**

```js
const userId = '123'
router.push({ name: 'user', params: { userId }}) // -> /user/123
router.push({ path: `/user/${userId}` }) // -> /user/123
// è¿™é‡Œçš„ params ä¸ç”Ÿæ•ˆ
router.push({ path: '/user', params: { userId }}) // -> /user
```

åŒæ ·çš„è§„åˆ™ä¹Ÿé€‚ç”¨äº `router-link` ç»„ä»¶çš„ `to` å±æ€§ã€‚

åœ¨ 2.2.0+ï¼Œå¯é€‰çš„åœ¨ `router.push` æˆ– `router.replace` ä¸­æä¾› `onComplete` å’Œ `onAbort` å›è°ƒä½œä¸ºç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ã€‚è¿™äº›å›è°ƒå°†ä¼šåœ¨å¯¼èˆªæˆåŠŸå®Œæˆ (åœ¨æ‰€æœ‰çš„å¼‚æ­¥é’©å­è¢«è§£æä¹‹å) æˆ–ç»ˆæ­¢ (å¯¼èˆªåˆ°ç›¸åŒçš„è·¯ç”±ã€æˆ–åœ¨å½“å‰å¯¼èˆªå®Œæˆä¹‹å‰å¯¼èˆªåˆ°å¦ä¸€ä¸ªä¸åŒçš„è·¯ç”±) çš„æ—¶å€™è¿›è¡Œç›¸åº”çš„è°ƒç”¨ã€‚åœ¨ 3.1.0+ï¼Œå¯ä»¥çœç•¥ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œæ­¤æ—¶å¦‚æœæ”¯æŒ Promiseï¼Œ`router.push` æˆ– `router.replace` å°†è¿”å›ä¸€ä¸ª Promiseã€‚

**æ³¨æ„**ï¼š å¦‚æœç›®çš„åœ°å’Œå½“å‰è·¯ç”±ç›¸åŒï¼Œåªæœ‰å‚æ•°å‘ç”Ÿäº†æ”¹å˜ (æ¯”å¦‚ä»ä¸€ä¸ªç”¨æˆ·èµ„æ–™åˆ°å¦ä¸€ä¸ª `/users/1` -> `/users/2`)ï¼Œä½ éœ€è¦ä½¿ç”¨ [`beforeRouteUpdate`](https://router.vuejs.org/zh/guide/essentials/dynamic-matching.html#å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–) æ¥å“åº”è¿™ä¸ªå˜åŒ– (æ¯”å¦‚æŠ“å–ç”¨æˆ·ä¿¡æ¯)ã€‚

### â‘¡ router.replace

è·Ÿ `router.push` å¾ˆåƒï¼Œå”¯ä¸€çš„ä¸åŒå°±æ˜¯ï¼Œå®ƒä¸ä¼šå‘ history æ·»åŠ æ–°è®°å½•ï¼Œè€Œæ˜¯è·Ÿå®ƒçš„æ–¹æ³•åä¸€æ · â€”â€” æ›¿æ¢æ‰å½“å‰çš„ history è®°å½•ã€‚

| å£°æ˜å¼                            | ç¼–ç¨‹å¼                |
| --------------------------------- | --------------------- |
| `<router-link :to="..." replace>` | `router.replace(...)` |

### â‘¢ router.go(n)

è¿™ä¸ªæ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œæ„æ€æ˜¯åœ¨ history è®°å½•ä¸­å‘å‰æˆ–è€…åé€€å¤šå°‘æ­¥ï¼Œç±»ä¼¼ `window.history.go(n)`ã€‚

ä¾‹å­

```js
// åœ¨æµè§ˆå™¨è®°å½•ä¸­å‰è¿›ä¸€æ­¥ï¼Œç­‰åŒäº history.forward()
router.go(1)

// åé€€ä¸€æ­¥è®°å½•ï¼Œç­‰åŒäº history.back()
router.go(-1)

// å‰è¿› 3 æ­¥è®°å½•
router.go(3)

// å¦‚æœ history è®°å½•ä¸å¤Ÿç”¨ï¼Œé‚£å°±é»˜é»˜åœ°å¤±è´¥å‘—
router.go(-100)
router.go(100)
```

## 6. å‘½åè·¯ç”±

æœ‰æ—¶å€™ï¼Œé€šè¿‡ä¸€ä¸ªåç§°æ¥æ ‡è¯†ä¸€ä¸ªè·¯ç”±æ˜¾å¾—æ›´æ–¹ä¾¿ä¸€äº›ï¼Œç‰¹åˆ«æ˜¯åœ¨é“¾æ¥ä¸€ä¸ªè·¯ç”±ï¼Œæˆ–è€…æ˜¯æ‰§è¡Œä¸€äº›è·³è½¬çš„æ—¶å€™ã€‚ä½ å¯ä»¥åœ¨åˆ›å»º Router å®ä¾‹çš„æ—¶å€™ï¼Œ**åœ¨ `routes` é…ç½®ä¸­é€šè¿‡ `name` å±æ€§ç»™æŸä¸ªè·¯ç”±è®¾ç½®åç§°**ã€‚

```js
const router = new VueRouter({
  routes: [
    {
      path: '/user/:userId',
      name: 'user',
      component: User
    }
  ]
})
```

è¦é“¾æ¥åˆ°ä¸€ä¸ªå‘½åè·¯ç”±ï¼Œå¯ä»¥ç»™ `router-link` çš„ `to` å±æ€§ä¼ ä¸€ä¸ªå¯¹è±¡ï¼š

```html
<router-link :to="{ name: 'user', params: { userId: 123 }}">User</router-link>
```

è¿™è·Ÿä»£ç è°ƒç”¨ `router.push()` æ˜¯ä¸€å›äº‹ï¼š

```js
router.push({ name: 'user', params: { userId: 123 }})
```

è¿™ä¸¤ç§æ–¹å¼éƒ½ä¼šæŠŠè·¯ç”±å¯¼èˆªåˆ° `/user/123` è·¯å¾„ã€‚

## 7. å‘½åè§†å›¾

æœ‰æ—¶å€™æƒ³åŒæ—¶ (åŒçº§) å±•ç¤ºå¤šä¸ªè§†å›¾ï¼Œè€Œä¸æ˜¯åµŒå¥—å±•ç¤ºï¼Œä¾‹å¦‚åˆ›å»ºä¸€ä¸ªå¸ƒå±€ï¼Œæœ‰ `sidebar` (ä¾§å¯¼èˆª) å’Œ `main` (ä¸»å†…å®¹) ä¸¤ä¸ªè§†å›¾ï¼Œè¿™ä¸ªæ—¶å€™å‘½åè§†å›¾å°±æ´¾ä¸Šç”¨åœºäº†ã€‚ä½ **å¯ä»¥åœ¨ç•Œé¢ä¸­æ‹¥æœ‰å¤šä¸ªå•ç‹¬å‘½åçš„è§†å›¾**ï¼Œè€Œä¸æ˜¯åªæœ‰ä¸€ä¸ªå•ç‹¬çš„å‡ºå£ã€‚**å¦‚æœ `router-view` æ²¡æœ‰è®¾ç½®åå­—ï¼Œé‚£ä¹ˆé»˜è®¤ä¸º `default`**ã€‚

```html
<router-view class="view one"></router-view>
<router-view class="view two" name="a"></router-view>
<router-view class="view three" name="b"></router-view>
```

ä¸€ä¸ªè§†å›¾ä½¿ç”¨ä¸€ä¸ªç»„ä»¶æ¸²æŸ“ï¼Œå› æ­¤å¯¹äºåŒä¸ªè·¯ç”±ï¼Œå¤šä¸ªè§†å›¾å°±éœ€è¦å¤šä¸ªç»„ä»¶ã€‚ç¡®ä¿æ­£ç¡®ä½¿ç”¨ `components` é…ç½® (å¸¦ä¸Š s)ï¼š

```js
const router = new VueRouter({
  routes: [
    {
      path: '/',
      components: {
        default: Foo,
        a: Bar,
        b: Baz
      }
    }
  ]
})
```

### åµŒå¥—å‘½åè§†å›¾

æˆ‘ä»¬ä¹Ÿæœ‰å¯èƒ½ä½¿ç”¨å‘½åè§†å›¾åˆ›å»ºåµŒå¥—è§†å›¾çš„å¤æ‚å¸ƒå±€ã€‚è¿™æ—¶ä½ ä¹Ÿéœ€è¦å‘½åç”¨åˆ°çš„åµŒå¥— `router-view` ç»„ä»¶ã€‚æˆ‘ä»¬ä»¥ä¸€ä¸ªè®¾ç½®é¢æ¿ä¸ºä¾‹ï¼š

```text
/settings/emails                                       /settings/profile
+-----------------------------------+                  +------------------------------+
| UserSettings                      |                  | UserSettings                 |
| +-----+-------------------------+ |                  | +-----+--------------------+ |
| | Nav | UserEmailsSubscriptions | |  +------------>  | | Nav | UserProfile        | |
| |     +-------------------------+ |                  | |     +--------------------+ |
| |     |                         | |                  | |     | UserProfilePreview | |
| +-----+-------------------------+ |                  | +-----+--------------------+ |
+-----------------------------------+                  +------------------------------+
```

- `Nav` åªæ˜¯ä¸€ä¸ªå¸¸è§„ç»„ä»¶ã€‚
- `UserSettings` æ˜¯ä¸€ä¸ªè§†å›¾ç»„ä»¶ã€‚
- `UserEmailsSubscriptions`ã€`UserProfile`ã€`UserProfilePreview` æ˜¯åµŒå¥—çš„è§†å›¾ç»„ä»¶ã€‚



`UserSettings` ç»„ä»¶çš„ template éƒ¨åˆ†åº”è¯¥æ˜¯ç±»ä¼¼ä¸‹é¢çš„è¿™æ®µä»£ç ï¼š

```html
<!-- UserSettings.vue -->
<div>
  <h1>User Settings</h1>
  <NavBar/>
  <router-view/>
  <router-view name="helper"/>
</div>
```



ç„¶åä½ å¯ä»¥ç”¨è¿™ä¸ªè·¯ç”±é…ç½®å®Œæˆè¯¥å¸ƒå±€ï¼š

```js
{
  path: '/settings',
  // ä½ ä¹Ÿå¯ä»¥åœ¨é¡¶çº§è·¯ç”±å°±é…ç½®å‘½åè§†å›¾
  component: UserSettings,
  children: [{
    path: 'emails',
    component: UserEmailsSubscriptions
  }, 
  {
    path: 'profile',
    components: {
      default: UserProfile,
      helper: UserProfilePreview
    }
  }]
}
```

## 8. é‡å®šå‘å’Œåˆ«å

### â‘  é‡å®šå‘

é‡å®šå‘ä¹Ÿæ˜¯é€šè¿‡ `routes` é…ç½®æ¥å®Œæˆï¼Œä¸‹é¢ä¾‹å­æ˜¯ä» `/a` é‡å®šå‘åˆ° `/b`ï¼š

```js
const router = new VueRouter({
  routes: [
    { 
        path: '/a', 
        redirect: '/b' 
    }
  ]
})
```

**é‡å®šå‘çš„ç›®æ ‡ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‘½åçš„è·¯ç”±**ï¼š

```js
const router = new VueRouter({
  routes: [
    { 
        path: '/a', 
        redirect: { 
            name: 'foo' 
        }
    }
  ]
})
```

**ç”šè‡³æ˜¯ä¸€ä¸ªæ–¹æ³•**ï¼ŒåŠ¨æ€è¿”å›é‡å®šå‘ç›®æ ‡ï¼š

```js
const router = new VueRouter({
  routes: [
    { 
        path: '/a', 
        redirect: to => {
          // æ–¹æ³•æ¥æ”¶ ç›®æ ‡è·¯ç”± ä½œä¸ºå‚æ•°
          // return é‡å®šå‘çš„ å­—ç¬¦ä¸²è·¯å¾„/è·¯å¾„å¯¹è±¡
    }}
  ]
})
```

### â‘¡ åˆ«å

<u>â€œé‡å®šå‘â€çš„æ„æ€æ˜¯ï¼Œå½“ç”¨æˆ·è®¿é—® `/a`æ—¶ï¼ŒURL å°†ä¼šè¢«æ›¿æ¢æˆ `/b`ï¼Œç„¶ååŒ¹é…è·¯ç”±ä¸º `/b`</u>ï¼Œé‚£ä¹ˆâ€œåˆ«åâ€åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

**`/a` çš„åˆ«åæ˜¯ `/b`ï¼Œæ„å‘³ç€ï¼Œå½“ç”¨æˆ·è®¿é—® `/b` æ—¶ï¼ŒURL ä¼šä¿æŒä¸º `/b`ï¼Œä½†æ˜¯è·¯ç”±åŒ¹é…åˆ™ä¸º `/a`ï¼Œå°±åƒç”¨æˆ·è®¿é—® `/a` ä¸€æ ·ã€‚**

ä¸Šé¢å¯¹åº”çš„è·¯ç”±é…ç½®ä¸ºï¼š

```js
const router = new VueRouter({
  routes: [
    { 
        path: '/a', 
        component: A, 
        alias: '/b' 
    }
  ]
})
```

â€œåˆ«åâ€çš„åŠŸèƒ½è®©ä½ å¯ä»¥è‡ªç”±åœ°å°† UI ç»“æ„æ˜ å°„åˆ°ä»»æ„çš„ URLï¼Œè€Œä¸æ˜¯å—é™äºé…ç½®çš„åµŒå¥—è·¯ç”±ç»“æ„ã€‚

## 9. è·¯ç”±å®ä¾‹

å‚è€ƒ ğŸ‘‰ [Vueè·¯ç”±è¯¦ç»†è®²è§£æŒ‡å—](https://www.cnblogs.com/dengyao-blogs/p/11562257.html)

### â‘  åŸºæœ¬è·¯ç”±

#### â…  æ–°å»ºPage

- page1.vue

    ```vue
    <template>
        <div>
            <h1>page1</h1>
            <p>{{msg}}</p>
        </div>
    </template>
    <script>
        export default {
            data () {
                return {
                    msg: "æˆ‘æ˜¯page1ç»„ä»¶"
                }
            }
        }
    </script>
    ```

- page2.vue

    ```vue
    <template>
        <div>
            <h1>page2</h1>
            <p>{{msg}}</p>
        </div>
    </template>
    <script>
        export default {
            data () {
                return {
                    msg: "æˆ‘æ˜¯page2ç»„ä»¶"
                }
            }
        }
    </script>
    ```

#### â…¡ é…ç½®è·¯ç”±

```js
import Vue from 'vue'
import VueRouter from 'vue-router'
import page1 from '../views/page1.vue'
import page2 from '../views/page2.vue'


Vue.use(VueRouter)

  const routes = [

  {
    path: '/page1',
    name: 'Page1',
    component: page1
  },
  {
    path: '/page2',
    name: 'Paeg2',
    component: page2
  },
  //é…ç½®é‡å®šå‘,é»˜è®¤ç•Œé¢
  {
    path:'',
    redirect: "page1",
  }
]

const router = new VueRouter({
  mode: 'history',
  base: process.env.BASE_URL,
  routes
})

export default router

```

#### â…¢ ä¿®æ”¹App.Vue

```vue
<template>
  <div id="app">
    <div id="nav">
      <router-link to="/page1">Page1</router-link> |
      <router-link to="/page2">Page2</router-link>
    </div>
    <router-view/>
  </div>
</template>
```

#### â…£ å®ç°æ•ˆæœ

![](https://gitee.com/veal98/images/raw/master/img/vuerouter.gif)

### â‘¡ åŠ¨æ€è·¯ç”±

æ¯”å¦‚ä¸€ä¸ªç½‘ç«™æˆ–è€…åå°ç®¡ç†ç³»ç»Ÿä¸­ï¼Œåœ¨æˆ‘ä»¬ç™»å½•ä¹‹åï¼Œæ˜¯ä¸æ˜¯é€šå¸¸ä¼šæœ‰ä¸€ä¸ªæ¬¢è¿å›æ¥ï¼ŒXXXä¹‹ç±»çš„æç¤ºè¯­ï¼Œè¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åŠ¨æ€è·¯ç”±æ¥å®ç°è¿™ä¸ªæ•ˆæœï¼›

#### â…  æ–°å»ºPage

user.vue

```vue
<template>
    <div>
        <h1>user</h1>
        <!-- è¿™é‡Œå¯ä»¥é€šè¿‡$route.params.nameæ¥è·å–è·¯ç”±çš„å‚æ•° -->
        <p>æ¬¢è¿å›æ¥,{{$route.params.name}}</p>
    </div>
</template>
```

####  â…¡ é…ç½®åŠ¨æ€è·¯ç”±

```js
  //é…ç½®åŠ¨æ€è·¯ç”±
  {
    path: '/user/:name',
    component: user
  }
```

#### â…¢ ä¿®æ”¹App.Vue

```vue
<div>
     <router-link to="/user/text1">DynamicPage1</router-link> |
     <router-link to="/user/text2">DynamicPage2</router-link>
</div>
```

è¿™æ ·ï¼Œåƒ `/user/text1` å’Œ `/user/text2` éƒ½å°†æ˜ å°„åˆ°ç›¸åŒçš„è·¯ç”±ï¼Œä½¿å¾—æˆ‘ä»¬é€šè¿‡é…ç½®ä¸€ä¸ªè·¯ç”±æ¥å®ç°é¡µé¢å±€éƒ¨ä¿®æ”¹çš„æ•ˆæœï¼Œç»™ç”¨æˆ·é€ æˆä¸€ç§å¤šä¸ªé¡µé¢çš„æ„Ÿè§‰

#### â…£ å®ç°æ•ˆæœ

![](https://gitee.com/veal98/images/raw/master/img/dynamicrouter.gif)

### â‘¢ åµŒå¥—è·¯ç”±

å¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„é¡µé¢ç»“æ„å†³å®šäº†æˆ‘ä»¬å¯èƒ½éœ€è¦åµŒå¥—è·¯ç”±ï¼Œæ¯”å¦‚å½“æˆ‘ä»¬è¿›å…¥ä¸»é¡µä¹‹åæœ‰åˆ†ç±»ï¼Œç„¶åå½“é€‰æ‹©å…¶ä¸­ä¸€ä¸ªåˆ†ç±»ä¹‹åè¿›å…¥å¯¹åº”çš„è¯¦æƒ…ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç”¨åˆ°åµŒå¥—è·¯ç”±ï¼›

å®˜æ–¹æ–‡æ¡£ä¸­ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª `children` å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œé‡Œé¢å®é™…æ”¾ç€ä¸€ç»„è·¯ç”±ï¼›è¿™ä¸ªæ—¶å€™çˆ¶å­å…³ç³»ç»“æ„å°±å‡ºæ¥äº†ï¼Œæ‰€ä»¥childrenå±æ€§é‡Œé¢çš„æ˜¯è·¯ç”±ç›¸å¯¹æ¥è¯´æ˜¯childrenå±æ€§å¤–éƒ¨è·¯ç”±çš„å­è·¯ç”±ï¼›

#### â…  æ–°å»ºPage

æ–°å»º parent.vue å’Œ child1.vue å’Œchild2.cue

`parent.vue`

```vue
<template>
    <div>
        <h1>Parent</h1>
        <p>{{msg}}</p>
        // å¯ä»¥ä½¿ç”¨nameè¿›è¡Œè·¯ç”±è·³è½¬
        <router-link :to="{name:'child1'}">Child1</router-link> |
        // å­è·¯ç”±è·¯å¾„ä¸Šä¸è¦åŠ  â€™/â€˜
        <router-link to="child2">Child2</router-link>
        
        <!-- å­è·¯ç”±çš„å†…å®¹ä¼šæ˜¾ç¤ºåœ¨æ­¤å¤„ -->
        <router-view></router-view>
    </div>
</template>
<script>
    export default {
        data () {
            return {
                msg: "æˆ‘æ˜¯Parentç»„ä»¶"
            }
        }
    }
</script>
```

`child1.vue`

```vue
<template>
    <div>
        <h1>Child1</h1>
        <p>{{msg}}</p>
    </div>
</template>
<script>
    export default {
        data () {
            return {
                msg: "æˆ‘æ˜¯Child1ç»„ä»¶"
            }
        }
    }
</script>
```

child2åŒæ ·

#### â…¡ é…ç½®è·¯ç”±

éœ€è¦æ³¨æ„çš„æ˜¯ï¼šä»¥ â€œ/â€ å¼€å¤´çš„åµŒå¥—è·¯å¾„ä¼šè¢«å½“ä½œæ ¹è·¯å¾„ï¼Œæ‰€ä»¥**å­è·¯ç”±ä¸Šä¸ç”¨åŠ  â€œ/â€**

```js
  const routes = [
    {
      path: "/parent",
      component: parent,
      children:[
        {
          // child1 ä¼šè¢«æ¸²æŸ“åœ¨ parent çš„ <router-view> ä¸­
          // ä»¥â€œ/â€å¼€å¤´çš„åµŒå¥—è·¯å¾„ä¼šè¢«å½“ä½œæ ¹è·¯å¾„ï¼Œæ‰€ä»¥å­è·¯ç”±ä¸Šä¸ç”¨åŠ â€œ/â€;
          path:"child1",
          name: "child1",
          component: child1
        },
        {
          path: "child2",
          component: child2
        }
      ]
    }
  ]
```

#### â…¢ ä¿®æ”¹App.vue

```vue
<template>
  <div id="app">
    <div>
      <router-link to="/parent">Parent</router-link>
    </div>
     //æ­¤å¤„æ˜¾ç¤ºçš„æ˜¯çˆ¶è·¯ç”±çš„å†…å®¹
    <router-view></router-view>
  </div>
</template>
```

#### â…£ å®ç°æ•ˆæœ

![](https://gitee.com/veal98/images/raw/master/img/qiantaorouter1.gif)

child1çš„è·¯å¾„ä¸º http://localhost:8080/parent/child1

## 10. å¯¼èˆªå®ˆå«

> â€œå¯¼èˆªâ€è¡¨ç¤ºè·¯ç”±æ­£åœ¨å‘ç”Ÿæ”¹å˜ã€‚

æ­£å¦‚å…¶åï¼Œ`vue-router` æä¾›çš„å¯¼èˆªå®ˆå«ä¸»è¦ç”¨æ¥é€šè¿‡è·³è½¬æˆ–å–æ¶ˆçš„æ–¹å¼å®ˆå«å¯¼èˆªã€‚æœ‰å¤šç§æœºä¼šæ¤å…¥è·¯ç”±å¯¼èˆªè¿‡ç¨‹ä¸­ï¼šå…¨å±€çš„, å•ä¸ªè·¯ç”±ç‹¬äº«çš„, æˆ–è€…ç»„ä»¶çº§çš„ã€‚

æ³¨æ„**å‚æ•°æˆ–æŸ¥è¯¢çš„æ”¹å˜å¹¶ä¸ä¼šè§¦å‘è¿›å…¥/ç¦»å¼€çš„å¯¼èˆªå®ˆå«**ã€‚ä½ å¯ä»¥é€šè¿‡è§‚å¯Ÿ `$route` å¯¹è±¡æ¥åº”å¯¹è¿™äº›å˜åŒ–ï¼Œæˆ–ä½¿ç”¨ `beforeRouteUpdate` çš„ç»„ä»¶å†…å®ˆå«ã€‚

### â‘  å…¨å±€å‰ç½®å®ˆå«

ä½ å¯ä»¥ä½¿ç”¨ `router.beforeEach` æ³¨å†Œä¸€ä¸ªå…¨å±€å‰ç½®å®ˆå«ï¼š

```js
const router = new VueRouter({ ... })

router.beforeEach((to, from, next) => {
  // ...
})
```

å½“ä¸€ä¸ªå¯¼èˆªè§¦å‘æ—¶ï¼Œå…¨å±€å‰ç½®å®ˆå«æŒ‰ç…§åˆ›å»ºé¡ºåºè°ƒç”¨ã€‚å®ˆå«æ˜¯å¼‚æ­¥è§£ææ‰§è¡Œï¼Œæ­¤æ—¶å¯¼èˆªåœ¨æ‰€æœ‰å®ˆå« resolve å®Œä¹‹å‰ä¸€ç›´å¤„äº **ç­‰å¾…ä¸­**ã€‚

æ¯ä¸ªå®ˆå«æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š

- **`to: Route`**: å³å°†è¦è¿›å…¥çš„ç›®æ ‡è·¯ç”±å¯¹è±¡
- **`from: Route`**: å½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”±
- **`next: Function`**: ä¸€å®šè¦è°ƒç”¨è¯¥æ–¹æ³•æ¥ **resolve** è¿™ä¸ªé’©å­ã€‚æ‰§è¡Œæ•ˆæœä¾èµ– `next` æ–¹æ³•çš„è°ƒç”¨å‚æ•°ã€‚
  - **`next()`**: è¿›è¡Œç®¡é“ä¸­çš„ä¸‹ä¸€ä¸ªé’©å­ã€‚å¦‚æœå…¨éƒ¨é’©å­æ‰§è¡Œå®Œäº†ï¼Œåˆ™å¯¼èˆªçš„çŠ¶æ€å°±æ˜¯ **confirmed** (ç¡®è®¤çš„)ã€‚
  - **`next(false)`**: ä¸­æ–­å½“å‰çš„å¯¼èˆªã€‚å¦‚æœæµè§ˆå™¨çš„ URL æ”¹å˜äº† (å¯èƒ½æ˜¯ç”¨æˆ·æ‰‹åŠ¨æˆ–è€…æµè§ˆå™¨åé€€æŒ‰é’®)ï¼Œé‚£ä¹ˆ URL åœ°å€ä¼šé‡ç½®åˆ° `from` è·¯ç”±å¯¹åº”çš„åœ°å€ã€‚
  - **`next('/')` æˆ–è€… `next({ path: '/' })`**: è·³è½¬åˆ°ä¸€ä¸ªä¸åŒçš„åœ°å€ã€‚å½“å‰çš„å¯¼èˆªè¢«ä¸­æ–­ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªæ–°çš„å¯¼èˆªã€‚ä½ å¯ä»¥å‘ `next` ä¼ é€’ä»»æ„ä½ç½®å¯¹è±¡ï¼Œä¸”å…è®¸è®¾ç½®è¯¸å¦‚ `replace: true`ã€`name: 'home'` ä¹‹ç±»çš„é€‰é¡¹ä»¥åŠä»»ä½•ç”¨åœ¨ `router-link` çš„ `to` prop æˆ– [`router.push`](https://router.vuejs.org/zh/api/#router-push) ä¸­çš„é€‰é¡¹ã€‚
  - **`next(error)`**: (2.4.0+) å¦‚æœä¼ å…¥ `next` çš„å‚æ•°æ˜¯ä¸€ä¸ª `Error` å®ä¾‹ï¼Œåˆ™å¯¼èˆªä¼šè¢«ç»ˆæ­¢ä¸”è¯¥é”™è¯¯ä¼šè¢«ä¼ é€’ç»™ [`router.onError()`](https://router.vuejs.org/zh/api/#router-onerror) æ³¨å†Œè¿‡çš„å›è°ƒã€‚

**ç¡®ä¿ `next` å‡½æ•°åœ¨ä»»ä½•ç»™å®šçš„å¯¼èˆªå®ˆå«ä¸­éƒ½è¢«ä¸¥æ ¼è°ƒç”¨ä¸€æ¬¡ã€‚å®ƒå¯ä»¥å‡ºç°å¤šäºä¸€æ¬¡ï¼Œä½†æ˜¯åªèƒ½åœ¨æ‰€æœ‰çš„é€»è¾‘è·¯å¾„éƒ½ä¸é‡å çš„æƒ…å†µä¸‹ï¼Œå¦åˆ™é’©å­æ°¸è¿œéƒ½ä¸ä¼šè¢«è§£ææˆ–æŠ¥é”™ã€‚**è¿™é‡Œæœ‰ä¸€ä¸ªåœ¨ç”¨æˆ·æœªèƒ½éªŒè¯èº«ä»½æ—¶é‡å®šå‘åˆ° `/login` çš„ç¤ºä¾‹ï¼š

```js
// BAD
router.beforeEach((to, from, next) => {
  if (to.name !== 'Login' && !isAuthenticated) 
      next({ name: 'Login' })
  // å¦‚æœç”¨æˆ·æœªèƒ½éªŒè¯èº«ä»½ï¼Œåˆ™ `next` ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡
  next()
})

// GOOD
router.beforeEach((to, from, next) => {
  if (to.name !== 'Login' && !isAuthenticated) 
      next({ name: 'Login' })
  else 
      next()
})
```

### â‘¡ å…¨å±€è§£æå®ˆå«

> 2.5.0 æ–°å¢

åœ¨ 2.5.0+ ä½ å¯ä»¥ç”¨ `router.beforeResolve` æ³¨å†Œä¸€ä¸ªå…¨å±€å®ˆå«ã€‚è¿™å’Œ `router.beforeEach` ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯åœ¨å¯¼èˆªè¢«ç¡®è®¤ä¹‹å‰ï¼Œ**åŒæ—¶åœ¨æ‰€æœ‰ç»„ä»¶å†…å®ˆå«å’Œå¼‚æ­¥è·¯ç”±ç»„ä»¶è¢«è§£æä¹‹å**ï¼Œè§£æå®ˆå«å°±è¢«è°ƒç”¨ã€‚

### â‘¢ å…¨å±€åç½®é’©å­

ä½ ä¹Ÿå¯ä»¥æ³¨å†Œå…¨å±€åç½®é’©å­ï¼Œç„¶è€Œå’Œå®ˆå«ä¸åŒçš„æ˜¯ï¼Œ**è¿™äº›é’©å­ä¸ä¼šæ¥å— `next` å‡½æ•°ä¹Ÿä¸ä¼šæ”¹å˜å¯¼èˆªæœ¬èº«**ï¼š

```js
router.afterEach((to, from) => {
  // ...
})
```

### â‘£ è·¯ç”±ç‹¬äº«çš„å®ˆå«

ä½ å¯ä»¥åœ¨è·¯ç”±é…ç½®ä¸Šç›´æ¥å®šä¹‰ `beforeEnter` å®ˆå«ï¼š

```js
const router = new VueRouter({
  routes: [
    {
      path: '/foo',
      component: Foo,
      beforeEnter: (to, from, next) => {
        // ...
      }
    }
  ]
})
```

è¿™äº›å®ˆå«ä¸å…¨å±€å‰ç½®å®ˆå«çš„æ–¹æ³•å‚æ•°æ˜¯ä¸€æ ·çš„ã€‚

### â‘¤ ç»„ä»¶å†…çš„å®ˆå«

æœ€åï¼Œä½ å¯ä»¥åœ¨è·¯ç”±ç»„ä»¶å†…ç›´æ¥å®šä¹‰ä»¥ä¸‹è·¯ç”±å¯¼èˆªå®ˆå«ï¼š

- `beforeRouteEnter`
- `beforeRouteUpdate` (2.2 æ–°å¢)
- `beforeRouteLeave`

```js
const Foo = {
  template: `...`,
  beforeRouteEnter (to, from, next) {
    // åœ¨æ¸²æŸ“è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±è¢« confirm å‰è°ƒç”¨
    // ä¸ï¼èƒ½ï¼è·å–ç»„ä»¶å®ä¾‹ `this`
    // å› ä¸ºå½“å®ˆå«æ‰§è¡Œå‰ï¼Œç»„ä»¶å®ä¾‹è¿˜æ²¡è¢«åˆ›å»º
  },
  beforeRouteUpdate (to, from, next) {
    // åœ¨å½“å‰è·¯ç”±æ”¹å˜ï¼Œä½†æ˜¯è¯¥ç»„ä»¶è¢«å¤ç”¨æ—¶è°ƒç”¨
    // ä¸¾ä¾‹æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªå¸¦æœ‰åŠ¨æ€å‚æ•°çš„è·¯å¾„ /foo/:idï¼Œåœ¨ /foo/1 å’Œ /foo/2 ä¹‹é—´è·³è½¬çš„æ—¶å€™ï¼Œ
    // ç”±äºä¼šæ¸²æŸ“åŒæ ·çš„ Foo ç»„ä»¶ï¼Œå› æ­¤ç»„ä»¶å®ä¾‹ä¼šè¢«å¤ç”¨ã€‚è€Œè¿™ä¸ªé’©å­å°±ä¼šåœ¨è¿™ä¸ªæƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚
    // å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this`
  },
  beforeRouteLeave (to, from, next) {
    // å¯¼èˆªç¦»å¼€è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±æ—¶è°ƒç”¨
    // å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this`
  }
}
```

`beforeRouteEnter` å®ˆå« **ä¸èƒ½** è®¿é—® `this`ï¼Œå› ä¸ºå®ˆå«åœ¨å¯¼èˆªç¡®è®¤å‰è¢«è°ƒç”¨ï¼Œå› æ­¤å³å°†ç™»åœºçš„æ–°ç»„ä»¶è¿˜æ²¡è¢«åˆ›å»ºã€‚

ä¸è¿‡ï¼Œä½ å¯ä»¥é€šè¿‡ä¼ ä¸€ä¸ªå›è°ƒç»™ `next`æ¥è®¿é—®ç»„ä»¶å®ä¾‹ã€‚åœ¨å¯¼èˆªè¢«ç¡®è®¤çš„æ—¶å€™æ‰§è¡Œå›è°ƒï¼Œå¹¶ä¸”æŠŠç»„ä»¶å®ä¾‹ä½œä¸ºå›è°ƒæ–¹æ³•çš„å‚æ•°ã€‚

```js
beforeRouteEnter (to, from, next) {
  next(vm => {
    // é€šè¿‡ `vm` è®¿é—®ç»„ä»¶å®ä¾‹
  })
}
```

æ³¨æ„ `beforeRouteEnter` æ˜¯æ”¯æŒç»™ `next` ä¼ é€’å›è°ƒçš„å”¯ä¸€å®ˆå«ã€‚å¯¹äº `beforeRouteUpdate` å’Œ `beforeRouteLeave` æ¥è¯´ï¼Œ`this` å·²ç»å¯ç”¨äº†ï¼Œæ‰€ä»¥**ä¸æ”¯æŒ**ä¼ é€’å›è°ƒï¼Œå› ä¸ºæ²¡æœ‰å¿…è¦äº†ã€‚

```js
beforeRouteUpdate (to, from, next) {
  // just use `this`
  this.name = to.params.name
  next()
}
```

è¿™ä¸ªç¦»å¼€å®ˆå«é€šå¸¸ç”¨æ¥ç¦æ­¢ç”¨æˆ·åœ¨è¿˜æœªä¿å­˜ä¿®æ”¹å‰çªç„¶ç¦»å¼€ã€‚è¯¥å¯¼èˆªå¯ä»¥é€šè¿‡ `next(false)` æ¥å–æ¶ˆã€‚

```js
beforeRouteLeave (to, from, next) {
  const answer = window.confirm('Do you really want to leave? you have unsaved changes!')
  if (answer) {
    next()
  } else {
    next(false)
  }
}
```

### â‘¥ å®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹

1. å¯¼èˆªè¢«è§¦å‘ã€‚
2. åœ¨å¤±æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ `beforeRouteLeave` å®ˆå«ã€‚
3. è°ƒç”¨å…¨å±€çš„ `beforeEach` å®ˆå«ã€‚
4. åœ¨é‡ç”¨çš„ç»„ä»¶é‡Œè°ƒç”¨ `beforeRouteUpdate` å®ˆå« (2.2+)ã€‚
5. åœ¨è·¯ç”±é…ç½®é‡Œè°ƒç”¨ `beforeEnter`ã€‚
6. è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶ã€‚
7. åœ¨è¢«æ¿€æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ `beforeRouteEnter`ã€‚
8. è°ƒç”¨å…¨å±€çš„ `beforeResolve` å®ˆå« (2.5+)ã€‚
9. å¯¼èˆªè¢«ç¡®è®¤ã€‚
10. è°ƒç”¨å…¨å±€çš„ `afterEach` é’©å­ã€‚
11. è§¦å‘ DOM æ›´æ–°ã€‚
12. è°ƒç”¨ `beforeRouteEnter` å®ˆå«ä¸­ä¼ ç»™ `next` çš„å›è°ƒå‡½æ•°ï¼Œåˆ›å»ºå¥½çš„ç»„ä»¶å®ä¾‹ä¼šä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ä¼ å…¥ã€‚

## ğŸ“š References

- ğŸ¦ [èœé¸Ÿæ•™ç¨‹](https://www.runoob.com/vue2)

- ğŸ“˜ [Vue å®˜æ–¹æ–‡æ¡£](https://cn.vuejs.org/v2/guide)

- ğŸ‹ [Vue-Router å®˜æ–¹æ–‡æ¡£](http://router.vuejs.org/zh-cn/)

- ğŸ‘‘ [Vueè·¯ç”±è¯¦ç»†è®²è§£æŒ‡å—](https://www.cnblogs.com/dengyao-blogs/p/11562257.html)