---
title: é‡å»ºåºåˆ—
date: 2022-03-22 16:44:30
permalink: /pages/adde9b/
---
## ğŸ“ƒ é¢˜ç›®æè¿°

é¢˜ç›®é“¾æ¥ï¼š

- [å‰‘æŒ‡ Offer II 115. é‡å»ºåºåˆ— - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/ur2n8P/)
- [444. åºåˆ—é‡å»º - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/sequence-reconstruction/)

è¯·åˆ¤æ–­åŸå§‹çš„åºåˆ— org æ˜¯å¦å¯ä»¥ä»åºåˆ—é›† seqs ä¸­å”¯ä¸€åœ°é‡å»º ã€‚

åºåˆ— org æ˜¯ 1 åˆ° n æ•´æ•°çš„æ’åˆ—ï¼Œå…¶ä¸­ 1 â‰¤ n â‰¤ 104ã€‚é‡å»º æ˜¯æŒ‡åœ¨åºåˆ—é›† seqs ä¸­æ„å»ºæœ€çŸ­çš„å…¬å…±è¶…åºåˆ—ï¼Œå³  seqs ä¸­çš„ä»»æ„åºåˆ—éƒ½æ˜¯è¯¥æœ€çŸ­åºåˆ—çš„å­åºåˆ—ã€‚

ç¤ºä¾‹ 1ï¼š

```
è¾“å…¥: org = [1,2,3], seqs = [[1,2],[1,3]]
è¾“å‡º: false
è§£é‡Šï¼š[1,2,3] ä¸æ˜¯å¯ä»¥è¢«é‡å»ºçš„å”¯ä¸€çš„åºåˆ—ï¼Œå› ä¸º [1,3,2] ä¹Ÿæ˜¯ä¸€ä¸ªåˆæ³•çš„åºåˆ—ã€‚
```

ç¤ºä¾‹ 2ï¼š

```
è¾“å…¥: org = [1,2,3], seqs = [[1,2]]
è¾“å‡º: false
è§£é‡Šï¼šå¯ä»¥é‡å»ºçš„åºåˆ—åªæœ‰ [1,2]ã€‚
```

## ğŸ”” è§£é¢˜æ€è·¯

é¢˜ç›®ä¸­çš„å…³é”®å¥å­ï¼š**seqs ä¸­çš„ä»»æ„åºåˆ—éƒ½æ˜¯ org çš„å­åºåˆ—**ï¼Œå³ org ä¸­æ•°å­—çš„ç›¸å¯¹é¡ºåºè¦å’Œ seqs ä¸­æ•°å­—çš„ç›¸å¯¹é¡ºåºä¸€è‡´ã€‚

æ‰€ä»¥å¾ˆç®€å•ï¼ŒæŠŠ seqs ä¸­æ‰€æœ‰ä¸åŒçš„å…ƒç´ æŒ‘å‡ºæ¥ï¼Œç„¶åæŒ‰ç…§ seqs ä¸­è§„å®šçš„é¡ºåºç»„æˆ org å°±å¯ä»¥äº†ï¼ˆæ„é€ æœ‰å‘å›¾ï¼Œç„¶åæ‹“æ‰‘æ’åºï¼‰

ä¾‹å¦‚ï¼Œseq = [[5ï¼Œ2ï¼Œ6ï¼Œ3]ï¼Œ[4ï¼Œ1ï¼Œ5ï¼Œ2]]æ„å»ºçš„æœ‰å‘å›¾å¦‚å›¾æ‰€ç¤º

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220322171341.png)

æ‹“æ‰‘æ’åºç»“æœå”¯ä¸€ï¼Œ4 1 5 2 6 3ï¼Œåªè¦ org æ˜¯è¿™ä¸ªå°±è¿”å› true


```java
class Solution {
    public boolean sequenceReconstruction(int[] org, List<List<Integer>> seqs) {
        Map<Integer, Set<Integer>> graph = new HashMap<>();
        Map<Integer, Integer> inDegress = new HashMap<>();

        for (List<Integer> seq : seqs) {
            // åˆå§‹åŒ– graph å’Œ inDegress
            for (int num : seq) {
                graph.putIfAbsent(num, new HashSet<>());
                inDegress.putIfAbsent(num, 0);
            }

            // æ„é€ å›¾
            for (int i = 0;  i < seq.size() - 1; i ++) {
                int pre = seq.get(i);
                int post = seq.get(i + 1);
                // å¦‚æœå›¾ä¸­å·²ç»å­˜åœ¨ pre -> post çš„å…³ç³»äº†ï¼Œåˆ™ä¸å†è¿›è¡Œå¤„ç†ï¼Œé˜²æ­¢å…¥åº¦ç»Ÿè®¡é”™è¯¯
                if (!graph.get(pre).contains(post)) {
                    // seq[i] åœ¨ seq[i + 1] å‰é¢ï¼Œseq[i] -> seq[i + 1]
                    graph.get(pre).add(post);
                    // seq[i + 1] çš„å…¥åº¦ ++
                    inDegress.put(post, inDegress.get(post) + 1);
                }
            }
        }

        // å­˜å‚¨æ‹“æ‰‘æ’åºçš„ç»“æœ
        List<Integer> list = new ArrayList<>();

        // BFS å®ç°æ‹“æ‰‘æ’åº
        Queue<Integer> queue = new LinkedList<>();
        // å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹å…¥é˜Ÿ
        for (int in : inDegress.keySet()) {
            if (inDegress.get(in) == 0) {
                queue.offer(in);
            }
        }

        while (!queue.isEmpty()) {
            int size = queue.size();
            // å¦‚æœé˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹æ•°ç›®å¤§äº 1 æ—¶ï¼Œå°±è¯´æ˜æ­¤æ—¶æœ‰å¤šä¸ªå…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹ï¼Œè¿™ä¼šå¯¼è‡´æ‹“æ‰‘æ’åºçš„ç»“æœä¸å”¯ä¸€
            if (size != 1) {
                return false;
            }
            
            // ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶å°†è¯¥èŠ‚ç‚¹æ·»åŠ åˆ°æ‹“æ‰‘æ’åºåºåˆ—ä¸­
            int cur = queue.poll();
            list.add(cur);

            // æ‰¾åˆ° cur æŒ‡å‘çš„èŠ‚ç‚¹å¹¶å°†å®ƒä»¬çš„å…¥åº¦å‡ 1
            for (int next : graph.get(cur)) {
                inDegress.put(next, inDegress.get(next) - 1);
                // å¦‚æœå‘ç°æ–°çš„å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹ï¼Œåˆ™å°†å…¶æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­
                if (inDegress.get(next) == 0) {
                    queue.offer(next);
                }
            }
        }
		
        // è¿™ä¸ªåˆ¤æ–­å¯ä»¥è§„é¿æ¯”å¦‚ org = [1]ï¼Œseqs = [[1],[2,3],[3,2]] è¿™ç§æƒ…å†µ
        // seqs å¯ä»¥ç»„å»ºå‡º orgï¼Œä½†æ˜¯æ²¡ç”¨åˆ° seqs ä¸­çš„å…¨éƒ¨å­—ç¬¦ï¼Œè¿™ç§æƒ…å†µæ˜¯ä¸ç¬¦åˆé¢˜æ„çš„
        if (list.size() != inDegress.size()) {
            return false;
        }

        int[] res = list.stream().mapToInt(Integer::intValue).toArray();
        return Arrays.equals(res, org);
    }
}
```

â­ æ³¨æ„å“¦ï¼Œç”±äºç›®æ ‡æ˜¯åˆ¤æ–­å›¾çš„æ‹“æ‰‘æ’åºåºåˆ—æ˜¯å¦å”¯ä¸€ï¼Œé‚£å¦‚æœæŸä¸ªæ—¶åˆ»é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹æ•°ç›®å¤§äº 1 æ—¶ï¼Œå°±è¯´æ˜æ­¤æ—¶æœ‰å¤šä¸ªå…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹ï¼Œè¿™ä¼šå¯¼è‡´æ‹“æ‰‘æ’åºçš„ç»“æœä¸å”¯ä¸€ã€‚ç”±æ­¤å¯çŸ¥ï¼Œä¸Šè¿°ä»£ç åªåœ¨é˜Ÿåˆ—çš„å¤§å°ä¸º 1 çš„æ—¶å€™æ·»åŠ å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹ã€‚

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220610111631.png)

å¦å¤–ï¼Œ**æ³¨æ„æˆ‘ä»¬ä¸Šé¢ä»£ç ä¸­ã€åˆå§‹åŒ– graph å’Œ inDegressã€‘çš„è¿‡ç¨‹æ˜¯åŸºäº seqs åºåˆ—è€Œä¸æ˜¯ org æ•°ç»„çš„**

å¦‚æœè¿™ä¸ªè¿‡ç¨‹åŸºäº org åšçš„è¯ï¼Œå°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼Œæ³¨æ„è¿™æ˜¯é”™è¯¯çš„ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼

```java
Map<Integer, Set<Integer>> graph = new HashMap<>();
Map<Integer, Integer> inDegress = new HashMap<>();

// åˆå§‹åŒ– graph å’Œ inDegress
for (int num : org) {
    map.putIfAbsent(num, new ArrayList<>());
    inDegrees.putIfAbsent(num, 0);
}
    
for (List<Integer> seq : seqs) {
    // æ„é€ å›¾
    for (int i = 0;  i < seq.size() - 1; i ++) {
        int pre = seq.get(i);
        int post = seq.get(i + 1);
        // å¦‚æœå›¾ä¸­å·²ç»å­˜åœ¨ pre -> post çš„å…³ç³»äº†ï¼Œåˆ™ä¸å†è¿›è¡Œå¤„ç†ï¼Œé˜²æ­¢å…¥åº¦ç»Ÿè®¡é”™è¯¯
        if (!graph.get(pre).contains(post)) {
            // seq[i] åœ¨ seq[i + 1] å‰é¢ï¼Œseq[i] -> seq[i + 1]
            graph.get(pre).add(post);
            // seq[i + 1] çš„å…¥åº¦ ++
            inDegress.put(post, inDegress.get(post) + 1);
        }
    }
}
```

ä¸¾ä¸ªä¾‹å­å°±æ˜ç™½äº†

```
org = [1]
seqs = []
```

å¦‚æœåŸºäº org ã€åˆå§‹åŒ– graph å’Œ inDegressã€‘çš„è¯ï¼Œé‚£ä¹ˆ inDegress ä¸­å°±åŒ…å« 1ã€‚ç»§ç»­å¾€ä¸‹èµ°ï¼Œå°±ä¼šèµ°åˆ°é˜Ÿåˆ—çš„å¤„ç†é€»è¾‘ï¼Œæ‹“æ‰‘æ’åºçš„ç»“æœ list ä¸­ä¹Ÿä¼šæœ‰ 1 è¿™ä¸ªæ•°ï¼Œç„¶åå°† list å’Œ org ä¸­å…ƒç´ ä¸€å¯¹æ¯”ï¼Œè¯¶ï¼Œç«Ÿç„¶æ˜¯ä¸€æ ·çš„ï¼Œè¿”å› trueã€‚è¿™æ˜¾ç„¶æ˜¯é”™è¯¯çš„ï¼Œseqs å•¥ä¹Ÿæ²¡æœ‰ï¼Œæ€ä¹ˆèƒ½é‡å»ºå‡º org å‘¢ï¼Ÿ

å¦‚æœåŸºäº seqs  ã€åˆå§‹åŒ– graph å’Œ inDegressã€‘çš„è¯ï¼Œé‚£ä¹ˆ inDegress ä¸­å°±æ˜¯ç©ºçš„ï¼Œå°±ä¸ä¼šèµ°åˆ°ä¸‹é¢é˜Ÿåˆ—å¤„ç†çš„é€»è¾‘ï¼Œæ‹“æ‰‘æ’åºçš„ç»“æœ list ä¸­ä¹Ÿå°±æ˜¯ç©ºçš„ï¼Œåå°† list å’Œ org ä¸­å…ƒç´ ä¸€å¯¹æ¯”ï¼Œæœ€ç»ˆè¿”å› false

## ğŸ’¥ å¤æ‚åº¦åˆ†æ

- ç©ºé—´å¤æ‚åº¦ï¼š
- æ—¶é—´å¤æ‚åº¦ï¼š

