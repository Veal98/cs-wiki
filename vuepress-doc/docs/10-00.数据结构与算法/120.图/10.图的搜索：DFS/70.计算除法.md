---
title: è®¡ç®—é™¤æ³•
date: 2022-03-21 17:50:33
permalink: /pages/e5684b/
---

## ğŸ“ƒ é¢˜ç›®æè¿°

é¢˜ç›®é“¾æ¥ï¼š

- [å‰‘æŒ‡ Offer II 111. è®¡ç®—é™¤æ³• - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/vlzXQL/)
- [399. é™¤æ³•æ±‚å€¼ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/evaluate-division/)

ç»™å®šä¸€ä¸ªå˜é‡å¯¹æ•°ç»„ equations å’Œä¸€ä¸ªå®æ•°å€¼æ•°ç»„ values ä½œä¸ºå·²çŸ¥æ¡ä»¶ï¼Œå…¶ä¸­ equations[i] = [Ai, Bi] å’Œ values[i] å…±åŒè¡¨ç¤ºç­‰å¼ Ai / Bi = values[i] ã€‚æ¯ä¸ª Ai æˆ– Bi æ˜¯ä¸€ä¸ªè¡¨ç¤ºå•ä¸ªå˜é‡çš„å­—ç¬¦ä¸²ã€‚

å¦æœ‰ä¸€äº›ä»¥æ•°ç»„ queries è¡¨ç¤ºçš„é—®é¢˜ï¼Œå…¶ä¸­ queries[j] = [Cj, Dj] è¡¨ç¤ºç¬¬ j ä¸ªé—®é¢˜ï¼Œè¯·ä½ æ ¹æ®å·²çŸ¥æ¡ä»¶æ‰¾å‡º Cj / Dj = ? çš„ç»“æœä½œä¸ºç­”æ¡ˆã€‚

è¿”å› æ‰€æœ‰é—®é¢˜çš„ç­”æ¡ˆ ã€‚å¦‚æœå­˜åœ¨æŸä¸ªæ— æ³•ç¡®å®šçš„ç­”æ¡ˆï¼Œåˆ™ç”¨ -1.0 æ›¿ä»£è¿™ä¸ªç­”æ¡ˆã€‚å¦‚æœé—®é¢˜ä¸­å‡ºç°äº†ç»™å®šçš„å·²çŸ¥æ¡ä»¶ä¸­æ²¡æœ‰å‡ºç°çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿéœ€è¦ç”¨ -1.0 æ›¿ä»£è¿™ä¸ªç­”æ¡ˆã€‚

æ³¨æ„ï¼šè¾“å…¥æ€»æ˜¯æœ‰æ•ˆçš„ã€‚å¯ä»¥å‡è®¾é™¤æ³•è¿ç®—ä¸­ä¸ä¼šå‡ºç°é™¤æ•°ä¸º 0 çš„æƒ…å†µï¼Œä¸”ä¸å­˜åœ¨ä»»ä½•çŸ›ç›¾çš„ç»“æœã€‚

ç¤ºä¾‹ 1ï¼š

```
è¾“å…¥ï¼šequations = [["a","b"],["b","c"]], values = [2.0,3.0], queries = [["a","c"],["b","a"],["a","e"],["a","a"],["x","x"]]
è¾“å‡ºï¼š[6.00000,0.50000,-1.00000,1.00000,-1.00000]
è§£é‡Šï¼š
æ¡ä»¶ï¼ša / b = 2.0, b / c = 3.0
é—®é¢˜ï¼ša / c = ?, b / a = ?, a / e = ?, a / a = ?, x / x = ?
ç»“æœï¼š[6.0, 0.5, -1.0, 1.0, -1.0 ]
```

ç¤ºä¾‹ 2ï¼š

```
è¾“å…¥ï¼šequations = [["a","b"],["b","c"],["bc","cd"]], values = [1.5,2.5,5.0], queries = [["a","c"],["c","b"],["bc","cd"],["cd","bc"]]
è¾“å‡ºï¼š[3.75000,0.40000,5.00000,0.20000]
```

ç¤ºä¾‹ 3ï¼š

```
è¾“å…¥ï¼šequations = [["a","b"]], values = [0.5], queries = [["a","b"],["b","a"],["a","c"],["x","y"]]
è¾“å‡ºï¼š[0.50000,2.00000,-1.00000,-1.00000]
```

## ğŸ”” è§£é¢˜æ€è·¯

ç”¨é‚»æ¥è¡¨æ„é€ **æœ‰å‘å›¾**ï¼Œæ¯”å¦‚ a/b = 2.0ï¼Œé‚£ä¹ˆå°±æ„é€ ä¸¤ä¸ªèŠ‚ç‚¹ a å’Œ bï¼Œä»¥åŠ a æŒ‡å‘ b çš„è¿™æ¡è¾¹æƒé‡ä¸º 2.0

<img src="https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220321203805.png" style="zoom:67%;" />



HashMap çš„é”®æ˜¯å›¾ä¸­çš„èŠ‚ç‚¹ï¼ˆå¯¹åº”ä¸€ä¸ªå˜é‡ï¼Œæ˜¯æœ‰å‘è¾¹çš„èµ·å§‹èŠ‚ç‚¹ï¼‰ï¼Œå€¼æ˜¯ä¸è¯¥èŠ‚ç‚¹ç›¸è¿çš„å…¶ä»–èŠ‚ç‚¹ã€‚ä¸ä¸€ä¸ªèŠ‚ç‚¹ç›¸è¿çš„å…¶ä»–èŠ‚ç‚¹ä¹Ÿç”¨ HashMap è¡¨ç¤ºï¼Œå®ƒçš„é”®æ˜¯å›¾ä¸­çš„èŠ‚ç‚¹ï¼ˆå¯¹åº”ä¸€ä¸ªå˜é‡ï¼Œæ˜¯æœ‰å‘è¾¹çš„ç»ˆæ­¢èŠ‚ç‚¹ï¼‰ï¼Œå€¼æ˜¯è¾¹çš„æƒé‡ï¼ˆä¹Ÿå°±æ˜¯ä¸¤ä¸ªå˜é‡è¿›è¡Œé™¤æ³•è¿ç®—å¾—åˆ°çš„å•†ï¼‰ã€‚

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220321204333.png)

å…¶ä¸­ï¼ŒDFS ç›´æ¥å¥—æ¨¡æ¿å³å¯


```java
class Solution {
    public double[] calcEquation(List<List<String>> equations, double[] values, List<List<String>> queries) {
        // æ„å»ºæœ‰å‘å›¾é‚»æ¥è¡¨ key: å›¾ä¸­çš„èŠ‚ç‚¹ï¼Œvalueï¼ˆmapï¼‰:key ä¸ä¹‹ç›¸é‚»çš„èŠ‚ç‚¹ã€valueï¼ˆæƒå€¼ï¼‰: a/b çš„å€¼
        Map<String, Map<String, Double>> graph = buildGraph(equations, values);

        double[] res = new double[queries.size()];

        // éå†å¤„ç† queries
        for (int i = 0; i < queries.size(); i ++) {
            List<String> item = queries.get(i);
            String source = item.get(0);
            String end = item.get(1);

            // è¡¨ç¤ºæ¯ä¸ªèŠ‚ç‚¹æ˜¯å¦è®¿é—®è¿‡
            Set<String> visited = new HashSet<>();
            // res[i] = source/end
            res[i] = dfs(source, end, graph, visited);
        }

        return res;
    }

    // è¿”å› source -> end è¿™æ¡è¾¹ä¸Šçš„æƒå€¼
    private double dfs(String source, String end, Map<String, Map<String, Double>> graph, Set<String> visited) {
        if (!graph.containsKey(source) || !graph.containsKey(end)) {
            return -1.0;
        }

        if (source.equals(end)) {
            return 1.0;
        }
		
        // è®¿é—® source
        visited.add(source);

        Map<String, Double> map = graph.get(source);
        // dfs ä¸ source ç›¸é‚»çš„æ‰€æœ‰èŠ‚ç‚¹ï¼ˆæœ‰å‘å›¾ï¼‰
        for (String neighboor : map.keySet()) {
            if (!visited.contains(neighboor)) {
                // neighboor -> end è¿™æ¡è¾¹ä¸Šçš„æƒå€¼
                double neighboorValue = dfs(neighboor, end, graph, visited);
                if (neighboorValue > 0) {
                    // source -> end è¿™æ¡è¾¹ä¸Šçš„æƒå€¼ = source -> neighboor è¿™æ¡è¾¹ä¸Šçš„æƒå€¼ * neighboor -> end è¿™æ¡è¾¹ä¸Šçš„æƒå€¼
                    return map.get(neighboor) * neighboorValue;
                }
            }
        }

        return -1.0;
    }

    // æ„å»ºæœ‰å‘å›¾é‚»æ¥è¡¨ key: å›¾ä¸­çš„èŠ‚ç‚¹ï¼Œvalueï¼ˆmapï¼‰:key ä¸ä¹‹ç›¸é‚»çš„èŠ‚ç‚¹ã€valueï¼ˆæƒå€¼ï¼‰: a/b çš„å€¼
    private Map<String, Map<String, Double>> buildGraph(List<List<String>> equations, double[] values) {
        Map<String, Map<String, Double>> graph = new HashMap<>();

        for (int i = 0; i < equations.size(); i ++) {
            List<String> item = equations.get(i);
            double value = values[i];

            // source -> end
            graph.putIfAbsent(item.get(0), new HashMap<>());
            graph.get(item.get(0)).put(item.get(1), value);

            // end -> source
            graph.putIfAbsent(item.get(1), new HashMap<>());
            graph.get(item.get(1)).put(item.get(0), 1.0 / value);
        }

        return graph;
    }
}
```

## ğŸ’¥ å¤æ‚åº¦åˆ†æ

- ç©ºé—´å¤æ‚åº¦ï¼š
- æ—¶é—´å¤æ‚åº¦ï¼š

