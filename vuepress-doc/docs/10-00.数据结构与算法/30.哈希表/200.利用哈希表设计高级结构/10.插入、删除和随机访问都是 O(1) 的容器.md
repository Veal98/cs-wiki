---
title: æ’å…¥ã€åˆ é™¤å’Œéšæœºè®¿é—®éƒ½æ˜¯ O(1) çš„å®¹å™¨
date: 2022-04-13 10:48:14
permalink: /pages/217dd3/
---
## ğŸ“ƒ é¢˜ç›®æè¿°

é¢˜ç›®é“¾æ¥ï¼š

- [å‰‘æŒ‡ Offer II 030. æ’å…¥ã€åˆ é™¤å’Œéšæœºè®¿é—®éƒ½æ˜¯ O(1) çš„å®¹å™¨ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/FortPu/)
- [380. O(1) æ—¶é—´æ’å…¥ã€åˆ é™¤å’Œè·å–éšæœºå…ƒç´  - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/insert-delete-getrandom-o1/)

è®¾è®¡ä¸€ä¸ªæ”¯æŒåœ¨å¹³å‡ æ—¶é—´å¤æ‚åº¦ O(1) ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œçš„æ•°æ®ç»“æ„ï¼š

- insert(val)ï¼šå½“å…ƒç´  val ä¸å­˜åœ¨æ—¶è¿”å› true ï¼Œå¹¶å‘é›†åˆä¸­æ’å…¥è¯¥é¡¹ï¼Œå¦åˆ™è¿”å› false ã€‚
- remove(val)ï¼šå½“å…ƒç´  val å­˜åœ¨æ—¶è¿”å› true ï¼Œå¹¶ä»é›†åˆä¸­ç§»é™¤è¯¥é¡¹ï¼Œå¦åˆ™è¿”å› false ã€‚
- getRandomï¼šéšæœºè¿”å›ç°æœ‰é›†åˆä¸­çš„ä¸€é¡¹ã€‚æ¯ä¸ªå…ƒç´ åº”è¯¥æœ‰ **ç›¸åŒçš„æ¦‚ç‡** è¢«è¿”å›ã€‚


ç¤ºä¾‹ :

```
è¾“å…¥: inputs = ["RandomizedSet", "insert", "remove", "insert", "getRandom", "remove", "insert", "getRandom"]
[[], [1], [2], [2], [], [1], [2], []]
è¾“å‡º: [null, true, false, true, 2, true, false, 2]
è§£é‡Š:
RandomizedSet randomSet = new RandomizedSet();  // åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„é›†åˆ
randomSet.insert(1); // å‘é›†åˆä¸­æ’å…¥ 1 ï¼Œ è¿”å› true è¡¨ç¤º 1 è¢«æˆåŠŸåœ°æ’å…¥

randomSet.remove(2); // è¿”å› falseï¼Œè¡¨ç¤ºé›†åˆä¸­ä¸å­˜åœ¨ 2 

randomSet.insert(2); // å‘é›†åˆä¸­æ’å…¥ 2 è¿”å› true ï¼Œé›†åˆç°åœ¨åŒ…å« [1,2] 

randomSet.getRandom(); // getRandom åº”éšæœºè¿”å› 1 æˆ– 2 

randomSet.remove(1); // ä»é›†åˆä¸­ç§»é™¤ 1 è¿”å› true ã€‚é›†åˆç°åœ¨åŒ…å« [2] 

randomSet.insert(2); // 2 å·²åœ¨é›†åˆä¸­ï¼Œæ‰€ä»¥è¿”å› false 

randomSet.getRandom(); // ç”±äº 2 æ˜¯é›†åˆä¸­å”¯ä¸€çš„æ•°å­—ï¼ŒgetRandom æ€»æ˜¯è¿”å› 2 
```

## ğŸ”” è§£é¢˜æ€è·¯

<u>ç”±äºé¢˜ç›®è¦æ±‚æ’å…¥å’Œåˆ é™¤ï¼ˆåŒ…æ‹¬åˆ¤æ–­æ•°æ®é›†ä¸­æ˜¯å¦åŒ…å«ä¸€ä¸ªæ•°å€¼ï¼‰çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯Oï¼ˆ1ï¼‰ï¼Œèƒ½å¤ŸåŒæ—¶æ»¡è¶³è¿™äº›æ—¶é—´æ•ˆç‡è¦æ±‚çš„åªæœ‰å“ˆå¸Œè¡¨ï¼Œå› æ­¤è¿™ä¸ªæ•°æ®ç»“æ„è¦ç”¨åˆ°å“ˆå¸Œè¡¨</u>ã€‚

**ä½†æ˜¯å¦‚æœåªç”¨å“ˆå¸Œè¡¨ï¼Œåˆ™ä¸èƒ½ç­‰æ¦‚ç‡åœ°è¿”å›å…¶ä¸­çš„æ¯ä¸ªæ•°å€¼**ã€‚

è¦æƒ³ç­‰æ¦‚ç‡è¿”å›æ¯ä¸ªæ•°å€¼ï¼Œå¯ä»¥è¿™æ ·åšï¼š<u>å¦‚æœæ•°å€¼æ˜¯ä¿å­˜åœ¨æ•°ç»„ä¸­çš„ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“å®ç°ç­‰æ¦‚ç‡è¿”å›æ•°ç»„ä¸­çš„æ¯ä¸ªæ•°å€¼ã€‚å‡è®¾æ•°ç»„çš„é•¿åº¦æ˜¯nï¼Œé‚£ä¹ˆç­‰æ¦‚ç‡éšæœºç”Ÿæˆä»0åˆ°n-1çš„ä¸€ä¸ªæ•°å­—ã€‚å¦‚æœç”Ÿæˆçš„éšæœºæ•°æ˜¯ i ï¼Œåˆ™è¿”å›æ•°ç»„ä¸­ä¸‹æ ‡ä¸ºiçš„æ•°å€¼</u>ã€‚

ç”±æ­¤å¯ä»¥å‘ç°ï¼Œéœ€è¦ç»“åˆå“ˆå¸Œè¡¨å’Œæ•°ç»„çš„ç‰¹æ€§æ¥è®¾è®¡è¿™ä¸ªæ•°æ®å®¹å™¨ã€‚

ç”±äºæ•°å€¼ä¿å­˜åœ¨æ•°ç»„ä¸­ï¼Œå› æ­¤éœ€è¦çŸ¥é“æ¯ä¸ªæ•°å€¼åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œå¦åˆ™åœ¨åˆ é™¤çš„æ—¶å€™å°±å¿…é¡»é¡ºåºæ‰«ææ•´ä¸ªæ•°ç»„æ‰èƒ½æ‰¾åˆ°å¾…åˆ é™¤çš„æ•°å€¼ï¼Œé‚£å°±éœ€è¦Oï¼ˆnï¼‰çš„æ—¶é—´ã€‚é€šå¸¸æŠŠæ¯ä¸ªæ•°å€¼åœ¨æ•°ç»„ä¸­çš„ä½ç½®ä¿¡æ¯ä¿å­˜åˆ°ä¸€ä¸ªHashMapä¸­ï¼ŒHashMapçš„é”®æ˜¯æ•°å€¼ï¼Œè€Œå¯¹åº”çš„å€¼ä¸ºå®ƒåœ¨æ•°ç»„ä¸­çš„ä½ç½®ã€‚


```java
class RandomizedSet {
    
    // ç”¨äºå­˜å‚¨å…ƒç´ 
    private List<Integer> nums;
    // å­˜å‚¨æ•°ç»„å…ƒç´ ä¸å…¶å¯¹åº”çš„ä¸‹æ ‡
    private Map<Integer, Integer> numToLocation;
    
    /** Initialize your data structure here. */
    public RandomizedSet() {
        nums = new ArrayList<>();
        numToLocation = new HashMap<>();
    }
    
    /** Inserts a value to the set. Returns true if the set did not already contain the specified element. */
    public boolean insert(int val) {
        // 1. å½“å…ƒç´  val å­˜åœ¨æ—¶è¿”å› false
        if (numToLocation.containsKey(val)) {
            return false;
        }

        // 2. å½“å…ƒç´  val ä¸å­˜åœ¨æ—¶è¿”å› true ï¼Œå¹¶å‘é›†åˆä¸­æ’å…¥è¯¥é¡¹
        nums.add(val);
        numToLocation.put(val, nums.size() - 1);
        return true;
    }
    
    /** Removes a value from the set. Returns true if the set contained the specified element. */
    public boolean remove(int val) {
        // 1. å½“å…ƒç´  val ä¸å­˜åœ¨æ—¶è¿”å› false
        if (!numToLocation.containsKey(val)) {
            return false;
        }

        // 2. å½“å…ƒç´  val å­˜åœ¨æ—¶è¿”å› true ï¼Œå¹¶ä»é›†åˆä¸­ç§»é™¤è¯¥é¡¹
        // 2.1 ä»é›†åˆä¸­ç§»é™¤
        int location = numToLocation.get(val);
        // å°†æœ€åä¸€ä¸ªå…ƒç´ æ”¾åˆ° location çš„ä½ç½®ï¼Œç„¶ååˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè¿™æ ·æ—¶é—´å¤æ‚åº¦åªæœ‰ O(1)
        int lastVal = nums.get(nums.size() - 1);
        nums.set(location, lastVal); // ArrayList.set() æ–¹æ³•ç”¨äºæ›¿æ¢æ•°ç»„ä¸­æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ 
        nums.remove(nums.size() - 1);
        // 2.2 ä» map ä¸­ç§»é™¤
        // æ›´æ–° numToLocation ä¸­åŸæœ¬ lastVal å¯¹åº”çš„ä¸‹æ ‡
        numToLocation.put(lastVal, location);
        // ç§»é™¤ val
        numToLocation.remove(val);
        

        return true;
    }
    
    /** Get a random element from the set. */
    public int getRandom() {
        Random random = new Random();
        int index = random.nextInt(nums.size());
        return nums.get(index);
    }
}

/**
 * Your RandomizedSet object will be instantiated and called as such:
 * RandomizedSet obj = new RandomizedSet();
 * boolean param_1 = obj.insert(val);
 * boolean param_2 = obj.remove(val);
 * int param_3 = obj.getRandom();
 */
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220413112106.png)



è¿™ä¿©è¡Œä»£ç ä¸èƒ½äº¤æ¢ä½ç½®ï¼Œå¿…é¡»æ˜¯å…ˆæ›´æ–°ä¸‹æ ‡ï¼Œç„¶åå†ç§»é™¤

**ä¸ç„¶å¦‚æœåªæœ‰ä¸€ä¸ªå…ƒç´ çš„è¯ï¼Œå°±ä¼šå‡ºé”™**

ä¸¾ä¸ªä¾‹å­ï¼Œæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´  0ï¼ŒlastVal å’Œ location éƒ½æ˜¯ 0

map å…ˆç§»é™¤æ‰äº†å…ƒç´  0ï¼Œç„¶åæ›´æ–° mapï¼ˆè¿™ä¸æ˜¯åˆæŠŠ 0 èµ‹è¿›å»äº†ï¼‰ï¼Œ

## ğŸ’¥ å¤æ‚åº¦åˆ†æ

- ç©ºé—´å¤æ‚åº¦ï¼š
- æ—¶é—´å¤æ‚åº¦ï¼š

