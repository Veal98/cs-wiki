---
title: è®¾è®¡ LFU ç¼“å­˜ç»“æ„
date: 2022-04-02 14:14:31
permalink: /pages/6829c6/
---
## ğŸ“ƒ é¢˜ç›®æè¿°

é¢˜ç›®é“¾æ¥ï¼š

- [è®¾è®¡LFUç¼“å­˜ç»“æ„_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘ (nowcoder.com)](https://www.nowcoder.com/practice/93aacb4a887b46d897b00823f30bfea1?tpId=295&tqId=1006014&ru=/exam/oj&qru=/ta/format-top101/question-ranking&sourceUrl=%2Fexam%2Foj%3Ftab%3D%E7%AE%97%E6%B3%95%E7%AF%87%26topicId%3D295)

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220402141524.png)

## ğŸ”” è§£é¢˜æ€è·¯

åŒå“ˆå¸Œè¡¨

ç¬¬ä¸€ä¸ªå“ˆå¸Œè¡¨å­˜å‚¨èŠ‚ç‚¹çš„ key-value

ç¬¬äºŒä¸ªå“ˆå¸Œè¡¨å­˜å‚¨ key å¯¹åº”å‡ºç°çš„é¢‘ç‡ï¼ˆå¦å¤–ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¢˜ç›®è¦æ±‚ï¼šå¦‚æœè°ƒç”¨æ¬¡æ•°æœ€å°‘çš„keyæœ‰å¤šä¸ªï¼Œä¸Šæ¬¡è°ƒç”¨å‘ç”Ÿæœ€æ—©çš„ key è¢«åˆ é™¤ï¼‰

### è‡ªå·±å®ç° HashMap

å…·ä½“æ€è·¯å¯ä»¥å‚è€ƒ [BM101 è®¾è®¡ LFU ç¼“å­˜ç»“æ„](https://www.nowcoder.com/practice/93aacb4a887b46d897b00823f30bfea1?tpId=295&tqId=1006014&ru=/exam/oj&qru=/ta/format-top101/question-ranking&sourceUrl=%2Fexam%2Foj%3Ftab%3D%E7%AE%97%E6%B3%95%E7%AF%87%26topicId%3D295)

- [ ] TODO

### LinkedHashMap

å¯ä»¥ç”¨ `LinkedHashMapï¼ˆaccessOrder = trueï¼‰` æŒ‰ç…§è®¿é—®é¡ºåºæ’åºçš„ç‰¹æ€§å­˜å‚¨ key å¯¹åº”çš„é¢‘ç‡ï¼š**å³è°ƒç”¨ get æ–¹æ³•åï¼Œä¼šå°†è¿™æ¬¡è®¿é—®çš„å…ƒç´ ç§»è‡³é“¾è¡¨å°¾éƒ¨**ï¼Œä¸æ–­è®¿é—®å¯ä»¥å½¢æˆæŒ‰è®¿é—®é¡ºåºæ’åºçš„é“¾è¡¨ï¼ˆé¢˜ç›®è¦æ±‚ï¼šå¦‚æœè°ƒç”¨æ¬¡æ•°æœ€å°‘çš„ key æœ‰å¤šä¸ªï¼Œä¸Šæ¬¡è°ƒç”¨å‘ç”Ÿæœ€æ—©çš„ key è¢«åˆ é™¤ï¼‰


```java
import java.util.*;


public class Solution {
    /**
     * lfu design
     * @param operators intæ•´å‹äºŒç»´æ•°ç»„ ops
        - operaotrs[0] è¡¨ç¤ºæ˜¯ set æ“ä½œè¿˜æ˜¯ get æ“ä½œ
        - operators[1] operators[2] è¡¨ç¤º key-value
     * @param k intæ•´å‹ the k
     * @return intæ•´å‹ä¸€ç»´æ•°ç»„
     */
    public int[] LFU (int[][] operators, int k) {
        // å­˜å‚¨ get è¿”å›çš„ç»“æœ
        List<Integer> list = new ArrayList<>();
        
        // key-value
        Map<Integer, Integer> map = new HashMap<>();
        // key-key å‡ºç°çš„é¢‘ç‡
        Map<Integer, Integer> freqMap = new LinkedHashMap<>(16, 0.75f, true);
        
        for (int[] operator : operators) {
            int key = operator[1];
            
            // set
            if (operator[0] == 1) {
                int value = operator[2];
                // å·²ç»ä½¿â½¤è¿‡è¯¥ keyï¼Œmap æ›¿æ¢
                if (map.containsKey(key)) {
                    map.put(key, value);
                    freqMap.put(key, freqMap.get(key) + 1);
                }
                // ç¬¬â¼€æ¬¡ä½¿â½¤åˆ°è¿™ä¸ª keyï¼Œéœ€è¦åˆ¤æ–­ map å®¹é‡
                else {
                    // è¶…è¿‡äº†æœ€å¤§å®¹é‡ï¼Œåˆ™åˆ é™¤é¢‘ç‡æœ€ä½çš„è®°å½•
                    if (map.size() == k) {
                        int removeKey = getMinKey(freqMap);
                        map.remove(removeKey);
                        freqMap.remove(removeKey);
                    }
                    // æ›´æ–° map å’Œ freqMap
                    map.put(key, value);
                    freqMap.put(key, freqMap.getOrDefault(key, 0) + 1);
                }
            }
            // get
            else if (operator[0] == 2) {
                // key ä¸å­˜åœ¨ï¼Œè¿”å› -1
                if (!map.containsKey(key)) {
                    list.add(-1);
                }
                // key å­˜åœ¨ï¼Œæ›´æ–° freqMap
                else {
                    freqMap.put(key, freqMap.get(key) + 1);
                    list.add(map.get(key));
                }
            }
        }
        
        
        // list -> res
        int[] res = new int[list.size()];
        for (int i = 0; i < list.size(); i ++) {
            res[i] = list.get(i);
        }
        return res;
    }
    
    // è·å–é¢‘ç‡æœ€ä½çš„ key
    // é¢˜ç›®è¦æ±‚ï¼šå¦‚æœè°ƒç”¨æ¬¡æ•°æœ€å°‘çš„ key æœ‰å¤šä¸ªï¼Œä¸Šæ¬¡è°ƒç”¨å‘ç”Ÿæœ€æ—©çš„ key è¢«åˆ é™¤
    private int getMinKey(Map<Integer, Integer> freqMap) {
        int minCount = Integer.MAX_VALUE;
        int key = 0;
        for (Map.Entry<Integer, Integer> entry : freqMap.entrySet()) {
            // åªæœ‰å°äºçš„æ—¶å€™æ‰æ›´æ–° key, è¿™æ ·ï¼Œé¢‘ç‡ç›¸ç­‰çš„æ—¶å€™ï¼Œå–åˆ°çš„å°±æ˜¯ç¬¬ä¸€ä¸ªå‡ºç°è¯¥é¢‘ç‡çš„ key
            // ä¹Ÿå°±æ˜¯ä¸Šæ¬¡è°ƒç”¨å‘ç”Ÿæœ€æ—©çš„ keyï¼ˆå› ä¸ºå‘ç”Ÿè°ƒç”¨çš„æ—¶é—´è¶Šæ—©ï¼Œå°±è¶Šæ’åœ¨ LinkedHashMap çš„å‰é¢ï¼‰
            if (entry.getValue() < minCount) {
                minCount = entry.getValue();
                key = entry.getKey();
            }
        }
        return key;
    }
}
```

### è‡ªå·±å®ç° LinkedHashMap

- [ ] TODO

## ğŸ’¥ å¤æ‚åº¦åˆ†æ

- ç©ºé—´å¤æ‚åº¦ï¼š
- æ—¶é—´å¤æ‚åº¦ï¼š

