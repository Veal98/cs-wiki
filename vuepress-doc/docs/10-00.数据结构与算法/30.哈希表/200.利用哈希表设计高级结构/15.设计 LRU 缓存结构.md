---
title: è®¾è®¡ LRU ç¼“å­˜ç»“æ„
date: 2022-04-02 11:06:01
permalink: /pages/cc16e4/
---
## ğŸ“ƒ é¢˜ç›®æè¿°

é¢˜ç›®é“¾æ¥ï¼š

- [å‰‘æŒ‡ Offer II 031. æœ€è¿‘æœ€å°‘ä½¿ç”¨ç¼“å­˜ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/OrIXps/)
- [146. LRU ç¼“å­˜ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/lru-cache/)
- [è®¾è®¡LRUç¼“å­˜ç»“æ„_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘ (nowcoder.com)](https://www.nowcoder.com/practice/5dfded165916435d9defb053c63f1e84?tpId=295&tqId=2427094&ru=/exam/oj&qru=/ta/format-top101/question-ranking&sourceUrl=%2Fexam%2Foj%3Ftab%3D%E7%AE%97%E6%B3%95%E7%AF%87%26topicId%3D295)

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220402110631.png)

ç¤ºä¾‹1

```
è¾“å…¥ï¼š
["set","set","get","set","get","set","get","get","get"],[[1,1],[2,2],[1],[3,3],[2],[4,4],[1],[3],[4]],2

è¿”å›å€¼ï¼š
["null","null","1","null","-1","null","-1","3","4"]

è¯´æ˜ï¼š
æˆ‘ä»¬å°†ç¼“å­˜çœ‹æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œæœ€åä¸€ä¸ªå‚æ•°ä¸º2ä»£è¡¨capacityï¼Œæ‰€ä»¥
Solution s = new Solution(2);
s.set(1,1); //å°†(1,1)æ’å…¥ç¼“å­˜ï¼Œç¼“å­˜æ˜¯{"1"=1}ï¼Œsetæ“ä½œè¿”å›"null"
s.set(2,2); //å°†(2,2)æ’å…¥ç¼“å­˜ï¼Œç¼“å­˜æ˜¯{"2"=2ï¼Œ"1"=1}ï¼Œsetæ“ä½œè¿”å›"null"
output=s.get(1);// å› ä¸ºget(1)æ“ä½œï¼Œç¼“å­˜æ›´æ–°ï¼Œç¼“å­˜æ˜¯{"1"=1ï¼Œ"2"=2}ï¼Œgetæ“ä½œè¿”å›"1"
s.set(3,3); //å°†(3,3)æ’å…¥ç¼“å­˜ï¼Œç¼“å­˜å®¹é‡æ˜¯2ï¼Œæ•…å»æ‰æŸå°¾çš„key-valueï¼Œç¼“å­˜æ˜¯{"3"=3ï¼Œ"1"=1}ï¼Œsetæ“ä½œè¿”å›"null" 
output=s.get(2);// å› ä¸ºget(2)æ“ä½œï¼Œä¸å­˜åœ¨å¯¹åº”çš„keyï¼Œæ•…getæ“ä½œè¿”å›"-1"
s.set(4,4); //å°†(4,4)æ’å…¥ç¼“å­˜ï¼Œç¼“å­˜å®¹é‡æ˜¯2ï¼Œæ•…å»æ‰æŸå°¾çš„key-valueï¼Œç¼“å­˜æ˜¯{"4"=4ï¼Œ"3"=3}ï¼Œsetæ“ä½œè¿”å›"null" 
output=s.get(1);// å› ä¸ºget(1)æ“ä½œï¼Œä¸å­˜åœ¨å¯¹åº”çš„keyï¼Œæ•…getæ“ä½œè¿”å›"-1"
output=s.get(3);//å› ä¸ºget(3)æ“ä½œï¼Œç¼“å­˜æ›´æ–°ï¼Œç¼“å­˜æ˜¯{"3"=3ï¼Œ"4"=4}ï¼Œgetæ“ä½œè¿”å›"3"
output=s.get(4);//å› ä¸ºget(4)æ“ä½œï¼Œç¼“å­˜æ›´æ–°ï¼Œç¼“å­˜æ˜¯{"4"=4ï¼Œ"3"=3}ï¼Œgetæ“ä½œè¿”å›"4"       
```

## ğŸ”” è§£é¢˜æ€è·¯

å…³é”®ç‚¹ï¼šæŸä¸ª key çš„ set/get æ“ä½œä¸€æ—¦å‘ç”Ÿï¼Œåˆ™è®¤ä¸ºè¿™ä¸ª key çš„è®°å½•æˆä¸ºäº†æœ€å¸¸ä½¿ç”¨ï¼Œç„¶åéƒ½ä¼šåˆ·æ–°ç¼“å­˜

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220402120707.png)

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220402120729.png)

åŒå‘é“¾è¡¨ï¼ˆ`LinkedHashMap`ï¼Œä¸è¿‡é¢è¯•çš„æ—¶å€™æœ€å¥½è‡ªå·±å®ç°ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼‰ + å“ˆå¸Œ

æœ€å¸¸ä½¿ç”¨çš„èŠ‚ç‚¹éƒ½ç›´æ¥æ”¾åœ¨é“¾è¡¨çš„å¤´éƒ¨ï¼Œè¿™æ ·ï¼Œé“¾è¡¨çš„å°¾éƒ¨å°±æ˜¯æœ€ä¸å¸¸è®¿é—®çš„

### LinkedHashMap

- [ ] TODO

### è‡ªå·±å®ç° LinkedHashMap


```java
import java.util.*;

public class Solution {
    
    // å®šä¹‰åŒå‘é“¾è¡¨çš„èŠ‚ç‚¹ç»“æ„
    static class Node {
        int key, value;
        Node pre, next;
        public Node(int key, int value) {
            this.key = key;
            this.value = value;
        }
    }
    
    // é“¾è¡¨å¤´(å¤´èŠ‚ç‚¹ï¼Œä¸å­˜å‚¨ä»»ä½•æ•°æ®)
    private Node head = new Node(-1, -1);
    // é“¾è¡¨å°¾(å°¾èŠ‚ç‚¹ï¼Œä¸å­˜å‚¨ä»»ä½•æ•°æ®)
    private Node tail = new Node(-1, -1);
    // å“ˆå¸Œè¡¨ï¼Œä»¥è¾¾åˆ° O(1) çº§åˆ«çš„ set å’Œ get
    private Map<Integer, Node> map;
    
    private int capacity;
    
    public Solution(int capacity) {
        this.capacity = capacity;
        this.map = new HashMap<>();
        head.next = tail;
        tail.next = head;
    }
    
    public int get(int key) {
        if (map.containsKey(key)) {
            Node node = map.get(key);
            // 1. ä»é“¾è¡¨ä¸­åˆ é™¤è¿™ä¸ªå…ƒç´ 
            node.pre.next = node.next;
            node.next.pre = node.pre;
            // 2. node æ·»åŠ åˆ°é“¾è¡¨å¤´
            addHead(node);
            
            return node.value;
        }
        
        // ä¸å­˜åœ¨åˆ™è¿”å› -1
        return -1;
    }

    public void set(int key, int value) {
        // å¦‚æœ key å·²ç»å­˜åœ¨ï¼Œåˆ™æ›´æ–° value
        if (get(key) != -1) {
            // æ³¨æ„å¦‚æœ get(key) != -1 çš„è¯ï¼Œé‚£ä¹ˆå°±å·²ç»æŠŠ key å¯¹åº”çš„ node æ·»åŠ åˆ°æœ€å‰é¢äº†ï¼Œæˆ‘ä»¬è¿™é‡Œåªéœ€è¦æ”¹ä¸‹ value çš„å€¼å°±è¡Œ
            map.get(key).value = value;
        }
        // å¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ™æ’å…¥æ–°èŠ‚ç‚¹ key-value
        else {
            // å¦‚æœèŠ‚ç‚¹çš„æ•°é‡å·²ç»è¶…è¿‡ capacityï¼Œåˆ™å¼¹å‡ºæœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹(æœ€åé¢é‚£ä¸ªèŠ‚ç‚¹ï¼Œæ³¨æ„ä¸æ˜¯å°¾èŠ‚ç‚¹)
            if (map.size() == capacity) {
                int removeKey = tail.pre.key;
                tail.pre.pre.next = tail;
                tail.pre = tail.pre.pre;
                map.remove(removeKey);
            }
            // æ’å…¥æ–°èŠ‚ç‚¹ key-value
            Node node = new Node(key, value);
            map.put(key, node);
            addHead(node);
        }
        
    }
    
    // å°† node èŠ‚ç‚¹æ·»åŠ åˆ°é“¾è¡¨å¤´éƒ¨(head èŠ‚ç‚¹ä¹‹å)
    private void addHead(Node node) {
        node.next = head.next;
        head.next.pre = node;
        
        head.next = node;
        node.pre = head;
    }
}

/**
 * Your Solution object will be instantiated and called as such:
 * Solution solution = new Solution(capacity);
 * int output = solution.get(key);
 * solution.set(key,value);
 */
```

## ğŸ’¥ å¤æ‚åº¦åˆ†æ

- ç©ºé—´å¤æ‚åº¦ï¼š
- æ—¶é—´å¤æ‚åº¦ï¼š

