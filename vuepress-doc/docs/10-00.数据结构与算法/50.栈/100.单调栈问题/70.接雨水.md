---
title: æ¥é›¨æ°´
date: 2022-03-20 11:53:59
permalink: /pages/c5cdfe/
---

## ğŸ“ƒ é¢˜ç›®æè¿°

é¢˜ç›®é“¾æ¥ï¼š[42. æ¥é›¨æ°´ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/trapping-rain-water/)

ç»™å®š n ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸º 1 çš„æŸ±å­çš„é«˜åº¦å›¾ï¼Œè®¡ç®—æŒ‰æ­¤æ’åˆ—çš„æŸ±å­ï¼Œä¸‹é›¨ä¹‹åèƒ½æ¥å¤šå°‘é›¨æ°´ã€‚

 

ç¤ºä¾‹ 1ï¼š

![img](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/10/22/rainwatertrap.png)

```
è¾“å…¥ï¼šheight = [0,1,0,2,1,0,1,3,2,1,2,1]
è¾“å‡ºï¼š6
è§£é‡Šï¼šä¸Šé¢æ˜¯ç”±æ•°ç»„ [0,1,0,2,1,0,1,3,2,1,2,1] è¡¨ç¤ºçš„é«˜åº¦å›¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥æ¥ 6 ä¸ªå•ä½çš„é›¨æ°´ï¼ˆè“è‰²éƒ¨åˆ†è¡¨ç¤ºé›¨æ°´ï¼‰ã€‚
```

## ğŸ”” è§£é¢˜æ€è·¯

### åŠ¨æ€è§„åˆ’

é¦–å…ˆè¦æ˜ç¡®ï¼Œè¦æŒ‰ç…§è¡Œæ¥è®¡ç®—ï¼Œè¿˜æ˜¯æŒ‰ç…§åˆ—æ¥è®¡ç®—ã€‚

æŒ‰è¡Œè®¡ç®—ï¼ˆ**é›¨æ°´é«˜åº¦å›ºå®šä¸º 1**ï¼‰ï¼š

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220225102504.png)

æŒ‰åˆ—è®¡ç®—ï¼ˆ**é›¨æ°´å®½åº¦å›ºå®šä¸º 1**ï¼‰ï¼š

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220225102541.png)

ç›¸å¯¹æ¥è¯´ï¼Œ**æŒ‰åˆ—è®¡ç®—æ›´ç®€å•ç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦ä¾æ¬¡æ±‚å‡ºæ¯åˆ—é›¨æ°´çš„é«˜åº¦å°±å¯ä»¥äº†**ã€‚

â­ **æ¯ä¸€åˆ—é›¨æ°´çš„é«˜åº¦ = Math.min(è¯¥åˆ—å·¦ä¾§ï¼ˆåŒ…å«è¯¥åˆ—ï¼‰æŸ±å­çš„æœ€é«˜é«˜åº¦ï¼Œè¯¥åˆ—å³ä¾§ï¼ˆåŒ…å«è¯¥åˆ—ï¼‰æŸ±å­çš„æœ€é«˜é«˜åº¦ï¼‰ - å½“å‰åˆ—çš„é«˜åº¦** 

> ä»¥ä¸‹ä¾¿æ˜¯åŠ¨æ€è§„åˆ’æ€æƒ³çš„ä½“ç°ï¼š

- ä»å·¦å‘å³éå†ï¼šmaxLeftHeight[i] = Math.max(height[i], maxLeftHeight[i - 1]);
- å³å‘å·¦éå†ï¼šmaxRightHeight[i] = Math.max(height[i], maxRightHeight[i + 1]);


```java
class Solution {
    // æŒ‰åˆ—æ±‚ï¼Œé›¨æ°´çš„å®½åº¦å›ºå®šä¸º 1
    private static int WIDTH = 1;

    public int trap(int[] height) {
        int[] maxLeftHeight = new int[height.length];
        int[] maxRightHeight = new int[height.length];

        // è®°å½•æ¯ä¸ªæŸ±å­å·¦è¾¹æŸ±å­(åŒ…å«è‡ªèº«)æœ€å¤§é«˜åº¦
        maxLeftHeight[0] = height[0]; // base case
        for (int i = 1; i < height.length; i ++) {
            maxLeftHeight[i] = Math.max(height[i], maxLeftHeight[i - 1]);
        }
        // è®°å½•æ¯ä¸ªæŸ±å­å³è¾¹æŸ±å­(åŒ…å«è‡ªèº«)æœ€å¤§é«˜åº¦
        maxRightHeight[height.length - 1] = height[height.length - 1]; // base case 
        for (int i = height.length - 2; i >= 0; i --) {
            maxRightHeight[i] = Math.max(height[i], maxRightHeight[i + 1]);
        }

        // å­˜å‚¨æœ€ç»ˆå‚¨æ°´é‡
        int res = 0;
        // ç¬¬ä¸€ä¸ªæŸ±å­å’Œæœ€åä¸€ä¸ªæŸ±å­ä¸å‚¨æ°´
        for (int i = 1; i < height.length - 1; i ++) {
            // å½“å‰åˆ—é›¨æ°´çš„é«˜åº¦
            int h = Math.min(maxLeftHeight[i], maxRightHeight[i]) - height[i];
            if (h > 0) {
                res += h * WIDTH;
            }
        }

        return res;
    }
}
```

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220225112705.png)

### å•è°ƒæ ˆ

å•è°ƒæ ˆæ˜¯æŒ‰ç…§è¡Œæ–¹å‘æ¥è®¡ç®—é›¨æ°´çš„

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220225102504.png)

æ„é€ ä»æ ˆåº•åˆ°æ ˆé¡¶çš„å•è°ƒé€’å‡æ ˆï¼Œå› ä¸ºä¸€æ—¦å‘ç°æ·»åŠ çš„æŸ±å­é«˜åº¦å¤§äºæ ˆå¤´å…ƒç´ äº†ï¼Œæ­¤æ—¶å°±å‡ºç°å‡¹æ§½äº†ã€‚

**æ ˆå¤´å…ƒç´  stack.peek() å°±æ˜¯å‡¹æ§½åº•éƒ¨çš„æŸ±å­ï¼Œæ ˆå¤´ç¬¬äºŒä¸ªå…ƒç´ å°±æ˜¯å‡¹æ§½å·¦è¾¹çš„æŸ±å­ï¼Œè€Œæ·»åŠ çš„å…ƒç´ å°±æ˜¯å‡¹æ§½å³è¾¹çš„æŸ±å­**

â­ **é›¨æ°´é«˜åº¦ =  Math.min(å‡¹æ§½å·¦è¾¹é«˜åº¦, å‡¹æ§½å³è¾¹é«˜åº¦) - å‡¹æ§½åº•éƒ¨é«˜åº¦**

é›¨æ°´å®½åº¦ = å‡¹æ§½å³è¾¹çš„ä¸‹æ ‡ - å‡¹æ§½å·¦è¾¹çš„ä¸‹æ ‡ - 1ï¼ˆå› ä¸ºåªæ±‚ä¸­é—´çš„é‚£ä¸ªå®½åº¦ï¼‰

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220225110332.png)

ç»†èŠ‚ï¼š

å¦‚æœä¸¤ä¸ªæŸ±å­é«˜åº¦ç›¸åŒï¼ˆè¿™ä¿©æŸ±å­è°åšæ°´æ± åº•éƒ¨éƒ½ä¸€æ ·ï¼‰ï¼Œæ›´æ–°æ ˆå†…ä¸‹æ ‡ï¼Œå³å°†æ ˆé‡Œå…ƒç´ ï¼ˆæ—§ä¸‹æ ‡ï¼‰å¼¹å‡ºï¼Œå°†æ–°å…ƒç´ ï¼ˆæ–°ä¸‹æ ‡ï¼‰åŠ å…¥æ ˆä¸­ã€‚

```java
class Solution {
   
    public int trap(int[] height) {
        // å•è°ƒé€’å‡æ ˆï¼ˆæ ˆåº•åˆ°æ ˆé¡¶ï¼Œå­˜å‚¨ä¸‹æ ‡ï¼‰
        Stack<Integer> stack = new Stack<>();
        // å­˜å‚¨æœ€ç»ˆå‚¨æ°´é‡
        int res = 0;

        for (int i = 0; i < height.length; i ++) {
            if (stack.isEmpty()) {
                stack.push(i);
            }
            else if (height[i] < height[stack.peek()]) {
                stack.push(i);
            }
            else if (height[i] == height[stack.peek()]) {
                stack.pop();
                stack.push(i);
            }
            else {
                while (!stack.isEmpty() && height[i] > height[stack.peek()]) {
                    // å‡¹æ§½åº•éƒ¨æŸ±å­ä¸‹æ ‡
                    int grooveBottom = stack.pop();
                    if (!stack.isEmpty()) { // è¿™é‡ŒåŠ ä¸ªåˆ¤æ–­ä¸»è¦æ˜¯ä¸ºäº†å¤„ç†æ¯”å¦‚ height = {0, 3, ...} è¿™ç§æƒ…å†µ
                        // å‡¹æ§½å·¦ä¾§æŸ±å­ä¸‹æ ‡
                        int grooveLeft = stack.peek();
                        // å‡¹æ§½å³ä¾§æŸ±å­ä¸‹æ ‡
                        int grooveRight = i;

                        // å‡¹æ§½å®½åº¦
                        int w = grooveRight - grooveLeft - 1;
                        // å‡¹æ§½é«˜åº¦
                        int h = Math.min(height[grooveRight], height[grooveLeft]) - height[grooveBottom];

                        res += h * w;
                    }
                }
                stack.push(i);
            }
        }

        return res;
    }
}
```

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220225112743.png)
