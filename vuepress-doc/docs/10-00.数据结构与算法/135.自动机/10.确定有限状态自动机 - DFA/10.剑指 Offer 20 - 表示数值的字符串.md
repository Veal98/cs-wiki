---
title: å‰‘æŒ‡ Offer 20 - è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²
date: 2022-09-30 11:17:14
permalink: /pages/00623b/
---
## ğŸ“ƒ é¢˜ç›®æè¿°

é¢˜ç›®é“¾æ¥ï¼š[å‰‘æŒ‡ Offer 20. è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²](https://leetcode.cn/problems/biao-shi-shu-zhi-de-zi-fu-chuan-lcof/)

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/image-20220930111737477.png)

## ğŸ”” è§£é¢˜æ€è·¯

ç¡®å®šæœ‰é™çŠ¶æ€è‡ªåŠ¨æœº - Deterministic Finite Automatonï¼ŒDFAï¼ˆä»¥ä¸‹ç®€ç§°ã€Œè‡ªåŠ¨æœºã€ï¼‰æ˜¯ä¸€ç±»è®¡ç®—æ¨¡å‹ã€‚å®ƒåŒ…å«ä¸€ç³»åˆ—çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€ä¸­ï¼š

- æœ‰ä¸€ç§ç‰¹æ®Šçš„çŠ¶æ€ï¼Œè¢«ç§°ä½œã€Œåˆå§‹çŠ¶æ€ã€ã€‚
- è¿˜æœ‰ä¸€ç³»åˆ—çŠ¶æ€è¢«ç§°ä¸ºã€Œæ¥å—çŠ¶æ€ã€ï¼Œå®ƒä»¬ç»„æˆäº†ä¸€ä¸ªç‰¹æ®Šçš„é›†åˆã€‚å…¶ä¸­ï¼Œä¸€ä¸ªçŠ¶æ€å¯èƒ½æ—¢æ˜¯ã€Œåˆå§‹çŠ¶æ€ã€ï¼Œä¹Ÿæ˜¯ã€Œæ¥å—çŠ¶æ€ã€ã€‚

**èµ·åˆï¼Œè¿™ä¸ªè‡ªåŠ¨æœºå¤„äºã€Œåˆå§‹çŠ¶æ€ã€ã€‚éšåï¼Œå®ƒé¡ºåºåœ°è¯»å–å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶æ ¹æ®å½“å‰çŠ¶æ€å’Œè¯»å…¥çš„å­—ç¬¦ï¼ŒæŒ‰ç…§æŸä¸ªäº‹å…ˆçº¦å®šå¥½çš„ã€Œè½¬ç§»è§„åˆ™ã€ï¼Œä»å½“å‰çŠ¶æ€è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼›å½“çŠ¶æ€è½¬ç§»å®Œæˆåï¼Œå®ƒå°±è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚å½“å­—ç¬¦ä¸²å…¨éƒ¨è¯»å–å®Œæ¯•åï¼Œå¦‚æœè‡ªåŠ¨æœºå¤„äºæŸä¸ªã€Œæ¥å—çŠ¶æ€ã€ï¼Œåˆ™åˆ¤å®šè¯¥å­—ç¬¦ä¸²ã€Œè¢«æ¥å—ã€ï¼›å¦åˆ™ï¼Œåˆ¤å®šè¯¥å­—ç¬¦ä¸²ã€Œè¢«æ‹’ç»ã€**ã€‚

**æ³¨æ„**ï¼šå¦‚æœè¾“å…¥çš„è¿‡ç¨‹ä¸­æŸä¸€æ­¥è½¬ç§»å¤±è´¥äº†ï¼Œå³ä¸å­˜åœ¨å¯¹åº”çš„ã€Œè½¬ç§»è§„åˆ™ã€ï¼Œæ­¤æ—¶è®¡ç®—å°†æå‰ä¸­æ­¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬ä¹Ÿåˆ¤å®šè¯¥å­—ç¬¦ä¸²ã€Œè¢«æ‹’ç»ã€ã€‚

ä¸€ä¸ªè‡ªåŠ¨æœºï¼Œæ€»èƒ½å¤Ÿå›ç­”æŸç§å½¢å¼çš„ã€Œå¯¹äºç»™å®šçš„è¾“å…¥å­—ç¬¦ä¸² Sï¼Œåˆ¤æ–­å…¶æ˜¯å¦æ»¡è¶³æ¡ä»¶ Pã€çš„é—®é¢˜ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œæ¡ä»¶ P å³ä¸ºã€Œæ„æˆåˆæ³•çš„è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²ã€ã€‚

è‡ªåŠ¨æœºé©±åŠ¨çš„ç¼–ç¨‹ï¼Œå¯ä»¥è¢«çœ‹åšä¸€ç§æš´åŠ›æšä¸¾æ–¹æ³•çš„å»¶ä¼¸ï¼šå®ƒç©·å°½äº†åœ¨ä»»ä½•ä¸€ç§æƒ…å†µä¸‹ï¼Œå¯¹åº”ä»»ä½•çš„è¾“å…¥ï¼Œéœ€è¦åšçš„äº‹æƒ…ã€‚

è‡ªåŠ¨æœºåœ¨è®¡ç®—æœºç§‘å­¦é¢†åŸŸæœ‰ç€å¹¿æ³›çš„åº”ç”¨ã€‚åœ¨ç®—æ³•é¢†åŸŸï¼Œå®ƒä¸å¤§åé¼é¼çš„å­—ç¬¦ä¸²æŸ¥æ‰¾ç®—æ³•ã€ŒKMPã€ç®—æ³•æœ‰ç€å¯†åˆ‡çš„å…³è”ï¼›åœ¨å·¥ç¨‹é¢†åŸŸï¼Œå®ƒæ˜¯å®ç°ã€Œæ­£åˆ™è¡¨è¾¾å¼ã€çš„åŸºç¡€ã€‚


â€»ã€€DFA å³ Deterministic Finite Automatonï¼Œç¡®å®šæœ‰é™è‡ªåŠ¨æœº

| çŠ¶æ€ id |                 çŠ¶æ€æè¿°                 | å¯è½¬ç§»åˆ°çš„çŠ¶æ€ |
| :-----: | :--------------------------------------: | :------------: |
|    0    |                 å¼€å§‹ç©ºæ ¼                 |    0,1,2,4     |
|    1    |       `e/E` ä¹‹å‰çš„ `+/-`ï¼ˆç¬¦å·ä½ï¼‰       |      2,4       |
|    2    |        `.` ä¹‹å‰çš„æ•°å­—ï¼ˆæ•´æ•°éƒ¨åˆ†ï¼‰        |    2,3,6,9     |
|    3    |             å·¦è¾¹æœ‰æ•°å­—çš„ `.`             |     5,6,9      |
|    4    |             å³è¾¹æœ‰æ•°å­—çš„ `.`             |       5        |
|    5    |        `.` ä¹‹åçš„æ•°å­—ï¼ˆå°æ•°éƒ¨åˆ†ï¼‰        |     5,6,9      |
|    6    |                  `e/E`                   |      7,8       |
|    7    | `e/E ` ä¹‹åçš„ `+/-`ï¼ˆæŒ‡æ•°éƒ¨åˆ†çš„ç¬¦å·ä½ï¼‰  |       8        |
|    8    | `e/E  ` ä¹‹åçš„æ•°å­—ï¼ˆæŒ‡æ•°éƒ¨åˆ†çš„æ•´æ•°éƒ¨åˆ†ï¼‰ |      8,9       |
|    9    |                 ç»“å°¾ç©ºæ ¼                 |       9        |

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/image-20220930150854427.png)

```java
class Solution {
    public boolean isNumber(String s) {
        // æ„é€ çŠ¶æ€æœºï¼Œkey:å½“å‰çŠ¶æ€ value:<å½“å‰å­—ç¬¦ç±»å‹, è½¬ç§»åˆ°çš„çŠ¶æ€>
        Map<State, Map<CharType, State>> transfer = new HashMap<>();

        // STATE_INITIAL å¯è½¬ç§»çš„çŠ¶æ€
        Map<CharType, State> initialMap = new HashMap<>() {{
            put(CharType.CHAR_SPACE, State.STATE_INITIAL);
            put(CharType.CHAR_SIGN, State.STATE_INT_SIGN);
            put(CharType.CHAR_NUMBER, State.STATE_INTEGER);
            put(CharType.CHAR_POINT, State.STATE_POINT_RIGHT);
        }};
        transfer.put(State.STATE_INITIAL, initialMap);

        Map<CharType, State> intSignMap = new HashMap<CharType, State>() {{
            put(CharType.CHAR_NUMBER, State.STATE_INTEGER);
            put(CharType.CHAR_POINT, State.STATE_POINT_RIGHT);
        }};
        transfer.put(State.STATE_INT_SIGN, intSignMap);

        Map<CharType, State> integerMap = new HashMap<CharType, State>() {{
            put(CharType.CHAR_NUMBER, State.STATE_INTEGER);
            put(CharType.CHAR_EXP, State.STATE_EXP);
            put(CharType.CHAR_POINT, State.STATE_POINT_LEFT);
            put(CharType.CHAR_SPACE, State.STATE_END);
        }};
        transfer.put(State.STATE_INTEGER, integerMap);

        Map<CharType, State> pointMap = new HashMap<CharType, State>() {{
            put(CharType.CHAR_NUMBER, State.STATE_FRACTION);
            put(CharType.CHAR_EXP, State.STATE_EXP);
            put(CharType.CHAR_SPACE, State.STATE_END);
        }};
        transfer.put(State.STATE_POINT_LEFT, pointMap);

        Map<CharType, State> pointWithoutIntMap = new HashMap<CharType, State>() {{
            put(CharType.CHAR_NUMBER, State.STATE_FRACTION);
        }};
        transfer.put(State.STATE_POINT_RIGHT, pointWithoutIntMap);

        Map<CharType, State> fractionMap = new HashMap<CharType, State>() {{
            put(CharType.CHAR_NUMBER, State.STATE_FRACTION);
            put(CharType.CHAR_EXP, State.STATE_EXP);
            put(CharType.CHAR_SPACE, State.STATE_END);
        }};
        transfer.put(State.STATE_FRACTION, fractionMap);

        Map<CharType, State> expMap = new HashMap<CharType, State>() {{
            put(CharType.CHAR_NUMBER, State.STATE_EXP_INTEGER);
            put(CharType.CHAR_SIGN, State.STATE_EXP_SIGN);
        }};
        transfer.put(State.STATE_EXP, expMap);

        Map<CharType, State> expSignMap = new HashMap<CharType, State>() {{
            put(CharType.CHAR_NUMBER, State.STATE_EXP_INTEGER);
        }};
        transfer.put(State.STATE_EXP_SIGN, expSignMap);

        Map<CharType, State> expNumberMap = new HashMap<CharType, State>() {{
            put(CharType.CHAR_NUMBER, State.STATE_EXP_INTEGER);
            put(CharType.CHAR_SPACE, State.STATE_END);
        }};
        transfer.put(State.STATE_EXP_INTEGER, expNumberMap);

        Map<CharType, State> endMap = new HashMap<CharType, State>() {{
            put(CharType.CHAR_SPACE, State.STATE_END);
        }};
        transfer.put(State.STATE_END, endMap);

        // æ ¹æ®çŠ¶æ€æœºéå† s åšçŠ¶æ€è½¬ç§»
        int len = s.length();
        State curState = State.STATE_INITIAL;

        for (char c : s.toCharArray()) {
            CharType charType = getCharType(c);
            // æ— æ³•æ ¹æ® type è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ 
            if (!transfer.get(curState).containsKey(charType)) {
                return false;
            }

            curState = transfer.get(curState).get(charType);
        }
        
        return curState == State.STATE_INTEGER || 
               curState == State.STATE_POINT_LEFT || 
               curState == State.STATE_FRACTION || 
               curState == State.STATE_EXP_INTEGER || 
               curState == State.STATE_END;
    }

    // çŠ¶æ€
    public enum State {
        STATE_INITIAL(0),
        STATE_INT_SIGN(1),
        STATE_INTEGER(2),
        STATE_POINT_LEFT(3),
        STATE_POINT_RIGHT(4),
        STATE_FRACTION(5),
        STATE_EXP(6),
        STATE_EXP_SIGN(7),
        STATE_EXP_INTEGER(8),
        STATE_END(9);

        private final int value;

        State (int value) {
            this.value = value;
        }

        public int getValue() {
            return value;
        }
    }

    // å­—ç¬¦ç±»å‹
    public enum CharType {
        CHAR_NUMBER,
        CHAR_EXP,
        CHAR_POINT,
        CHAR_SIGN,
        CHAR_SPACE,
        CHAR_ILLEGAL;
    }

    private CharType getCharType(char ch) {
        if (Character.isDigit(ch)) {
            return CharType.CHAR_NUMBER;
        }
        else if (ch == 'e' || ch == 'E') {
            return CharType.CHAR_EXP;
        }
        else if (ch == '.') {
            return CharType.CHAR_POINT;
        }
        else if (ch == '+' || ch == '-') {
            return CharType.CHAR_SIGN;
        }
        else if (ch == ' ') {
            return CharType.CHAR_SPACE;
        }
        
        return CharType.CHAR_ILLEGAL;
    }
}
```

## ğŸ’¥ å¤æ‚åº¦åˆ†æ

- ç©ºé—´å¤æ‚åº¦ï¼š
- æ—¶é—´å¤æ‚åº¦ï¼š