---
title: å‘ä¸‹çš„è·¯å¾„èŠ‚ç‚¹ä¹‹å’Œ
date: 2022-04-21 19:04:19
permalink: /pages/49a7d2/
---
## ğŸ“ƒ é¢˜ç›®æè¿°

é¢˜ç›®é“¾æ¥ï¼š

- [å‰‘æŒ‡ Offer II 050. å‘ä¸‹çš„è·¯å¾„èŠ‚ç‚¹ä¹‹å’Œ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/6eUYwP/)
- [437. è·¯å¾„æ€»å’Œ III - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/path-sum-iii/)

ç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œå’Œä¸€ä¸ªæ•´æ•° targetSum ï¼Œæ±‚è¯¥äºŒå‰æ ‘é‡ŒèŠ‚ç‚¹å€¼ä¹‹å’Œç­‰äº targetSum çš„ è·¯å¾„ çš„æ•°ç›®ã€‚

è·¯å¾„ ä¸éœ€è¦ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä¹Ÿä¸éœ€è¦åœ¨å¶å­èŠ‚ç‚¹ç»“æŸï¼Œä½†æ˜¯è·¯å¾„æ–¹å‘å¿…é¡»æ˜¯å‘ä¸‹çš„ï¼ˆåªèƒ½ä»çˆ¶èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹ï¼‰ã€‚

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220421190456.png)

## ğŸ”” è§£é¢˜æ€è·¯

å’Œ [257. äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/binary-tree-paths/) ä»ç„¶æ˜¯å·®ä¸å¤šçš„ï¼Œä¸è¿‡æ›´å¤æ‚ä¸€ç‚¹ï¼Œæ¶‰åŠå‰ç¼€å’Œé—®é¢˜

å‰ç¼€å’Œï¼ˆå¯ä»¥å‚è€ƒè¿™ä¸ªé¢˜ç›®ï¼š[å‰‘æŒ‡ Offer II 010. å’Œä¸º k çš„å­æ•°ç»„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ (leetcode-cn.com)](https://leetcode-cn.com/problems/QTMn0o/)ï¼‰ + å›æº¯

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220422145451.png)

è™½ç„¶è·¯å¾„ä¸ä¸€å®šä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä½†ä»ç„¶å¯ä»¥æ±‚å¾—ä»æ ¹èŠ‚ç‚¹å¼€å§‹åˆ°è¾¾å½“å‰éå†èŠ‚ç‚¹çš„è·¯å¾„æ‰€ç»è¿‡çš„èŠ‚ç‚¹å€¼ä¹‹å’Œã€‚ä¾‹å¦‚ï¼Œä»ä¸Šå›¾çš„äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹5å‡ºå‘ï¼Œä¸€è¾¹é¡ºç€æŒ‡å‘å­èŠ‚ç‚¹çš„æŒ‡é’ˆåœ¨è·¯å¾„ä¸Šå‘ä¸‹ç§»åŠ¨ï¼Œä¸€è¾¹ç´¯åŠ å½“å‰å·²ç»ç»è¿‡çš„èŠ‚ç‚¹å€¼ä¹‹å’Œã€‚åˆ°è¾¾èŠ‚ç‚¹5æ—¶ï¼ŒèŠ‚ç‚¹å€¼ä¹‹å’Œä¸º5ã€‚å‡è®¾å…ˆé¡ºç€æŒ‡å‘å·¦å­èŠ‚ç‚¹çš„æŒ‡é’ˆåˆ°è¾¾èŠ‚ç‚¹ 2ï¼Œæ­¤æ—¶è·¯å¾„ç»è¿‡çš„èŠ‚ç‚¹å€¼ä¹‹å’Œä¸º7ã€‚å¦‚æœå†é¡ºç€æŒ‡å‘å³å­èŠ‚ç‚¹çš„æŒ‡é’ˆåˆ°è¾¾èŠ‚ç‚¹6ï¼Œæ­¤æ—¶è·¯å¾„ç»è¿‡çš„èŠ‚ç‚¹å€¼ä¹‹å’Œä¸º 15ã€‚

å¦‚æœåœ¨è·¯å¾„ä¸Šç§»åŠ¨æ—¶æŠŠæ‰€æœ‰ç´¯åŠ çš„èŠ‚ç‚¹å€¼ä¹‹å’Œéƒ½ä¿å­˜ä¸‹æ¥ï¼Œå°±å®¹æ˜“çŸ¥é“æ˜¯å¦å­˜åœ¨ä»ä»»æ„èŠ‚ç‚¹å‡ºå‘çš„å€¼ä¸ºç»™å®šsumçš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå½“åˆ°è¾¾å›¾ä¸­äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ 5 æ—¶ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹çš„è·¯å¾„èŠ‚ç‚¹å€¼ä¹‹å’Œæ˜¯ 5ã€‚å½“åˆ°è¾¾èŠ‚ç‚¹2æ—¶ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹çš„è·¯å¾„ç»è¿‡çš„èŠ‚ç‚¹å€¼ä¹‹å’Œæ˜¯7ã€‚å½“åˆ°è¾¾èŠ‚ç‚¹6æ—¶ï¼Œä»æ ¹èŠ‚ç‚¹å‡ºå‘åˆ°å½“å‰èŠ‚ç‚¹çš„è·¯å¾„ç»è¿‡çš„èŠ‚ç‚¹å€¼ä¹‹å’Œä¸º 13ã€‚ç”±äºè¦æ‰¾å‡ºèŠ‚ç‚¹å€¼ä¹‹å’Œä¸º8çš„è·¯å¾„ï¼Œè€Œ13ä¸5çš„å·®å€¼æ˜¯8ï¼Œè¿™å°±è¯´æ˜ä»èŠ‚ç‚¹5çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå³èŠ‚ç‚¹2ï¼‰å¼€å§‹åˆ°èŠ‚ç‚¹ 6 ç»“æŸçš„è·¯å¾„ç»è¿‡çš„èŠ‚ç‚¹å€¼ä¹‹å’Œä¸º 8ã€‚

```java
class Solution {
    // å­˜å‚¨æœ€ç»ˆç»“æœï¼ˆå’Œä¸º targetSum çš„æ‰€æœ‰è·¯å¾„æ•°ï¼‰
    private int count = 0;

    public int pathSum(TreeNode root, int targetSum) {
        if (root == null) {
            return count;
        }

        // å“ˆå¸Œè¡¨çš„é”®æ˜¯ç´¯åŠ çš„èŠ‚ç‚¹å€¼ä¹‹å’Œï¼Œå“ˆå¸Œè¡¨çš„å€¼æ˜¯æ¯ä¸ªèŠ‚ç‚¹å€¼ä¹‹å’Œå‡ºç°çš„æ¬¡æ•°
        Map<Integer, Integer> map = new HashMap<>();
        // æ³¨æ„ï¼è¿™é‡ŒåŠ å…¥ 0 æ˜¯ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼šæŸä¸ªèŠ‚ç‚¹æœ¬èº«çš„å€¼å°±ç­‰äº targetSum
        map.put(0, 1);
        // æ ¹èŠ‚ç‚¹åŠ å…¥ mapï¼Œè¿™é‡Œè¿™ä¹ˆå†™çš„åŸå› æ˜¯æ ¹èŠ‚ç‚¹ä¹Ÿå¯èƒ½æ˜¯ 0
        map.put(root.val, map.getOrDefault(root.val, 0) + 1);
        if (root.val == targetSum) {
            count += 1;
        }

        // ä»æ ¹èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„è·¯å¾„å’Œ
        int path = root.val;

        dfs(root, targetSum, map, path);

        return count;
    }

    private void dfs(TreeNode root, int targetSum, Map<Integer, Integer> map, int path) {
        // ç»“æŸæ¡ä»¶
        if (root == null) {
            return ;
        }
        
        if (root.left != null) {
            // åšé€‰æ‹©
            path += root.left.val;
            count += map.getOrDefault(path - targetSum, 0);
            map.put(path, map.getOrDefault(path, 0) + 1);

            // è¿›å…¥å·¦å­æ ‘é€’å½’
            dfs(root.left, targetSum, map, path);

            // å›æº¯(count å°±ä¸è¦å›æº¯äº†ï¼Œä¸ç„¶ä¸æ˜¯ç™½åšäº†ï¼Œç›®çš„å°±æ˜¯èµ°åˆ°è¿™ä¸ªåˆ†æ”¯æ±‚ count çš„)
            map.put(path, map.get(path) - 1);
            path -= root.left.val;
        }

        if (root.right != null) {
            // åšé€‰æ‹©
            path += root.right.val;
            count += map.getOrDefault(path - targetSum, 0);
            map.put(path, map.getOrDefault(path, 0) + 1);

            // è¿›å…¥å³å­æ ‘é€’å½’
            dfs(root.right, targetSum, map, path);

            // å›æº¯
            map.put(path, map.get(path) - 1);
            path -= root.right.val;
        }
    }
}
```

> path å’Œ map å°±æ˜¯æ¯æ¡è·¯å¾„å¯¹åº”éœ€è¦ç»´æŠ¤çš„å˜é‡ï¼Œè€Œ count å°±ç›¸å½“äºæ‰€æœ‰è·¯å¾„ï¼ˆæœ€ç»ˆç»“æœï¼‰ï¼Œæ‰€ä»¥ï¼Œå›æº¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å›æº¯ path å’Œ mapï¼Œè€Œä¸éœ€è¦å›æº¯ countï¼Œæ€»çš„è¿˜æ˜¯æŒ‰ç…§æˆ‘ä»¬æ€»ç»“çš„é‚£ä¸ªæ ‘å½¢å›æº¯çš„æ¨¡æ¿æ¥çš„ï¼š
>
> ![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/20220422160647.png)

<br>

ä¹¦ä¸­ç»™å‡ºçš„ä»£ç ï¼Œæˆ‘æ„Ÿè§‰ä¸å¤ªå¥½ç†è§£


```java
class Solution {
    public int pathSum(TreeNode root, int targetSum) {
        // å“ˆå¸Œè¡¨çš„é”®æ˜¯ç´¯åŠ çš„èŠ‚ç‚¹å€¼ä¹‹å’Œï¼Œå“ˆå¸Œè¡¨çš„å€¼æ˜¯æ¯ä¸ªèŠ‚ç‚¹å€¼ä¹‹å’Œå‡ºç°çš„æ¬¡æ•°
        Map<Integer, Integer> map = new HashMap<>();
        map.put(0, 1);

        // ä»æ ¹èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„è·¯å¾„å’Œ
        int path = 0;

        return dfs(root, targetSum, map, path);
    }

    private int dfs(TreeNode root, int targetSum, Map<Integer, Integer> map, int path) {
        // ç»“æŸæ¡ä»¶
        if (root == null) {
            return 0;
        }
        
        path += root.val;
        int count = map.getOrDefault(path - targetSum, 0);
        map.put(path, map.getOrDefault(path, 0) + 1);

        if (root.left != null) {
            count += dfs(root.left, targetSum, map, path);
        }

        if (root.right != null) {
            count += dfs(root.right, targetSum, map, path);
        }
        // å›æº¯
        map.put(path, map.get(path) - 1);

        return count;
    }
}
```



## ğŸ’¥ å¤æ‚åº¦åˆ†æ

- ç©ºé—´å¤æ‚åº¦ï¼š
- æ—¶é—´å¤æ‚åº¦ï¼š

