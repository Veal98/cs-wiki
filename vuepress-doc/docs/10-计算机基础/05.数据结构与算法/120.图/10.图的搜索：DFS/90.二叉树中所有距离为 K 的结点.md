---
title: äºŒå‰æ ‘ä¸­æ‰€æœ‰è·ç¦»ä¸º K çš„ç»“ç‚¹
date: 2022-07-26 18:44:29
permalink: /pages/ff5b4a/
---
## ğŸ“ƒ é¢˜ç›®æè¿°

é¢˜ç›®é“¾æ¥ï¼š[863. äºŒå‰æ ‘ä¸­æ‰€æœ‰è·ç¦»ä¸º K çš„ç»“ç‚¹](https://leetcode.cn/problems/all-nodes-distance-k-in-binary-tree/)

ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼ˆå…·æœ‰æ ¹ç»“ç‚¹ rootï¼‰ï¼Œ ä¸€ä¸ªç›®æ ‡ç»“ç‚¹ target ï¼Œå’Œä¸€ä¸ªæ•´æ•°å€¼ k ã€‚

è¿”å›åˆ°ç›®æ ‡ç»“ç‚¹ target è·ç¦»ä¸º k çš„æ‰€æœ‰ç»“ç‚¹çš„å€¼çš„åˆ—è¡¨ã€‚ ç­”æ¡ˆå¯ä»¥ä»¥ ä»»ä½•é¡ºåº è¿”å›ã€‚

![](https://cs-wiki.oss-cn-shanghai.aliyuncs.com/img/image-20220726184513856.png)

## ğŸ”” è§£é¢˜æ€è·¯

ç›´æ¥ä» target ç»“ç‚¹å¤„å¼€å§‹èµ°ï¼Œ**åœ¨æ¯ä¸ªç»“ç‚¹å¤„éƒ½æœ‰ä¸‰ä¸ªå¯èƒ½çš„å‰è¿›æ–¹å‘ï¼šå·¦å­©å­æ–¹å‘ã€å³å­©å­æ–¹å‘ï¼Œçˆ¶ç»“ç‚¹æ–¹å‘ï¼Œç”¨ä¸‰åˆ†æ”¯é€’å½’å®ç°**ã€‚ä¸ªäººè®¤ä¸ºä¸¤ä¸ªå…³é”®ç‚¹ï¼š

1. ç”±äºæ˜¯äºŒå‰é“¾è¡¨ï¼Œæ‰€ä»¥ï¼Œæ— æ³•ç›´æ¥ç”±å½“å‰ç»“ç‚¹èµ°å‘å…¶çˆ¶èŠ‚ç‚¹ï¼Œæ‰€ä»¥ç”¨äº†ä¸€ä¸ª map åŠ ä¸€æ¬¡ dfs éå†æ¥ä¿å­˜æ‰€æœ‰ç»“ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ map ç›´æ¥è·³åˆ°çˆ¶èŠ‚ç‚¹äº†ã€‚
2. ä¸ºäº†é˜²æ­¢èµ°å›å¤´è·¯ï¼Œéœ€è¦å­˜å‚¨å·²ç»è®¿é—®è¿‡çš„èŠ‚ç‚¹ï¼ˆå°†è·¯è¿‡çš„ç»“ç‚¹åŠ å…¥ setï¼Œè‹¥å¾…è®¿é—®çš„ç»“ç‚¹ä¸åœ¨ set ä¸­ï¼Œåˆ™è®¿é—®å®ƒï¼Œå¦åˆ™è·³è¿‡ï¼‰


```java
/**
 * Definition for a binary tree node.
 * public class TreeNode {
 *     int val;
 *     TreeNode left;
 *     TreeNode right;
 *     TreeNode(int x) { val = x; }
 * }
 */
class Solution {
    
    private List<Integer> res = new ArrayList<>();

    // value æ˜¯ key çš„çˆ¶èŠ‚ç‚¹
    private Map<TreeNode, TreeNode> map = new HashMap<>();

    public List<Integer> distanceK(TreeNode root, TreeNode target, int k) {

        if (root == null) {
            return res;
        }
        
        // ä» root å‡ºå‘ DFSï¼Œè®°å½•æ¯ä¸ªç»“ç‚¹çš„çˆ¶ç»“ç‚¹
        findParents(root);
        
        // å­˜å‚¨å·²è®¿é—®è¿‡çš„èŠ‚ç‚¹
        Set<TreeNode> visited = new HashSet<>();
        // ä» target å‡ºå‘ DFSï¼Œå¯»æ‰¾æ‰€æœ‰æ·±åº¦ä¸º k çš„ç»“ç‚¹ï¼Œ0 d
        findKNodes(target, visited, 0, k);
        
        return res;
    }

    private void findParents(TreeNode cur) {
        if (cur.left != null) {
            map.put(cur.left, cur);
            findParents(cur.left);
        }
        if (cur.right != null) {
            map.put(cur.right, cur);
            findParents(cur.right);
        }
    }

    // ä» node(node çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹æ˜¯ from) å‡ºå‘ DFSï¼Œå¯»æ‰¾æ‰€æœ‰æ·±åº¦ä¸º k çš„ç»“ç‚¹
    private void findKNodes(TreeNode node, Set<TreeNode> visited, int depth, int k) {
        if (node == null) {
            return ;
        }

        // å½“å‰èŠ‚ç‚¹ç½®ä¸ºå·²è®¿é—®
        visited.add(node);

        if (depth == k) {
            res.add(node.val);
            return ;
        }

        // å¤„ç† node çš„é‚»å±…èŠ‚ç‚¹
        // å·¦å­©å­
        if (!visited.contains(node.left)) {
            findKNodes(node.left, visited, depth + 1, k);
        }
        // å³å­©å­
        if (!visited.contains(node.right)) {
            findKNodes(node.right, visited, depth + 1, k);
        }
        // çˆ¶èŠ‚ç‚¹
        if (!visited.contains(map.get(node))) {
            findKNodes(map.get(node), visited, depth + 1, k);
        }
    }
}
```

è¿˜å¯ä»¥åœ¨ç©ºé—´ä¸Šä¼˜åŒ–ä¸‹ï¼Œè®¾è®¡ä¸€ä¸ª from æ ‡å¿—æ¥ä»£æ›¿ visitedï¼Œå¦‚ä¸‹ï¼š


```java
class Solution {
    
    private List<Integer> res = new ArrayList<>();

    // value æ˜¯ key çš„çˆ¶èŠ‚ç‚¹
    private Map<TreeNode, TreeNode> map = new HashMap<>();

    public List<Integer> distanceK(TreeNode root, TreeNode target, int k) {

        if (root == null) {
            return res;
        }
        
        // ä» root å‡ºå‘ DFSï¼Œè®°å½•æ¯ä¸ªç»“ç‚¹çš„çˆ¶ç»“ç‚¹
        findParents(root);
        
        // ä» target å‡ºå‘ DFSï¼Œå¯»æ‰¾æ‰€æœ‰æ·±åº¦ä¸º k çš„ç»“ç‚¹
        findKNodes(target, null, 0, k);
        
        return res;
    }
    
	// dfs
    private void findParents(TreeNode cur) {
        if (cur.left != null) {
            map.put(cur.left, cur);
            findParents(cur.left);
        }
        if (cur.right != null) {
            map.put(cur.right, cur);
            findParents(cur.right);
        }
    }

    // ä» node(node çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹æ˜¯ from) å‡ºå‘ DFSï¼Œå¯»æ‰¾æ‰€æœ‰æ·±åº¦ä¸º k çš„ç»“ç‚¹
    private void findKNodes(TreeNode node, TreeNode from, int depth, int k) {
        if (depth == k) {
            res.add(node.val);
            return ;
        }
		
        // å¤„ç† node çš„é‚»å±…èŠ‚ç‚¹
        // 1. node ä¸æ˜¯æ¥è‡ª node.left(å³ node.left æ²¡æœ‰è¢«è®¿é—®è¿‡)ï¼Œé‚£ä¹ˆå°± DFS node.left
        if (node.left != from) {
            findKNodes(node.left, node, depth + 1, k);
        }
        // 2. node ä¸æ˜¯æ¥è‡ª node.right(å³ node.right æ²¡æœ‰è¢«è®¿é—®è¿‡)ï¼Œé‚£ä¹ˆå°± DFS node.rightï¼Œé‚£ä¹ˆå°±
        if (node.right != from) {
            findKNodes(node.right, node, depth + 1, k);
        }
        // 3. node ä¸æ˜¯æ¥è‡ªå…¶çˆ¶èŠ‚ç‚¹(å³ node.çˆ¶èŠ‚ç‚¹ æ²¡æœ‰è¢«è®¿é—®è¿‡)ï¼Œé‚£ä¹ˆå°± DFS çˆ¶èŠ‚ç‚¹
        if (map.get(node) != from) {
            findKNodes(map.get(node), node, depth + 1, k);
        }

    }
}
```



## ğŸ’¥ å¤æ‚åº¦åˆ†æ

- ç©ºé—´å¤æ‚åº¦ï¼šO(N)ï¼Œè®°å½•çˆ¶èŠ‚ç‚¹éœ€è¦ O(n) çš„ç©ºé—´ï¼Œæ·±åº¦ä¼˜å…ˆæœç´¢éœ€è¦ O(n) çš„æ ˆç©ºé—´
- æ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼Œä¸¤æ¬¡ DFSï¼Œæ¯æ¬¡ DFS æ—¶é—´å¤æ‚åº¦ O(v + e)ï¼Œå¯¹åº”æœ¬é¢˜å°±æ˜¯ O(N)ï¼ŒN è¡¨ç¤ºèŠ‚ç‚¹ä¸ªæ•°

